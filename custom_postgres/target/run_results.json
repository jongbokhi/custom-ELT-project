{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.1", "generated_at": "2024-06-20T19:24:22.551616Z", "invocation_id": "22d04bfe-407e-44a0-b2cd-4915dc876a0c", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-20T19:24:21.929157Z", "completed_at": "2024-06-20T19:24:21.944295Z"}, {"name": "execute", "started_at": "2024-06-20T19:24:21.945439Z", "completed_at": "2024-06-20T19:24:22.108546Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.1827540397644043, "adapter_response": {"_message": "SELECT 20", "code": "SELECT", "rows_affected": 20}, "message": "SELECT 20", "failures": null, "unique_id": "model.custom_postgres.actors", "compiled": true, "compiled_code": "SELECT * FROM \"destination_db\".\"public\".\"actors\"", "relation_name": "\"destination_db\".\"public\".\"actors\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-20T19:24:22.118954Z", "completed_at": "2024-06-20T19:24:22.132222Z"}, {"name": "execute", "started_at": "2024-06-20T19:24:22.133342Z", "completed_at": "2024-06-20T19:24:22.212542Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.09695720672607422, "adapter_response": {"_message": "SELECT 20", "code": "SELECT", "rows_affected": 20}, "message": "SELECT 20", "failures": null, "unique_id": "model.custom_postgres.film_actors", "compiled": true, "compiled_code": "SELECT * FROM \"destination_db\".\"public\".\"film_actors\"", "relation_name": "\"destination_db\".\"public\".\"film_actors\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-20T19:24:22.223465Z", "completed_at": "2024-06-20T19:24:22.234434Z"}, {"name": "execute", "started_at": "2024-06-20T19:24:22.235536Z", "completed_at": "2024-06-20T19:24:22.316703Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.09633207321166992, "adapter_response": {"_message": "SELECT 20", "code": "SELECT", "rows_affected": 20}, "message": "SELECT 20", "failures": null, "unique_id": "model.custom_postgres.films", "compiled": true, "compiled_code": "SELECT * FROM \"destination_db\".\"public\".\"films\"", "relation_name": "\"destination_db\".\"public\".\"films\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-20T19:24:22.327234Z", "completed_at": "2024-06-20T19:24:22.340034Z"}, {"name": "execute", "started_at": "2024-06-20T19:24:22.341075Z", "completed_at": "2024-06-20T19:24:22.417559Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.09361982345581055, "adapter_response": {"_message": "SELECT 20", "code": "SELECT", "rows_affected": 20}, "message": "SELECT 20", "failures": null, "unique_id": "model.custom_postgres.film_ratings", "compiled": true, "compiled_code": "\n\nWITH films_with_ratings AS (\n    SELECT\n        film_id,\n        title,\n        release_date,\n        price,\n        rating,\n        user_rating, \n        \n\nCASE\n    WHEN user_rating >= 4.5 THEN 'Excellent'\n    WHEN user_rating >= 4.0 THEN 'Good'\n    WHEN user_rating >= 3.0 THEN 'Average'\n    ELSE 'Poor'\n    END AS rating_category\n\n\n    FROM \"destination_db\".\"public\".\"films\"  -- Using dbt's ref function to reference the films table\n),\n\nfilms_with_actors AS (\n    SELECT\n        f.film_id,\n        f.title,\n        STRING_AGG(a.actor_name, ', ') AS actors  -- Aggregating actor names for each film\n    FROM \"destination_db\".\"public\".\"films\" f\n    LEFT JOIN \"destination_db\".\"public\".\"film_actors\" fa ON f.film_id = fa.film_id\n    LEFT JOIN \"destination_db\".\"public\".\"actors\" a ON fa.actor_id = a.actor_id\n    GROUP BY f.film_id, f.title\n)\n\nSELECT\n    fwf.*,\n    fwa.actors\nFROM films_with_ratings fwf\nLEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id\n\n", "relation_name": "\"destination_db\".\"public\".\"film_ratings\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-20T19:24:22.427163Z", "completed_at": "2024-06-20T19:24:22.437912Z"}, {"name": "execute", "started_at": "2024-06-20T19:24:22.439204Z", "completed_at": "2024-06-20T19:24:22.509291Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0853891372680664, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": "SELECT 1", "failures": null, "unique_id": "model.custom_postgres.specific_movie", "compiled": true, "compiled_code": "\n\nSELECT *\nFROM \"destination_db\".\"public\".\"films\"\nWHERE title ='Dunkirk'", "relation_name": "\"destination_db\".\"public\".\"specific_movie\""}], "elapsed_time": 0.8015360832214355, "args": {"invocation_command": "dbt run --profiles-dir /root --project-dir /dbt", "profiles_dir": "/root", "profile": "custom_postgres", "project_dir": "/dbt", "defer": false, "require_resource_names_without_spaces": false, "cache_selected_only": false, "macro_debugging": false, "enable_legacy_logger": false, "select": [], "warn_error_options": {"include": [], "exclude": []}, "log_format": "default", "indirect_selection": "eager", "use_colors": true, "partial_parse": true, "introspect": true, "partial_parse_file_diff": true, "use_colors_file": true, "send_anonymous_usage_stats": true, "vars": {}, "favor_state": false, "log_format_file": "debug", "populate_cache": true, "print": true, "printer_width": 80, "log_level_file": "debug", "log_level": "info", "empty": false, "log_path": "/dbt/logs", "static_parser": true, "quiet": false, "strict_mode": false, "target": "dev", "exclude": [], "source_freshness_run_project_hooks": false, "log_file_max_bytes": 10485760, "which": "run", "write_json": true, "show_resource_report": false, "require_explicit_package_overrides_for_builtin_materializations": true, "version_check": true}}