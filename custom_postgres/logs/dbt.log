[0m18:32:01.384052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1fe0d2b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1fe0d2a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1fe0d01d0>]}


============================== 18:32:01.391704 | ac693325-b628-4a86-b0d9-ee2a9a58ad90 ==============================
[0m18:32:01.391704 [info ] [MainThread]: Running with dbt=1.8.1
[0m18:32:01.393244 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:32:01.402790 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'default'
[0m18:32:01.404678 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.08848641, "process_user_time": 1.98849, "process_kernel_time": 0.192761, "process_mem_max_rss": "88028", "process_in_blocks": "232", "process_out_blocks": "1008", "command_success": false}
[0m18:32:01.406014 [debug] [MainThread]: Command `dbt run` failed at 18:32:01.405825 after 0.09 seconds
[0m18:32:01.407213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1fe10fa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1fe0d2150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc201ae8c50>]}
[0m18:32:01.408427 [debug] [MainThread]: Flushing usage events
[0m18:33:29.017825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fae6c71d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fae503e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fae6c6fd0>]}


============================== 18:33:29.024351 | 1b8dfd46-2a2a-4f5d-983c-09a969bc7fa9 ==============================
[0m18:33:29.024351 [info ] [MainThread]: Running with dbt=1.8.1
[0m18:33:29.025890 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'version_check': 'True', 'debug': 'False', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:33:29.181386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b8dfd46-2a2a-4f5d-983c-09a969bc7fa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fadcd0490>]}
[0m18:33:29.230152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b8dfd46-2a2a-4f5d-983c-09a969bc7fa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fb03ff590>]}
[0m18:33:29.231734 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m18:33:29.243738 [debug] [MainThread]: checksum: 8dc0a8b3d70f1f34b0ae4fcce5e5a1fd7ffa186bf54a1762a302cc92429dddc4, vars: {}, profile: custom_postgres, target: dev, version: 1.8.1
[0m18:33:29.247787 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:33:29.249200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1b8dfd46-2a2a-4f5d-983c-09a969bc7fa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fae9849d0>]}
[0m18:33:30.208538 [error] [MainThread]: Encountered an error:
Compilation Error in model actors (models/example/actors.sql)
  expected token 'end of print statement', got '{'
    line 3
      {{source{'destination_db', 'actors'}}}
[0m18:33:30.210821 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.2508231, "process_user_time": 2.491485, "process_kernel_time": 0.207623, "process_mem_max_rss": "98628", "process_out_blocks": "1032", "command_success": false, "process_in_blocks": "0"}
[0m18:33:30.212090 [debug] [MainThread]: Command `dbt run` failed at 18:33:30.211960 after 1.25 seconds
[0m18:33:30.213072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fae6c6750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fae51b510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fae51b5d0>]}
[0m18:33:30.214069 [debug] [MainThread]: Flushing usage events
[0m18:35:43.565904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9690dc810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd969681fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9690dc8d0>]}


============================== 18:35:43.572922 | bb839512-ed3a-4c67-896b-80e6cbfc0f57 ==============================
[0m18:35:43.572922 [info ] [MainThread]: Running with dbt=1.8.1
[0m18:35:43.574559 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'debug': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:35:43.742359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb839512-ed3a-4c67-896b-80e6cbfc0f57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9688b4cd0>]}
[0m18:35:43.792691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb839512-ed3a-4c67-896b-80e6cbfc0f57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd96b013810>]}
[0m18:35:43.794687 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m18:35:43.806648 [debug] [MainThread]: checksum: 8dc0a8b3d70f1f34b0ae4fcce5e5a1fd7ffa186bf54a1762a302cc92429dddc4, vars: {}, profile: custom_postgres, target: dev, version: 1.8.1
[0m18:35:43.809997 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:35:43.811243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bb839512-ed3a-4c67-896b-80e6cbfc0f57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd968939c50>]}
[0m18:35:44.811245 [error] [MainThread]: Encountered an error:
Compilation Error in model films (models/example/films.sql)
  expected token 'end of print statement', got '{'
    line 3
      {{source{'destination_db', 'films'}}}
[0m18:35:44.813586 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.3076972, "process_user_time": 2.568406, "process_kernel_time": 0.319801, "process_mem_max_rss": "100812", "process_out_blocks": "1032", "command_success": false, "process_in_blocks": "0"}
[0m18:35:44.814739 [debug] [MainThread]: Command `dbt run` failed at 18:35:44.814616 after 1.31 seconds
[0m18:35:44.815754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9690de4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd969118c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd96911b910>]}
[0m18:35:44.816702 [debug] [MainThread]: Flushing usage events
[0m18:37:11.295567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f073e6b4650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f073ec59e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f073e8a7f90>]}


============================== 18:37:11.301450 | 4e0aa819-01de-4b03-abb9-f1f1746ffb87 ==============================
[0m18:37:11.301450 [info ] [MainThread]: Running with dbt=1.8.1
[0m18:37:11.302893 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root', 'log_path': '/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:37:11.463053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e0aa819-01de-4b03-abb9-f1f1746ffb87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f073e6f3310>]}
[0m18:37:11.514754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e0aa819-01de-4b03-abb9-f1f1746ffb87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07405fb150>]}
[0m18:37:11.516740 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m18:37:11.528499 [debug] [MainThread]: checksum: 8dc0a8b3d70f1f34b0ae4fcce5e5a1fd7ffa186bf54a1762a302cc92429dddc4, vars: {}, profile: custom_postgres, target: dev, version: 1.8.1
[0m18:37:11.531981 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:37:11.533287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4e0aa819-01de-4b03-abb9-f1f1746ffb87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f073e70b490>]}
[0m18:37:12.652994 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:37:12.654693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4e0aa819-01de-4b03-abb9-f1f1746ffb87', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f073dd89290>]}
[0m18:37:12.670837 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models/example/schema.yml @ models: {'name': 'actors', 'description': 'This table contains details about actors.', 'columns': [{'name': 'actor_id', 'description': 'Unique identifier for the actor.', 'tests': ['unique', 'not_null']}, {'name': 'name', 'description': 'First name of the actor.', 'tests': None}], 'original_file_path': 'models/example/schema.yml', 'yaml_key': 'models', 'package_name': 'custom_postgres'} - at path ['columns'][1]['tests']: None is not of type 'array'
[0m18:37:12.673064 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.4329729, "process_user_time": 2.705838, "process_kernel_time": 0.302892, "process_mem_max_rss": "102244", "process_out_blocks": "1032", "command_success": false, "process_in_blocks": "0"}
[0m18:37:12.674389 [debug] [MainThread]: Command `dbt run` failed at 18:37:12.674248 after 1.43 seconds
[0m18:37:12.675432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07420d0b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07420d0d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f073e8a7a50>]}
[0m18:37:12.676456 [debug] [MainThread]: Flushing usage events
[0m18:39:23.821097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09b3b4cc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09b3b8bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09b3b4cdd0>]}


============================== 18:39:23.827264 | 041ba9fe-ec34-46cc-b724-f78c43126c93 ==============================
[0m18:39:23.827264 [info ] [MainThread]: Running with dbt=1.8.1
[0m18:39:23.828664 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'version_check': 'True', 'debug': 'False', 'log_path': '/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:39:23.997176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '041ba9fe-ec34-46cc-b724-f78c43126c93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09b3f9b050>]}
[0m18:39:24.050708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '041ba9fe-ec34-46cc-b724-f78c43126c93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09b5a83810>]}
[0m18:39:24.052589 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m18:39:24.065050 [debug] [MainThread]: checksum: 8dc0a8b3d70f1f34b0ae4fcce5e5a1fd7ffa186bf54a1762a302cc92429dddc4, vars: {}, profile: custom_postgres, target: dev, version: 1.8.1
[0m18:39:24.068181 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:39:24.069425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '041ba9fe-ec34-46cc-b724-f78c43126c93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09b338ead0>]}
[0m18:39:25.148910 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:39:25.150572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '041ba9fe-ec34-46cc-b724-f78c43126c93', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09b32d60d0>]}
[0m18:39:25.167605 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models/example/schema.yml @ models: {'name': 'actors', 'description': 'This table contains details about actors.', 'columns': [{'name': 'actor_id', 'description': 'Unique identifier for the actor.', 'tests': ['unique', 'not_null']}, {'name': 'name', 'description': 'First name of the actor.', 'tests': None}], 'original_file_path': 'models/example/schema.yml', 'yaml_key': 'models', 'package_name': 'custom_postgres'} - at path ['columns'][1]['tests']: None is not of type 'array'
[0m18:39:25.169715 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.4030278, "process_user_time": 2.731604, "process_kernel_time": 0.161872, "process_mem_max_rss": "100132", "process_out_blocks": "1032", "command_success": false, "process_in_blocks": "0"}
[0m18:39:25.170872 [debug] [MainThread]: Command `dbt run` failed at 18:39:25.170750 after 1.40 seconds
[0m18:39:25.171935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09b7564c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09b7564d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09b3d3a050>]}
[0m18:39:25.173001 [debug] [MainThread]: Flushing usage events
[0m18:41:05.398098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2662b46d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2662a6f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa26667a1d0>]}


============================== 18:41:05.406738 | 74adae53-c709-4086-bc07-ea19349ecfbb ==============================
[0m18:41:05.406738 [info ] [MainThread]: Running with dbt=1.8.1
[0m18:41:05.408281 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:41:05.588557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '74adae53-c709-4086-bc07-ea19349ecfbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2658c14d0>]}
[0m18:41:05.641128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '74adae53-c709-4086-bc07-ea19349ecfbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa267ff3450>]}
[0m18:41:05.643186 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m18:41:05.656546 [debug] [MainThread]: checksum: 8dc0a8b3d70f1f34b0ae4fcce5e5a1fd7ffa186bf54a1762a302cc92429dddc4, vars: {}, profile: custom_postgres, target: dev, version: 1.8.1
[0m18:41:05.659605 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:41:05.660671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '74adae53-c709-4086-bc07-ea19349ecfbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2658c3150>]}
[0m18:41:06.892897 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:41:06.894900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '74adae53-c709-4086-bc07-ea19349ecfbb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa265772710>]}
[0m18:41:07.249889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74adae53-c709-4086-bc07-ea19349ecfbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2656a48d0>]}
[0m18:41:07.456259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74adae53-c709-4086-bc07-ea19349ecfbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2572258d0>]}
[0m18:41:07.457660 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 413 macros
[0m18:41:07.458878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74adae53-c709-4086-bc07-ea19349ecfbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa265647790>]}
[0m18:41:07.461931 [info ] [MainThread]: 
[0m18:41:07.463308 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:41:07.468240 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m18:41:07.522807 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m18:41:07.524284 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m18:41:07.525389 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:41:07.553930 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m18:41:07.556579 [debug] [ThreadPool]: On list_destination_db: Close
[0m18:41:07.559279 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m18:41:07.567937 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m18:41:07.569231 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m18:41:07.570260 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:07.591250 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:41:07.592546 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m18:41:07.593746 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:41:07.602407 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m18:41:07.605431 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m18:41:07.608858 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m18:41:07.616535 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:07.618009 [debug] [MainThread]: On master: BEGIN
[0m18:41:07.619288 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:41:07.641702 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:41:07.643425 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:07.644931 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:41:07.652265 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m18:41:07.654943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74adae53-c709-4086-bc07-ea19349ecfbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa26800d090>]}
[0m18:41:07.656438 [debug] [MainThread]: On master: ROLLBACK
[0m18:41:07.660729 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:07.662267 [debug] [MainThread]: On master: BEGIN
[0m18:41:07.668653 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:41:07.670453 [debug] [MainThread]: On master: COMMIT
[0m18:41:07.671659 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:07.672767 [debug] [MainThread]: On master: COMMIT
[0m18:41:07.677029 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:41:07.678648 [debug] [MainThread]: On master: Close
[0m18:41:07.680263 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:41:07.681813 [info ] [MainThread]: 
[0m18:41:07.694897 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m18:41:07.696703 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m18:41:07.698359 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m18:41:07.699757 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m18:41:07.711332 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m18:41:07.733595 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m18:41:07.787368 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m18:41:07.806779 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m18:41:07.807771 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m18:41:07.808695 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:07.827546 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:41:07.828891 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m18:41:07.829959 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m18:41:07.834076 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                           ^

[0m18:41:07.835156 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m18:41:07.839021 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m18:41:07.847034 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m18:41:07.850059 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74adae53-c709-4086-bc07-ea19349ecfbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa26563bf50>]}
[0m18:41:07.851881 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.15s]
[0m18:41:07.853650 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m18:41:07.855030 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m18:41:07.857573 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m18:41:07.859708 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m18:41:07.861219 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m18:41:07.866736 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m18:41:07.877322 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m18:41:07.886240 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m18:41:07.896877 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m18:41:07.898307 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m18:41:07.899613 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:07.924881 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:41:07.926429 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m18:41:07.927974 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m18:41:07.932657 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                           ^

[0m18:41:07.934320 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m18:41:07.939321 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m18:41:07.944547 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m18:41:07.946603 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74adae53-c709-4086-bc07-ea19349ecfbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa25673af10>]}
[0m18:41:07.948832 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.09s]
[0m18:41:07.950901 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m18:41:07.952697 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m18:41:07.954614 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m18:41:07.956241 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m18:41:07.957658 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m18:41:07.963819 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m18:41:07.976305 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m18:41:07.983727 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m18:41:07.994610 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m18:41:07.996222 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m18:41:07.997525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:08.022828 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:41:08.024630 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m18:41:08.026529 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m18:41:08.031720 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."films"
                           ^

[0m18:41:08.033310 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m18:41:08.038611 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m18:41:08.044704 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m18:41:08.046927 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74adae53-c709-4086-bc07-ea19349ecfbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa25671f450>]}
[0m18:41:08.049104 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.09s]
[0m18:41:08.051117 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m18:41:08.055041 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m18:41:08.057100 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m18:41:08.059244 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m18:41:08.063002 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:08.064626 [debug] [MainThread]: On master: BEGIN
[0m18:41:08.065973 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:41:08.095873 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:41:08.097711 [debug] [MainThread]: On master: COMMIT
[0m18:41:08.099347 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:08.100833 [debug] [MainThread]: On master: COMMIT
[0m18:41:08.106949 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:41:08.108773 [debug] [MainThread]: On master: Close
[0m18:41:08.111065 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:41:08.113209 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m18:41:08.115083 [info ] [MainThread]: 
[0m18:41:08.116999 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m18:41:08.120623 [debug] [MainThread]: Command end result
[0m18:41:08.210596 [info ] [MainThread]: 
[0m18:41:08.212657 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m18:41:08.214361 [info ] [MainThread]: 
[0m18:41:08.216188 [error] [MainThread]:   Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m18:41:08.217765 [info ] [MainThread]: 
[0m18:41:08.219672 [error] [MainThread]:   Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m18:41:08.221309 [info ] [MainThread]: 
[0m18:41:08.223202 [error] [MainThread]:   Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m18:41:08.225222 [info ] [MainThread]: 
[0m18:41:08.227232 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m18:41:08.229985 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.9026363, "process_user_time": 3.703517, "process_kernel_time": 0.327657, "process_mem_max_rss": "112684", "process_out_blocks": "1152", "command_success": false, "process_in_blocks": "0"}
[0m18:41:08.232135 [debug] [MainThread]: Command `dbt run` failed at 18:41:08.231856 after 2.90 seconds
[0m18:41:08.233808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2660e9290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2662b6190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2660f3a10>]}
[0m18:41:08.235541 [debug] [MainThread]: Flushing usage events
[0m18:46:33.709919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd408e6950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd40e851d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd408e6a50>]}


============================== 18:46:33.716861 | c1b72ebf-fd07-45aa-bf0e-11000581ce4f ==============================
[0m18:46:33.716861 [info ] [MainThread]: Running with dbt=1.8.1
[0m18:46:33.718480 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root', 'log_path': '/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:46:33.917119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1b72ebf-fd07-45aa-bf0e-11000581ce4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd40ad2a10>]}
[0m18:46:33.969307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1b72ebf-fd07-45aa-bf0e-11000581ce4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd427f3ad0>]}
[0m18:46:33.971746 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m18:46:33.985643 [debug] [MainThread]: checksum: 8dc0a8b3d70f1f34b0ae4fcce5e5a1fd7ffa186bf54a1762a302cc92429dddc4, vars: {}, profile: custom_postgres, target: dev, version: 1.8.1
[0m18:46:34.317220 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:46:34.318521 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:46:34.372723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1b72ebf-fd07-45aa-bf0e-11000581ce4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd3fe87710>]}
[0m18:46:34.508881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1b72ebf-fd07-45aa-bf0e-11000581ce4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd3fe87550>]}
[0m18:46:34.509910 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 413 macros
[0m18:46:34.511121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1b72ebf-fd07-45aa-bf0e-11000581ce4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd3fea6110>]}
[0m18:46:34.514002 [info ] [MainThread]: 
[0m18:46:34.515206 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:46:34.519752 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m18:46:34.568850 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m18:46:34.570258 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m18:46:34.571237 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:46:34.598188 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m18:46:34.600590 [debug] [ThreadPool]: On list_destination_db: Close
[0m18:46:34.603697 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m18:46:34.611272 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m18:46:34.612363 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m18:46:34.613272 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:46:34.631746 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:46:34.632976 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m18:46:34.634042 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:46:34.640267 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m18:46:34.642503 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m18:46:34.645474 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m18:46:34.652297 [debug] [MainThread]: Using postgres connection "master"
[0m18:46:34.653561 [debug] [MainThread]: On master: BEGIN
[0m18:46:34.654799 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:46:34.675934 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:46:34.677429 [debug] [MainThread]: Using postgres connection "master"
[0m18:46:34.678668 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:46:34.686393 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m18:46:34.689274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1b72ebf-fd07-45aa-bf0e-11000581ce4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd3fe86190>]}
[0m18:46:34.690584 [debug] [MainThread]: On master: ROLLBACK
[0m18:46:34.694453 [debug] [MainThread]: Using postgres connection "master"
[0m18:46:34.695977 [debug] [MainThread]: On master: BEGIN
[0m18:46:34.702099 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:46:34.703851 [debug] [MainThread]: On master: COMMIT
[0m18:46:34.705116 [debug] [MainThread]: Using postgres connection "master"
[0m18:46:34.706444 [debug] [MainThread]: On master: COMMIT
[0m18:46:34.710662 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:46:34.712090 [debug] [MainThread]: On master: Close
[0m18:46:34.713527 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:46:34.715043 [info ] [MainThread]: 
[0m18:46:34.727537 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m18:46:34.729262 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m18:46:34.730862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m18:46:34.732374 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m18:46:34.744462 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m18:46:34.754765 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m18:46:34.808129 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m18:46:34.817430 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m18:46:34.818395 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m18:46:34.819306 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:46:34.838697 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:46:34.839956 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m18:46:34.840997 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m18:46:34.845180 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                           ^

[0m18:46:34.846379 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m18:46:34.850255 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m18:46:34.861920 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m18:46:34.864837 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1b72ebf-fd07-45aa-bf0e-11000581ce4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd3f356e90>]}
[0m18:46:34.866819 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.13s]
[0m18:46:34.868979 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m18:46:34.870686 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m18:46:34.873032 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m18:46:34.874854 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m18:46:34.876261 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m18:46:34.881978 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m18:46:34.893180 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m18:46:34.900097 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m18:46:34.910512 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m18:46:34.912352 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m18:46:34.913843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:46:34.941477 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:46:34.943417 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m18:46:34.945034 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m18:46:34.950554 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                           ^

[0m18:46:34.952251 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m18:46:34.956915 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m18:46:34.962887 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m18:46:34.965080 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1b72ebf-fd07-45aa-bf0e-11000581ce4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd3f1901d0>]}
[0m18:46:34.967716 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.09s]
[0m18:46:34.970400 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m18:46:34.972234 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m18:46:34.974189 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m18:46:34.976480 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m18:46:34.978380 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m18:46:34.984302 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m18:46:34.997039 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m18:46:35.004587 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m18:46:35.017551 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m18:46:35.019493 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m18:46:35.021402 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:46:35.058292 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:46:35.060538 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m18:46:35.062989 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m18:46:35.070795 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."films"
                           ^

[0m18:46:35.072911 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m18:46:35.078974 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m18:46:35.086251 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m18:46:35.088644 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1b72ebf-fd07-45aa-bf0e-11000581ce4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd3f1d8210>]}
[0m18:46:35.090867 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.11s]
[0m18:46:35.093239 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m18:46:35.096837 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m18:46:35.098975 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m18:46:35.101169 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m18:46:35.105251 [debug] [MainThread]: Using postgres connection "master"
[0m18:46:35.107027 [debug] [MainThread]: On master: BEGIN
[0m18:46:35.108611 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:46:35.143502 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:46:35.145723 [debug] [MainThread]: On master: COMMIT
[0m18:46:35.147472 [debug] [MainThread]: Using postgres connection "master"
[0m18:46:35.148815 [debug] [MainThread]: On master: COMMIT
[0m18:46:35.153955 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:46:35.155683 [debug] [MainThread]: On master: Close
[0m18:46:35.157669 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:46:35.159352 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m18:46:35.161433 [info ] [MainThread]: 
[0m18:46:35.163431 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m18:46:35.166160 [debug] [MainThread]: Command end result
[0m18:46:35.245341 [info ] [MainThread]: 
[0m18:46:35.247035 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m18:46:35.248424 [info ] [MainThread]: 
[0m18:46:35.250373 [error] [MainThread]:   Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m18:46:35.251928 [info ] [MainThread]: 
[0m18:46:35.253393 [error] [MainThread]:   Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m18:46:35.254703 [info ] [MainThread]: 
[0m18:46:35.256112 [error] [MainThread]:   Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m18:46:35.257522 [info ] [MainThread]: 
[0m18:46:35.259260 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m18:46:35.262656 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.612033, "process_user_time": 2.428125, "process_kernel_time": 0.302256, "process_mem_max_rss": "106612", "process_in_blocks": "100832", "process_out_blocks": "1152", "command_success": false}
[0m18:46:35.264469 [debug] [MainThread]: Command `dbt run` failed at 18:46:35.264186 after 1.61 seconds
[0m18:46:35.266496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd408e6150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd442e8c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd3f12c150>]}
[0m18:46:35.268226 [debug] [MainThread]: Flushing usage events
[0m18:53:09.374248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f395a37c450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f395a37c210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f395a37c090>]}


============================== 18:53:09.381779 | 8a8ef35f-0feb-49ef-9c23-7eebe4f13cbe ==============================
[0m18:53:09.381779 [info ] [MainThread]: Running with dbt=1.8.1
[0m18:53:09.383293 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:53:09.588797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a8ef35f-0feb-49ef-9c23-7eebe4f13cbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3959befd50>]}
[0m18:53:09.643892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a8ef35f-0feb-49ef-9c23-7eebe4f13cbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f395c2caed0>]}
[0m18:53:09.646170 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m18:53:09.662245 [debug] [MainThread]: checksum: 8dc0a8b3d70f1f34b0ae4fcce5e5a1fd7ffa186bf54a1762a302cc92429dddc4, vars: {}, profile: custom_postgres, target: dev, version: 1.8.1
[0m18:53:09.943834 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:53:09.945410 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:53:09.991139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a8ef35f-0feb-49ef-9c23-7eebe4f13cbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3959c0d910>]}
[0m18:53:10.142237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a8ef35f-0feb-49ef-9c23-7eebe4f13cbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3959a3a910>]}
[0m18:53:10.143239 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 413 macros
[0m18:53:10.144346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a8ef35f-0feb-49ef-9c23-7eebe4f13cbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3959ad7210>]}
[0m18:53:10.147459 [info ] [MainThread]: 
[0m18:53:10.148749 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:53:10.153689 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m18:53:10.208604 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m18:53:10.209995 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m18:53:10.211109 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:53:10.240742 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m18:53:10.243229 [debug] [ThreadPool]: On list_destination_db: Close
[0m18:53:10.245834 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m18:53:10.254094 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m18:53:10.255240 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m18:53:10.256174 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:53:10.274720 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:53:10.275933 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m18:53:10.276915 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:53:10.283287 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m18:53:10.285753 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m18:53:10.289673 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m18:53:10.297025 [debug] [MainThread]: Using postgres connection "master"
[0m18:53:10.298630 [debug] [MainThread]: On master: BEGIN
[0m18:53:10.299658 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:53:10.319255 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:53:10.320696 [debug] [MainThread]: Using postgres connection "master"
[0m18:53:10.321978 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:53:10.329507 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m18:53:10.332085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a8ef35f-0feb-49ef-9c23-7eebe4f13cbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39598cc810>]}
[0m18:53:10.333392 [debug] [MainThread]: On master: ROLLBACK
[0m18:53:10.336993 [debug] [MainThread]: Using postgres connection "master"
[0m18:53:10.338415 [debug] [MainThread]: On master: BEGIN
[0m18:53:10.344877 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:53:10.346455 [debug] [MainThread]: On master: COMMIT
[0m18:53:10.347711 [debug] [MainThread]: Using postgres connection "master"
[0m18:53:10.348863 [debug] [MainThread]: On master: COMMIT
[0m18:53:10.353033 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:53:10.354672 [debug] [MainThread]: On master: Close
[0m18:53:10.356242 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:53:10.357538 [info ] [MainThread]: 
[0m18:53:10.370150 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m18:53:10.372005 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m18:53:10.373582 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m18:53:10.374902 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m18:53:10.386904 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m18:53:10.398649 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m18:53:10.472284 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m18:53:10.485874 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m18:53:10.487406 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m18:53:10.488796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:53:10.514274 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:53:10.515875 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m18:53:10.517257 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m18:53:10.523108 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                           ^

[0m18:53:10.524473 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m18:53:10.529252 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m18:53:10.542839 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m18:53:10.546730 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a8ef35f-0feb-49ef-9c23-7eebe4f13cbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3958dc1dd0>]}
[0m18:53:10.549102 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.17s]
[0m18:53:10.551311 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m18:53:10.552829 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m18:53:10.555278 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m18:53:10.557377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m18:53:10.559470 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m18:53:10.567129 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m18:53:10.579879 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m18:53:10.586940 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m18:53:10.598372 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m18:53:10.599844 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m18:53:10.601157 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:53:10.630581 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:53:10.632195 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m18:53:10.633567 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m18:53:10.638929 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                           ^

[0m18:53:10.640688 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m18:53:10.645003 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m18:53:10.649711 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m18:53:10.651817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a8ef35f-0feb-49ef-9c23-7eebe4f13cbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3958c47210>]}
[0m18:53:10.654451 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.09s]
[0m18:53:10.656484 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m18:53:10.658233 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m18:53:10.660031 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m18:53:10.661970 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m18:53:10.663633 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m18:53:10.669922 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m18:53:10.682303 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m18:53:10.689681 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m18:53:10.701865 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m18:53:10.703412 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m18:53:10.704876 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:53:10.731183 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:53:10.732857 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m18:53:10.734191 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m18:53:10.738835 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."films"
                           ^

[0m18:53:10.740571 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m18:53:10.745767 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m18:53:10.750369 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m18:53:10.752540 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a8ef35f-0feb-49ef-9c23-7eebe4f13cbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f395990a110>]}
[0m18:53:10.754914 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.09s]
[0m18:53:10.757078 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m18:53:10.759865 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m18:53:10.761566 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m18:53:10.763473 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m18:53:10.766773 [debug] [MainThread]: Using postgres connection "master"
[0m18:53:10.768450 [debug] [MainThread]: On master: BEGIN
[0m18:53:10.769883 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:53:10.796693 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:53:10.798587 [debug] [MainThread]: On master: COMMIT
[0m18:53:10.800063 [debug] [MainThread]: Using postgres connection "master"
[0m18:53:10.801412 [debug] [MainThread]: On master: COMMIT
[0m18:53:10.806541 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:53:10.808307 [debug] [MainThread]: On master: Close
[0m18:53:10.810296 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:53:10.812025 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m18:53:10.813992 [info ] [MainThread]: 
[0m18:53:10.815615 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.67 seconds (0.67s).
[0m18:53:10.818531 [debug] [MainThread]: Command end result
[0m18:53:10.892940 [info ] [MainThread]: 
[0m18:53:10.894600 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m18:53:10.896015 [info ] [MainThread]: 
[0m18:53:10.897445 [error] [MainThread]:   Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m18:53:10.898781 [info ] [MainThread]: 
[0m18:53:10.900125 [error] [MainThread]:   Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m18:53:10.901409 [info ] [MainThread]: 
[0m18:53:10.902716 [error] [MainThread]:   Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m18:53:10.904105 [info ] [MainThread]: 
[0m18:53:10.905551 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m18:53:10.908671 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.5961616, "process_user_time": 2.382608, "process_kernel_time": 0.309932, "process_mem_max_rss": "107872", "process_in_blocks": "100848", "process_out_blocks": "1152", "command_success": false}
[0m18:53:10.910653 [debug] [MainThread]: Command `dbt run` failed at 18:53:10.910412 after 1.60 seconds
[0m18:53:10.912335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f395a3b3650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f395dd98e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f395a37ec10>]}
[0m18:53:10.914477 [debug] [MainThread]: Flushing usage events
[0m18:54:13.681483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db5efb110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db5e665d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db5efa110>]}


============================== 18:54:13.688268 | 2cac5b48-106c-47b2-8eeb-42d04cb9bd5e ==============================
[0m18:54:13.688268 [info ] [MainThread]: Running with dbt=1.8.1
[0m18:54:13.689809 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:54:13.888295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2cac5b48-106c-47b2-8eeb-42d04cb9bd5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db5efab50>]}
[0m18:54:13.938773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2cac5b48-106c-47b2-8eeb-42d04cb9bd5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db7c4b310>]}
[0m18:54:13.941107 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m18:54:13.954451 [debug] [MainThread]: checksum: 8dc0a8b3d70f1f34b0ae4fcce5e5a1fd7ffa186bf54a1762a302cc92429dddc4, vars: {}, profile: custom_postgres, target: dev, version: 1.8.1
[0m18:54:14.244051 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:54:14.245256 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:54:14.295074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2cac5b48-106c-47b2-8eeb-42d04cb9bd5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db5305710>]}
[0m18:54:14.436009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2cac5b48-106c-47b2-8eeb-42d04cb9bd5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db5250190>]}
[0m18:54:14.437145 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 413 macros
[0m18:54:14.438324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cac5b48-106c-47b2-8eeb-42d04cb9bd5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db555e290>]}
[0m18:54:14.441306 [info ] [MainThread]: 
[0m18:54:14.442621 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:54:14.447708 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m18:54:14.499749 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m18:54:14.501131 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m18:54:14.502036 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:54:14.528775 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m18:54:14.531130 [debug] [ThreadPool]: On list_destination_db: Close
[0m18:54:14.533693 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m18:54:14.542760 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m18:54:14.543889 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m18:54:14.544912 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:54:14.563562 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:54:14.564785 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m18:54:14.565775 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:54:14.571742 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m18:54:14.574112 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m18:54:14.577681 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m18:54:14.584385 [debug] [MainThread]: Using postgres connection "master"
[0m18:54:14.585684 [debug] [MainThread]: On master: BEGIN
[0m18:54:14.586687 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:54:14.605891 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:54:14.607219 [debug] [MainThread]: Using postgres connection "master"
[0m18:54:14.608364 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:54:14.614294 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m18:54:14.616606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cac5b48-106c-47b2-8eeb-42d04cb9bd5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db5466610>]}
[0m18:54:14.617941 [debug] [MainThread]: On master: ROLLBACK
[0m18:54:14.621345 [debug] [MainThread]: Using postgres connection "master"
[0m18:54:14.622430 [debug] [MainThread]: On master: BEGIN
[0m18:54:14.627875 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:54:14.629266 [debug] [MainThread]: On master: COMMIT
[0m18:54:14.630333 [debug] [MainThread]: Using postgres connection "master"
[0m18:54:14.631342 [debug] [MainThread]: On master: COMMIT
[0m18:54:14.635163 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:54:14.636751 [debug] [MainThread]: On master: Close
[0m18:54:14.638309 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:54:14.639786 [info ] [MainThread]: 
[0m18:54:14.651188 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m18:54:14.653004 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m18:54:14.654618 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m18:54:14.655922 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m18:54:14.671463 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m18:54:14.685503 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m18:54:14.747766 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m18:54:14.757333 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m18:54:14.758732 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m18:54:14.759820 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:54:14.779566 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:54:14.780978 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m18:54:14.782090 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m18:54:14.786473 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                           ^

[0m18:54:14.787778 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m18:54:14.791868 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m18:54:14.802634 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m18:54:14.805920 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cac5b48-106c-47b2-8eeb-42d04cb9bd5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db45c1c90>]}
[0m18:54:14.808130 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.15s]
[0m18:54:14.810023 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m18:54:14.811495 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m18:54:14.813600 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m18:54:14.815292 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m18:54:14.816875 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m18:54:14.822304 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m18:54:14.832694 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m18:54:14.839363 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m18:54:14.850360 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m18:54:14.851725 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m18:54:14.852870 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:54:14.875122 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:54:14.876638 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m18:54:14.877825 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m18:54:14.882206 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                           ^

[0m18:54:14.883609 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m18:54:14.887463 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m18:54:14.891424 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m18:54:14.893186 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cac5b48-106c-47b2-8eeb-42d04cb9bd5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db4627dd0>]}
[0m18:54:14.895300 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.08s]
[0m18:54:14.897367 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m18:54:14.898937 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m18:54:14.900417 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m18:54:14.901925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m18:54:14.903390 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m18:54:14.909066 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m18:54:14.920721 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m18:54:14.927793 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m18:54:14.938465 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m18:54:14.939861 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m18:54:14.941276 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:54:14.965952 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:54:14.967518 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m18:54:14.968748 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m18:54:14.973689 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."films"
                           ^

[0m18:54:14.975401 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m18:54:14.979693 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m18:54:14.984398 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m18:54:14.986561 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cac5b48-106c-47b2-8eeb-42d04cb9bd5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db45d4650>]}
[0m18:54:14.988937 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.08s]
[0m18:54:14.991378 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m18:54:14.993762 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m18:54:14.995466 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m18:54:14.997004 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m18:54:15.000249 [debug] [MainThread]: Using postgres connection "master"
[0m18:54:15.001707 [debug] [MainThread]: On master: BEGIN
[0m18:54:15.003065 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:54:15.029112 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:54:15.030782 [debug] [MainThread]: On master: COMMIT
[0m18:54:15.032271 [debug] [MainThread]: Using postgres connection "master"
[0m18:54:15.033599 [debug] [MainThread]: On master: COMMIT
[0m18:54:15.038243 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:54:15.039905 [debug] [MainThread]: On master: Close
[0m18:54:15.041584 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:54:15.042838 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m18:54:15.044155 [info ] [MainThread]: 
[0m18:54:15.045419 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m18:54:15.048598 [debug] [MainThread]: Command end result
[0m18:54:15.122632 [info ] [MainThread]: 
[0m18:54:15.124461 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m18:54:15.126061 [info ] [MainThread]: 
[0m18:54:15.127678 [error] [MainThread]:   Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m18:54:15.129178 [info ] [MainThread]: 
[0m18:54:15.130795 [error] [MainThread]:   Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m18:54:15.132279 [info ] [MainThread]: 
[0m18:54:15.133893 [error] [MainThread]:   Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m18:54:15.135467 [info ] [MainThread]: 
[0m18:54:15.137268 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m18:54:15.147136 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.5247847, "process_user_time": 2.228408, "process_kernel_time": 0.302498, "process_mem_max_rss": "107728", "process_in_blocks": "100696", "process_out_blocks": "1152", "command_success": false}
[0m18:54:15.149630 [debug] [MainThread]: Command `dbt run` failed at 18:54:15.149351 after 1.53 seconds
[0m18:54:15.151257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db5f0a2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db9734b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db53b1dd0>]}
[0m18:54:15.152758 [debug] [MainThread]: Flushing usage events
[0m18:57:46.556685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34126f8f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34128ea850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34128eb790>]}


============================== 18:57:46.563923 | a5a069c6-5963-46f4-8e87-7ebcda74ea6e ==============================
[0m18:57:46.563923 [info ] [MainThread]: Running with dbt=1.8.1
[0m18:57:46.565205 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:57:46.763978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a5a069c6-5963-46f4-8e87-7ebcda74ea6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f341273a150>]}
[0m18:57:46.820197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a5a069c6-5963-46f4-8e87-7ebcda74ea6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3414642f90>]}
[0m18:57:46.822330 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m18:57:46.837289 [debug] [MainThread]: checksum: 8dc0a8b3d70f1f34b0ae4fcce5e5a1fd7ffa186bf54a1762a302cc92429dddc4, vars: {}, profile: custom_postgres, target: dev, version: 1.8.1
[0m18:57:47.130760 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:57:47.131935 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:57:47.181355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5a069c6-5963-46f4-8e87-7ebcda74ea6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3411eccf90>]}
[0m18:57:47.314899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5a069c6-5963-46f4-8e87-7ebcda74ea6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3411ea2890>]}
[0m18:57:47.315960 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 413 macros
[0m18:57:47.317030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5a069c6-5963-46f4-8e87-7ebcda74ea6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3411cb7350>]}
[0m18:57:47.319821 [info ] [MainThread]: 
[0m18:57:47.321035 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:57:47.325743 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m18:57:47.375582 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m18:57:47.376907 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m18:57:47.378003 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:57:47.405348 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m18:57:47.407643 [debug] [ThreadPool]: On list_destination_db: Close
[0m18:57:47.410379 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m18:57:47.417933 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m18:57:47.419157 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m18:57:47.420103 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:57:47.439454 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:57:47.440757 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m18:57:47.441890 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:57:47.449525 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m18:57:47.452432 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m18:57:47.457150 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m18:57:47.466099 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:47.467667 [debug] [MainThread]: On master: BEGIN
[0m18:57:47.468821 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:57:47.494059 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:57:47.495808 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:47.497203 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:57:47.504791 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m18:57:47.507443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5a069c6-5963-46f4-8e87-7ebcda74ea6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3411f2b690>]}
[0m18:57:47.508798 [debug] [MainThread]: On master: ROLLBACK
[0m18:57:47.513426 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:47.515113 [debug] [MainThread]: On master: BEGIN
[0m18:57:47.522890 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:57:47.524448 [debug] [MainThread]: On master: COMMIT
[0m18:57:47.525672 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:47.526885 [debug] [MainThread]: On master: COMMIT
[0m18:57:47.530808 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:57:47.532299 [debug] [MainThread]: On master: Close
[0m18:57:47.534146 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:57:47.535810 [info ] [MainThread]: 
[0m18:57:47.549380 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m18:57:47.551380 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m18:57:47.553196 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m18:57:47.555010 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m18:57:47.568212 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m18:57:47.580020 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m18:57:47.634087 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m18:57:47.644057 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m18:57:47.645259 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m18:57:47.646344 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:57:47.666081 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:57:47.667439 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m18:57:47.668538 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m18:57:47.673168 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                           ^

[0m18:57:47.674338 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m18:57:47.678169 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m18:57:47.689202 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m18:57:47.692066 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5a069c6-5963-46f4-8e87-7ebcda74ea6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3410fa9590>]}
[0m18:57:47.693798 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.14s]
[0m18:57:47.695510 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m18:57:47.697018 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m18:57:47.699099 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m18:57:47.700490 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m18:57:47.701814 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m18:57:47.706684 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m18:57:47.716872 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m18:57:47.723257 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m18:57:47.733592 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m18:57:47.735077 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m18:57:47.736294 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:57:47.760234 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:57:47.761868 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m18:57:47.763349 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m18:57:47.767824 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                           ^

[0m18:57:47.769179 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m18:57:47.773737 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m18:57:47.778071 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m18:57:47.780081 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5a069c6-5963-46f4-8e87-7ebcda74ea6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3413ee0b10>]}
[0m18:57:47.781920 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.08s]
[0m18:57:47.783646 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m18:57:47.785406 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m18:57:47.787225 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m18:57:47.789486 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m18:57:47.790836 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m18:57:47.796416 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m18:57:47.807844 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m18:57:47.815140 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m18:57:47.826433 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m18:57:47.827981 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m18:57:47.829423 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:57:47.854544 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:57:47.856288 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m18:57:47.857637 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m18:57:47.862080 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."films"
                           ^

[0m18:57:47.863654 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m18:57:47.868017 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m18:57:47.872163 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m18:57:47.874000 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5a069c6-5963-46f4-8e87-7ebcda74ea6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3410fa88d0>]}
[0m18:57:47.875704 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.08s]
[0m18:57:47.877975 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m18:57:47.880663 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m18:57:47.882163 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m18:57:47.883945 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m18:57:47.887116 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:47.888629 [debug] [MainThread]: On master: BEGIN
[0m18:57:47.889869 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:57:47.916397 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:57:47.918247 [debug] [MainThread]: On master: COMMIT
[0m18:57:47.919675 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:47.920973 [debug] [MainThread]: On master: COMMIT
[0m18:57:47.925475 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:57:47.927300 [debug] [MainThread]: On master: Close
[0m18:57:47.928990 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:57:47.930397 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m18:57:47.931986 [info ] [MainThread]: 
[0m18:57:47.933417 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m18:57:47.935813 [debug] [MainThread]: Command end result
[0m18:57:48.005594 [info ] [MainThread]: 
[0m18:57:48.007117 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m18:57:48.008432 [info ] [MainThread]: 
[0m18:57:48.009681 [error] [MainThread]:   Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m18:57:48.010834 [info ] [MainThread]: 
[0m18:57:48.011959 [error] [MainThread]:   Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m18:57:48.013116 [info ] [MainThread]: 
[0m18:57:48.014341 [error] [MainThread]:   Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m18:57:48.015497 [info ] [MainThread]: 
[0m18:57:48.016744 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m18:57:48.019801 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.5231034, "process_user_time": 2.255671, "process_kernel_time": 0.331107, "process_mem_max_rss": "107916", "process_in_blocks": "100840", "process_out_blocks": "1152", "command_success": false}
[0m18:57:48.021455 [debug] [MainThread]: Command `dbt run` failed at 18:57:48.021273 after 1.52 seconds
[0m18:57:48.022931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f341274f5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f341274f050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3416114d10>]}
[0m18:57:48.024604 [debug] [MainThread]: Flushing usage events
[0m19:00:38.862323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b51b38250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b51b3ae10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b51b3a990>]}


============================== 19:00:38.870024 | 8880f475-f222-4f42-a39e-9ff1307c7568 ==============================
[0m19:00:38.870024 [info ] [MainThread]: Running with dbt=1.8.1
[0m19:00:38.871488 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'version_check': 'True', 'profiles_dir': '/root', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:00:39.062748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8880f475-f222-4f42-a39e-9ff1307c7568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b51f86dd0>]}
[0m19:00:39.113381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8880f475-f222-4f42-a39e-9ff1307c7568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b53a47690>]}
[0m19:00:39.115737 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m19:00:39.128424 [debug] [MainThread]: checksum: 8dc0a8b3d70f1f34b0ae4fcce5e5a1fd7ffa186bf54a1762a302cc92429dddc4, vars: {}, profile: custom_postgres, target: dev, version: 1.8.1
[0m19:00:39.408271 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:00:39.409740 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:00:39.455369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8880f475-f222-4f42-a39e-9ff1307c7568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b51b78850>]}
[0m19:00:39.585434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8880f475-f222-4f42-a39e-9ff1307c7568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b51064090>]}
[0m19:00:39.586490 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 413 macros
[0m19:00:39.587608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8880f475-f222-4f42-a39e-9ff1307c7568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b552e4650>]}
[0m19:00:39.590849 [info ] [MainThread]: 
[0m19:00:39.592643 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:00:39.597522 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m19:00:39.648194 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m19:00:39.649766 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m19:00:39.650965 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:00:39.678463 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m19:00:39.680863 [debug] [ThreadPool]: On list_destination_db: Close
[0m19:00:39.683550 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m19:00:39.691492 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m19:00:39.692567 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m19:00:39.693481 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:00:39.711835 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:00:39.713010 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m19:00:39.713897 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:00:39.719521 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m19:00:39.721667 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m19:00:39.724357 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m19:00:39.730788 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:39.732038 [debug] [MainThread]: On master: BEGIN
[0m19:00:39.732958 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:00:39.752998 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:00:39.754586 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:39.755991 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:00:39.762971 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m19:00:39.765711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8880f475-f222-4f42-a39e-9ff1307c7568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b52a9e210>]}
[0m19:00:39.766972 [debug] [MainThread]: On master: ROLLBACK
[0m19:00:39.770521 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:39.771695 [debug] [MainThread]: On master: BEGIN
[0m19:00:39.777538 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:00:39.778953 [debug] [MainThread]: On master: COMMIT
[0m19:00:39.780166 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:39.781162 [debug] [MainThread]: On master: COMMIT
[0m19:00:39.785030 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:00:39.786483 [debug] [MainThread]: On master: Close
[0m19:00:39.787975 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:00:39.789789 [info ] [MainThread]: 
[0m19:00:39.801835 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m19:00:39.803596 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m19:00:39.805410 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m19:00:39.806937 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m19:00:39.818950 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m19:00:39.829305 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m19:00:39.884875 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m19:00:39.893877 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m19:00:39.894968 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m19:00:39.895927 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:39.914873 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:00:39.916194 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m19:00:39.917233 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m19:00:39.921576 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                           ^

[0m19:00:39.922740 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m19:00:39.926349 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m19:00:39.937616 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m19:00:39.940627 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8880f475-f222-4f42-a39e-9ff1307c7568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b511b22d0>]}
[0m19:00:39.942407 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.13s]
[0m19:00:39.944396 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m19:00:39.945736 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m19:00:39.947901 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m19:00:39.949905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m19:00:39.951289 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m19:00:39.956927 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m19:00:39.967776 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m19:00:39.973750 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m19:00:39.984751 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m19:00:39.986119 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m19:00:39.987405 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:40.012305 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:00:40.013920 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m19:00:40.015206 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m19:00:40.019834 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                           ^

[0m19:00:40.021746 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m19:00:40.026331 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m19:00:40.031949 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m19:00:40.034177 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8880f475-f222-4f42-a39e-9ff1307c7568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b511c6b50>]}
[0m19:00:40.036161 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.08s]
[0m19:00:40.038473 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m19:00:40.040465 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m19:00:40.042822 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m19:00:40.044932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m19:00:40.046458 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m19:00:40.053792 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m19:00:40.066534 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m19:00:40.073999 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m19:00:40.086486 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m19:00:40.087842 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m19:00:40.089176 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:40.114648 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:00:40.116354 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m19:00:40.117868 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m19:00:40.122789 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."films"
                           ^

[0m19:00:40.124334 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m19:00:40.128892 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m19:00:40.133502 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m19:00:40.135457 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8880f475-f222-4f42-a39e-9ff1307c7568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b511c6b50>]}
[0m19:00:40.137425 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.09s]
[0m19:00:40.139467 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m19:00:40.142339 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m19:00:40.144124 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m19:00:40.145926 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m19:00:40.149329 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:40.150967 [debug] [MainThread]: On master: BEGIN
[0m19:00:40.152264 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:00:40.180420 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:00:40.182209 [debug] [MainThread]: On master: COMMIT
[0m19:00:40.183829 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:40.185221 [debug] [MainThread]: On master: COMMIT
[0m19:00:40.190983 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:00:40.192924 [debug] [MainThread]: On master: Close
[0m19:00:40.194907 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:00:40.196375 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m19:00:40.198100 [info ] [MainThread]: 
[0m19:00:40.200089 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m19:00:40.203248 [debug] [MainThread]: Command end result
[0m19:00:40.297877 [info ] [MainThread]: 
[0m19:00:40.299557 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m19:00:40.300918 [info ] [MainThread]: 
[0m19:00:40.302390 [error] [MainThread]:   Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m19:00:40.303814 [info ] [MainThread]: 
[0m19:00:40.305211 [error] [MainThread]:   Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m19:00:40.306526 [info ] [MainThread]: 
[0m19:00:40.307882 [error] [MainThread]:   Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m19:00:40.309239 [info ] [MainThread]: 
[0m19:00:40.310631 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m19:00:40.313884 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.5119413, "process_user_time": 2.257803, "process_kernel_time": 0.354363, "process_mem_max_rss": "107792", "process_in_blocks": "100848", "process_out_blocks": "1152", "command_success": false}
[0m19:00:40.315633 [debug] [MainThread]: Command `dbt run` failed at 19:00:40.315441 after 1.51 seconds
[0m19:00:40.317155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b51b8f7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b51b3a4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b5553c350>]}
[0m19:00:40.318984 [debug] [MainThread]: Flushing usage events
[0m19:15:34.607260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3407f20c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f340a86a6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3409938050>]}


============================== 19:15:34.614136 | d827b1e3-7268-447d-93ea-43b9daf8c8db ==============================
[0m19:15:34.614136 [info ] [MainThread]: Running with dbt=1.8.1
[0m19:15:34.615419 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:15:34.793620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd827b1e3-7268-447d-93ea-43b9daf8c8db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34077377d0>]}
[0m19:15:34.842182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd827b1e3-7268-447d-93ea-43b9daf8c8db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3409e2f850>]}
[0m19:15:34.844216 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m19:15:34.856433 [debug] [MainThread]: checksum: 8dc0a8b3d70f1f34b0ae4fcce5e5a1fd7ffa186bf54a1762a302cc92429dddc4, vars: {}, profile: custom_postgres, target: dev, version: 1.8.1
[0m19:15:34.953149 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m19:15:34.954814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd827b1e3-7268-447d-93ea-43b9daf8c8db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3409514d90>]}
[0m19:15:35.922910 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m19:15:35.924504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd827b1e3-7268-447d-93ea-43b9daf8c8db', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f340810ea50>]}
[0m19:15:36.291352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd827b1e3-7268-447d-93ea-43b9daf8c8db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34054bd9d0>]}
[0m19:15:36.422085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd827b1e3-7268-447d-93ea-43b9daf8c8db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f340752d750>]}
[0m19:15:36.423175 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 413 macros
[0m19:15:36.424155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd827b1e3-7268-447d-93ea-43b9daf8c8db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34054be1d0>]}
[0m19:15:36.426847 [info ] [MainThread]: 
[0m19:15:36.427958 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:15:36.432372 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m19:15:36.478648 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m19:15:36.480032 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m19:15:36.480962 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:15:36.752338 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:

[0m19:15:36.800614 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m19:15:36.801836 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m19:15:36.802795 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m19:15:36.803533 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m19:15:36.804302 [debug] [ThreadPool]: On list_destination_db: No close available on handle
[0m19:15:36.805532 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:15:36.806307 [debug] [MainThread]: Connection 'list_destination_db' was properly closed.
[0m19:15:36.807049 [info ] [MainThread]: 
[0m19:15:36.807906 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m19:15:36.808893 [error] [MainThread]: Encountered an error:
Database Error
  
[0m19:15:36.810752 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.2650352, "process_user_time": 2.715549, "process_kernel_time": 0.315991, "process_mem_max_rss": "109956", "process_in_blocks": "100800", "process_out_blocks": "1056", "command_success": false}
[0m19:15:36.811731 [debug] [MainThread]: Command `dbt run` failed at 19:15:36.811626 after 2.27 seconds
[0m19:15:36.812542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3407f77490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3407f77550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3407f77050>]}
[0m19:15:36.813320 [debug] [MainThread]: Flushing usage events
[0m19:36:04.251870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe609153010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe60918f610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe60918f410>]}


============================== 19:36:04.258940 | 5b77bbd6-0368-4488-a78e-3c23046352d6 ==============================
[0m19:36:04.258940 [info ] [MainThread]: Running with dbt=1.8.1
[0m19:36:04.260179 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'debug': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:36:04.440741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b77bbd6-0368-4488-a78e-3c23046352d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe60918f310>]}
[0m19:36:04.490264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5b77bbd6-0368-4488-a78e-3c23046352d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe60b09b150>]}
[0m19:36:04.492517 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m19:36:04.504827 [debug] [MainThread]: checksum: 8dc0a8b3d70f1f34b0ae4fcce5e5a1fd7ffa186bf54a1762a302cc92429dddc4, vars: {}, profile: custom_postgres, target: dev, version: 1.8.1
[0m19:36:04.600792 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m19:36:04.602570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5b77bbd6-0368-4488-a78e-3c23046352d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe60a8fee10>]}
[0m19:36:05.574723 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m19:36:05.576318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5b77bbd6-0368-4488-a78e-3c23046352d6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6087b5f50>]}
[0m19:36:05.927902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b77bbd6-0368-4488-a78e-3c23046352d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe606511f50>]}
[0m19:36:06.115324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b77bbd6-0368-4488-a78e-3c23046352d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe608627450>]}
[0m19:36:06.116594 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 413 macros
[0m19:36:06.117707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b77bbd6-0368-4488-a78e-3c23046352d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6063edd10>]}
[0m19:36:06.120556 [info ] [MainThread]: 
[0m19:36:06.121842 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:36:06.126637 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m19:36:06.175232 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m19:36:06.176477 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m19:36:06.177296 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:36:06.202621 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m19:36:06.204874 [debug] [ThreadPool]: On list_destination_db: Close
[0m19:36:06.207204 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m19:36:06.214168 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m19:36:06.215533 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m19:36:06.216458 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:36:06.232974 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:36:06.234111 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m19:36:06.235038 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:36:06.240420 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m19:36:06.242292 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m19:36:06.244744 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m19:36:06.250947 [debug] [MainThread]: Using postgres connection "master"
[0m19:36:06.252183 [debug] [MainThread]: On master: BEGIN
[0m19:36:06.253046 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:36:06.269876 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:36:06.271109 [debug] [MainThread]: Using postgres connection "master"
[0m19:36:06.272065 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:36:06.277495 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m19:36:06.279392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b77bbd6-0368-4488-a78e-3c23046352d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6087339d0>]}
[0m19:36:06.280384 [debug] [MainThread]: On master: ROLLBACK
[0m19:36:06.282961 [debug] [MainThread]: Using postgres connection "master"
[0m19:36:06.283755 [debug] [MainThread]: On master: BEGIN
[0m19:36:06.287999 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:36:06.288984 [debug] [MainThread]: On master: COMMIT
[0m19:36:06.289913 [debug] [MainThread]: Using postgres connection "master"
[0m19:36:06.290806 [debug] [MainThread]: On master: COMMIT
[0m19:36:06.294112 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:36:06.295183 [debug] [MainThread]: On master: Close
[0m19:36:06.296260 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:36:06.297282 [info ] [MainThread]: 
[0m19:36:06.309453 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m19:36:06.310994 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m19:36:06.312792 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m19:36:06.314100 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m19:36:06.324635 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m19:36:06.333466 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m19:36:06.374761 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m19:36:06.382485 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m19:36:06.383521 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m19:36:06.384498 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:36:06.400713 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:36:06.401913 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m19:36:06.402879 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m19:36:06.407540 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                           ^

[0m19:36:06.408614 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m19:36:06.411814 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m19:36:06.421517 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m19:36:06.424163 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b77bbd6-0368-4488-a78e-3c23046352d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6063ee310>]}
[0m19:36:06.425958 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.11s]
[0m19:36:06.427628 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m19:36:06.428881 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m19:36:06.430977 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m19:36:06.432581 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m19:36:06.433858 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m19:36:06.438573 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m19:36:06.447274 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m19:36:06.454016 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m19:36:06.462321 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m19:36:06.463435 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m19:36:06.464605 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:36:06.484034 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:36:06.485371 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m19:36:06.486315 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m19:36:06.489724 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                           ^

[0m19:36:06.490993 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m19:36:06.494711 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m19:36:06.497852 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m19:36:06.499415 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b77bbd6-0368-4488-a78e-3c23046352d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe605866e50>]}
[0m19:36:06.501013 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.07s]
[0m19:36:06.502375 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m19:36:06.503542 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m19:36:06.504895 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m19:36:06.506204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m19:36:06.507394 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m19:36:06.511372 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m19:36:06.520001 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m19:36:06.525497 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m19:36:06.533741 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m19:36:06.534821 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m19:36:06.535700 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:36:06.553974 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:36:06.555226 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m19:36:06.556154 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m19:36:06.560223 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."films"
                           ^

[0m19:36:06.561604 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m19:36:06.565938 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m19:36:06.569441 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m19:36:06.571215 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b77bbd6-0368-4488-a78e-3c23046352d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe60595ef90>]}
[0m19:36:06.573156 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.07s]
[0m19:36:06.574868 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m19:36:06.576767 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m19:36:06.578060 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m19:36:06.579411 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m19:36:06.581975 [debug] [MainThread]: Using postgres connection "master"
[0m19:36:06.583312 [debug] [MainThread]: On master: BEGIN
[0m19:36:06.584424 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:36:06.603761 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:36:06.605097 [debug] [MainThread]: On master: COMMIT
[0m19:36:06.606032 [debug] [MainThread]: Using postgres connection "master"
[0m19:36:06.606914 [debug] [MainThread]: On master: COMMIT
[0m19:36:06.610110 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:36:06.611390 [debug] [MainThread]: On master: Close
[0m19:36:06.612873 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:36:06.614059 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m19:36:06.615201 [info ] [MainThread]: 
[0m19:36:06.616373 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m19:36:06.618654 [debug] [MainThread]: Command end result
[0m19:36:06.670903 [info ] [MainThread]: 
[0m19:36:06.672080 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m19:36:06.673086 [info ] [MainThread]: 
[0m19:36:06.674199 [error] [MainThread]:   Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m19:36:06.675130 [info ] [MainThread]: 
[0m19:36:06.676049 [error] [MainThread]:   Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m19:36:06.676874 [info ] [MainThread]: 
[0m19:36:06.677740 [error] [MainThread]:   Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m19:36:06.678536 [info ] [MainThread]: 
[0m19:36:06.679376 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m19:36:06.681534 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.4860682, "process_user_time": 2.992051, "process_kernel_time": 0.210144, "process_mem_max_rss": "111484", "process_in_blocks": "101328", "process_out_blocks": "1152", "command_success": false}
[0m19:36:06.682984 [debug] [MainThread]: Command `dbt run` failed at 19:36:06.682830 after 2.49 seconds
[0m19:36:06.683966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6091852d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6091522d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6091a7550>]}
[0m19:36:06.684868 [debug] [MainThread]: Flushing usage events
[0m19:37:25.956258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f5d89f210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f5d89ec90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f5de09d50>]}


============================== 19:37:25.963984 | bed3ec61-f1d5-4f2e-ba5f-680e426e6660 ==============================
[0m19:37:25.963984 [info ] [MainThread]: Running with dbt=1.8.1
[0m19:37:25.965399 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'send_anonymous_usage_stats': 'True'}
[0m19:37:26.043186 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "custom_postgres", target "dev" invalid: '5434:5432' is not of type 'integer'
[0m19:37:26.046033 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.15285501, "process_user_time": 1.470667, "process_kernel_time": 0.104302, "process_mem_max_rss": "91432", "process_in_blocks": "94408", "process_out_blocks": "1008", "command_success": false}
[0m19:37:26.047358 [debug] [MainThread]: Command `dbt run` failed at 19:37:26.047205 after 0.15 seconds
[0m19:37:26.048360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f5d6e0a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f5d89e490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f5d73f710>]}
[0m19:37:26.049492 [debug] [MainThread]: Flushing usage events
[0m19:39:13.637694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cb0415710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cb04155d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cb0416790>]}


============================== 19:39:13.644563 | f08d551c-0382-4087-a5f4-70a24d8c22b6 ==============================
[0m19:39:13.644563 [info ] [MainThread]: Running with dbt=1.8.1
[0m19:39:13.646248 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root', 'log_path': '/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:39:13.818142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f08d551c-0382-4087-a5f4-70a24d8c22b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cafa56e50>]}
[0m19:39:13.863948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f08d551c-0382-4087-a5f4-70a24d8c22b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cb215f550>]}
[0m19:39:13.866153 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m19:39:13.877811 [debug] [MainThread]: checksum: 8dc0a8b3d70f1f34b0ae4fcce5e5a1fd7ffa186bf54a1762a302cc92429dddc4, vars: {}, profile: custom_postgres, target: dev, version: 1.8.1
[0m19:39:14.122317 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:39:14.123351 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:39:14.166490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f08d551c-0382-4087-a5f4-70a24d8c22b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9caf81dc90>]}
[0m19:39:14.290497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f08d551c-0382-4087-a5f4-70a24d8c22b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9caf7e33d0>]}
[0m19:39:14.291654 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 413 macros
[0m19:39:14.292658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f08d551c-0382-4087-a5f4-70a24d8c22b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cb1167e90>]}
[0m19:39:14.295238 [info ] [MainThread]: 
[0m19:39:14.296435 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:39:14.300924 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m19:39:14.347230 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m19:39:14.348414 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m19:39:14.349186 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:39:14.373726 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m19:39:14.375773 [debug] [ThreadPool]: On list_destination_db: Close
[0m19:39:14.377876 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m19:39:14.384524 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m19:39:14.385413 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m19:39:14.386150 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:39:14.401451 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:39:14.402526 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m19:39:14.403356 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:39:14.408300 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m19:39:14.410130 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m19:39:14.412506 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m19:39:14.418001 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:14.418914 [debug] [MainThread]: On master: BEGIN
[0m19:39:14.419762 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:39:14.437311 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:39:14.438563 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:14.439481 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:39:14.445364 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m19:39:14.447575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f08d551c-0382-4087-a5f4-70a24d8c22b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9caf7ee590>]}
[0m19:39:14.448622 [debug] [MainThread]: On master: ROLLBACK
[0m19:39:14.452006 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:14.453147 [debug] [MainThread]: On master: BEGIN
[0m19:39:14.458019 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:39:14.459292 [debug] [MainThread]: On master: COMMIT
[0m19:39:14.460207 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:14.461033 [debug] [MainThread]: On master: COMMIT
[0m19:39:14.464076 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:39:14.465152 [debug] [MainThread]: On master: Close
[0m19:39:14.466621 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:39:14.468060 [info ] [MainThread]: 
[0m19:39:14.476998 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m19:39:14.478371 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m19:39:14.479591 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m19:39:14.480649 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m19:39:14.489349 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m19:39:14.497000 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m19:39:14.537567 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m19:39:14.545143 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m19:39:14.546004 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m19:39:14.546799 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:14.562781 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:39:14.563833 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m19:39:14.564686 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m19:39:14.567618 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                           ^

[0m19:39:14.568501 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m19:39:14.571563 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m19:39:14.580464 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m19:39:14.582846 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f08d551c-0382-4087-a5f4-70a24d8c22b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9caecb7990>]}
[0m19:39:14.584207 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.10s]
[0m19:39:14.585431 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m19:39:14.586400 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m19:39:14.588240 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m19:39:14.589696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m19:39:14.590738 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m19:39:14.595006 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m19:39:14.602827 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m19:39:14.607839 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m19:39:14.615182 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m19:39:14.616205 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m19:39:14.617055 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:14.635544 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:39:14.636934 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m19:39:14.638114 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m19:39:14.642031 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                           ^

[0m19:39:14.643100 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m19:39:14.646237 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m19:39:14.649879 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m19:39:14.651701 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f08d551c-0382-4087-a5f4-70a24d8c22b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9caeca4810>]}
[0m19:39:14.653272 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.06s]
[0m19:39:14.654839 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m19:39:14.656081 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m19:39:14.657194 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m19:39:14.658456 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m19:39:14.659554 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m19:39:14.663537 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m19:39:14.671779 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m19:39:14.677068 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m19:39:14.685084 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m19:39:14.686024 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m19:39:14.686829 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:14.704591 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:39:14.706008 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m19:39:14.707022 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m19:39:14.710785 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."films"
                           ^

[0m19:39:14.712097 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m19:39:14.715765 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m19:39:14.719078 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m19:39:14.720526 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f08d551c-0382-4087-a5f4-70a24d8c22b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9caead4f10>]}
[0m19:39:14.722367 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.06s]
[0m19:39:14.723888 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m19:39:14.725783 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m19:39:14.726978 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m19:39:14.728283 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m19:39:14.730993 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:14.732172 [debug] [MainThread]: On master: BEGIN
[0m19:39:14.733011 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:39:14.752992 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:39:14.754300 [debug] [MainThread]: On master: COMMIT
[0m19:39:14.755327 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:14.756124 [debug] [MainThread]: On master: COMMIT
[0m19:39:14.759710 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:39:14.760866 [debug] [MainThread]: On master: Close
[0m19:39:14.762067 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:39:14.763236 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m19:39:14.764502 [info ] [MainThread]: 
[0m19:39:14.765438 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m19:39:14.767113 [debug] [MainThread]: Command end result
[0m19:39:14.816152 [info ] [MainThread]: 
[0m19:39:14.817452 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m19:39:14.818435 [info ] [MainThread]: 
[0m19:39:14.819496 [error] [MainThread]:   Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m19:39:14.820509 [info ] [MainThread]: 
[0m19:39:14.821561 [error] [MainThread]:   Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m19:39:14.822471 [info ] [MainThread]: 
[0m19:39:14.823417 [error] [MainThread]:   Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m19:39:14.824312 [info ] [MainThread]: 
[0m19:39:14.825151 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m19:39:14.827327 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.2443392, "process_user_time": 1.784452, "process_kernel_time": 0.285512, "process_mem_max_rss": "106872", "process_in_blocks": "100848", "process_out_blocks": "1152", "command_success": false}
[0m19:39:14.828502 [debug] [MainThread]: Command `dbt run` failed at 19:39:14.828385 after 1.25 seconds
[0m19:39:14.829489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cb0426190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cb0265190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cb3c50b50>]}
[0m19:39:14.830514 [debug] [MainThread]: Flushing usage events
[0m19:47:22.643142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f1b05a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f2095e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f1b05510>]}


============================== 19:47:22.649809 | 61b1fc89-9a71-4cc3-92fc-55a9c960416b ==============================
[0m19:47:22.649809 [info ] [MainThread]: Running with dbt=1.8.1
[0m19:47:22.651005 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/root', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:47:22.826451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61b1fc89-9a71-4cc3-92fc-55a9c960416b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f1b69610>]}
[0m19:47:22.879006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '61b1fc89-9a71-4cc3-92fc-55a9c960416b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f3a0b750>]}
[0m19:47:22.881321 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m19:47:22.894234 [debug] [MainThread]: checksum: 8dc0a8b3d70f1f34b0ae4fcce5e5a1fd7ffa186bf54a1762a302cc92429dddc4, vars: {}, profile: custom_postgres, target: dev, version: 1.8.1
[0m19:47:23.133877 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:47:23.134849 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:47:23.179646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61b1fc89-9a71-4cc3-92fc-55a9c960416b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f10c9950>]}
[0m19:47:23.305978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61b1fc89-9a71-4cc3-92fc-55a9c960416b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f1bce490>]}
[0m19:47:23.306913 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 413 macros
[0m19:47:23.307801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61b1fc89-9a71-4cc3-92fc-55a9c960416b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f10b7ad0>]}
[0m19:47:23.310297 [info ] [MainThread]: 
[0m19:47:23.311419 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:47:23.315438 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m19:47:23.361642 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m19:47:23.362954 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m19:47:23.363809 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:47:23.386589 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m19:47:23.388675 [debug] [ThreadPool]: On list_destination_db: Close
[0m19:47:23.391070 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m19:47:23.398127 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m19:47:23.399137 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m19:47:23.399898 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:47:23.415535 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:47:23.416767 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m19:47:23.417633 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:47:23.422653 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m19:47:23.424554 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m19:47:23.427852 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m19:47:23.434892 [debug] [MainThread]: Using postgres connection "master"
[0m19:47:23.435995 [debug] [MainThread]: On master: BEGIN
[0m19:47:23.436807 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:47:23.453707 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:47:23.454949 [debug] [MainThread]: Using postgres connection "master"
[0m19:47:23.455883 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:47:23.461592 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m19:47:23.463872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61b1fc89-9a71-4cc3-92fc-55a9c960416b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f327d610>]}
[0m19:47:23.464921 [debug] [MainThread]: On master: ROLLBACK
[0m19:47:23.468006 [debug] [MainThread]: Using postgres connection "master"
[0m19:47:23.469095 [debug] [MainThread]: On master: BEGIN
[0m19:47:23.473491 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:47:23.474830 [debug] [MainThread]: On master: COMMIT
[0m19:47:23.475797 [debug] [MainThread]: Using postgres connection "master"
[0m19:47:23.476656 [debug] [MainThread]: On master: COMMIT
[0m19:47:23.479950 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:47:23.481049 [debug] [MainThread]: On master: Close
[0m19:47:23.482176 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:47:23.483329 [info ] [MainThread]: 
[0m19:47:23.493779 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m19:47:23.495286 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m19:47:23.496481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m19:47:23.497495 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m19:47:23.507380 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m19:47:23.514734 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m19:47:23.556801 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m19:47:23.564438 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m19:47:23.565296 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m19:47:23.566079 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:47:23.581658 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:47:23.582659 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m19:47:23.583492 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m19:47:23.587209 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                           ^

[0m19:47:23.588119 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m19:47:23.591157 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m19:47:23.600525 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m19:47:23.603044 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61b1fc89-9a71-4cc3-92fc-55a9c960416b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f0554f90>]}
[0m19:47:23.604574 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.11s]
[0m19:47:23.605951 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m19:47:23.606957 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m19:47:23.609216 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m19:47:23.610648 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m19:47:23.611654 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m19:47:23.615390 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m19:47:23.623032 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m19:47:23.628115 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m19:47:23.635999 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m19:47:23.636954 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m19:47:23.637776 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:47:23.655475 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:47:23.656638 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m19:47:23.657636 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m19:47:23.661171 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                           ^

[0m19:47:23.662400 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m19:47:23.665392 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m19:47:23.669195 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m19:47:23.670929 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61b1fc89-9a71-4cc3-92fc-55a9c960416b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f03b9f90>]}
[0m19:47:23.672700 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.06s]
[0m19:47:23.674314 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m19:47:23.675783 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m19:47:23.677180 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m19:47:23.678524 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m19:47:23.679546 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m19:47:23.683649 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m19:47:23.692040 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m19:47:23.696958 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m19:47:23.704942 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m19:47:23.705879 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m19:47:23.706693 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:47:23.724031 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:47:23.725632 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m19:47:23.726836 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m19:47:23.730651 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."films"
                           ^

[0m19:47:23.732024 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m19:47:23.735805 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m19:47:23.739363 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m19:47:23.740853 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61b1fc89-9a71-4cc3-92fc-55a9c960416b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f03c0110>]}
[0m19:47:23.742482 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.06s]
[0m19:47:23.743837 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m19:47:23.745749 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m19:47:23.746951 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m19:47:23.748002 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m19:47:23.750124 [debug] [MainThread]: Using postgres connection "master"
[0m19:47:23.751217 [debug] [MainThread]: On master: BEGIN
[0m19:47:23.752089 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:47:23.771305 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:47:23.772518 [debug] [MainThread]: On master: COMMIT
[0m19:47:23.773428 [debug] [MainThread]: Using postgres connection "master"
[0m19:47:23.774314 [debug] [MainThread]: On master: COMMIT
[0m19:47:23.777658 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:47:23.778932 [debug] [MainThread]: On master: Close
[0m19:47:23.780040 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:47:23.780866 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m19:47:23.781786 [info ] [MainThread]: 
[0m19:47:23.782858 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m19:47:23.784922 [debug] [MainThread]: Command end result
[0m19:47:23.835635 [info ] [MainThread]: 
[0m19:47:23.836789 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m19:47:23.837875 [info ] [MainThread]: 
[0m19:47:23.838958 [error] [MainThread]:   Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m19:47:23.839829 [info ] [MainThread]: 
[0m19:47:23.840836 [error] [MainThread]:   Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m19:47:23.841980 [info ] [MainThread]: 
[0m19:47:23.842937 [error] [MainThread]:   Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m19:47:23.843779 [info ] [MainThread]: 
[0m19:47:23.844619 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m19:47:23.846725 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.2590678, "process_user_time": 1.906782, "process_kernel_time": 0.23589, "process_mem_max_rss": "107700", "process_in_blocks": "100720", "process_out_blocks": "1152", "command_success": false}
[0m19:47:23.847881 [debug] [MainThread]: Command `dbt run` failed at 19:47:23.847714 after 1.26 seconds
[0m19:47:23.848815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f1cd2410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f1b275d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f54fcdd0>]}
[0m19:47:23.849725 [debug] [MainThread]: Flushing usage events
[0m19:51:59.851934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa406c0c0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa406fcd810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa406fcdcd0>]}


============================== 19:51:59.859984 | 34dbd0bd-2619-4fd7-bb8e-0ed837f39676 ==============================
[0m19:51:59.859984 [info ] [MainThread]: Running with dbt=1.8.1
[0m19:51:59.861471 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:52:00.079275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34dbd0bd-2619-4fd7-bb8e-0ed837f39676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa406a4b010>]}
[0m19:52:00.134274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34dbd0bd-2619-4fd7-bb8e-0ed837f39676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa40894b6d0>]}
[0m19:52:00.136857 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m19:52:00.150230 [debug] [MainThread]: checksum: 8dc0a8b3d70f1f34b0ae4fcce5e5a1fd7ffa186bf54a1762a302cc92429dddc4, vars: {}, profile: custom_postgres, target: dev, version: 1.8.1
[0m19:52:00.273728 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m19:52:00.275429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '34dbd0bd-2619-4fd7-bb8e-0ed837f39676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4081bb050>]}
[0m19:52:01.332925 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m19:52:01.334773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '34dbd0bd-2619-4fd7-bb8e-0ed837f39676', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4061ce990>]}
[0m19:52:01.717036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34dbd0bd-2619-4fd7-bb8e-0ed837f39676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3f7d23f90>]}
[0m19:52:01.859321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34dbd0bd-2619-4fd7-bb8e-0ed837f39676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa406205a50>]}
[0m19:52:01.860605 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 413 macros
[0m19:52:01.861750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34dbd0bd-2619-4fd7-bb8e-0ed837f39676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa405f95150>]}
[0m19:52:01.864889 [info ] [MainThread]: 
[0m19:52:01.866519 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:52:01.872870 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m19:52:01.932098 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m19:52:01.933516 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m19:52:01.934597 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:52:11.946434 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
timeout expired

[0m19:52:21.958248 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m19:52:21.959966 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m19:52:21.960957 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m19:52:21.961747 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m19:52:21.962549 [debug] [ThreadPool]: On list_destination_db: No close available on handle
[0m19:52:21.963972 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:52:21.964689 [debug] [MainThread]: Connection 'list_destination_db' was properly closed.
[0m19:52:21.965486 [info ] [MainThread]: 
[0m19:52:21.966701 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 20.10 seconds (20.10s).
[0m19:52:21.967927 [error] [MainThread]: Encountered an error:
Database Error
  timeout expired
  
[0m19:52:21.970290 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 22.186642, "process_user_time": 3.180073, "process_kernel_time": 0.29628, "process_mem_max_rss": "109384", "process_in_blocks": "99696", "process_out_blocks": "1056", "command_success": false}
[0m19:52:21.971395 [debug] [MainThread]: Command `dbt run` failed at 19:52:21.971267 after 22.19 seconds
[0m19:52:21.972341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa406a63010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa406c0e2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa406fcdcd0>]}
[0m19:52:21.973420 [debug] [MainThread]: Flushing usage events
[0m19:54:15.428136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafd34e8590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafd3527c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafd36d6210>]}


============================== 19:54:15.435139 | 7387a68c-4d4f-4352-b13d-7b1ce5317bd8 ==============================
[0m19:54:15.435139 [info ] [MainThread]: Running with dbt=1.8.1
[0m19:54:15.436607 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/dbt/logs', 'profiles_dir': '/root', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:54:15.640945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7387a68c-4d4f-4352-b13d-7b1ce5317bd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafd3528e10>]}
[0m19:54:15.702088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7387a68c-4d4f-4352-b13d-7b1ce5317bd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafd53ff390>]}
[0m19:54:15.704509 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m19:54:15.719933 [debug] [MainThread]: checksum: 8dc0a8b3d70f1f34b0ae4fcce5e5a1fd7ffa186bf54a1762a302cc92429dddc4, vars: {}, profile: custom_postgres, target: dev, version: 1.8.1
[0m19:54:15.849502 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m19:54:15.851192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7387a68c-4d4f-4352-b13d-7b1ce5317bd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafd4c6b290>]}
[0m19:54:16.921535 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m19:54:16.923510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7387a68c-4d4f-4352-b13d-7b1ce5317bd8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafd4463710>]}
[0m19:54:17.305113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7387a68c-4d4f-4352-b13d-7b1ce5317bd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafd5076890>]}
[0m19:54:17.456691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7387a68c-4d4f-4352-b13d-7b1ce5317bd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafd3a58d10>]}
[0m19:54:17.457809 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 413 macros
[0m19:54:17.458989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7387a68c-4d4f-4352-b13d-7b1ce5317bd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafd4becbd0>]}
[0m19:54:17.461828 [info ] [MainThread]: 
[0m19:54:17.463114 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:54:17.468168 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m19:54:17.523722 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m19:54:17.525294 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m19:54:17.526481 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:54:17.531668 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not connect to server: Connection refused
	Is the server running on host "elt-destination_postgres-1" (192.168.144.3) and accepting
	TCP/IP connections on port 5434?

[0m19:54:17.533941 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m19:54:17.535099 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m19:54:17.536273 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m19:54:17.537461 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m19:54:17.538575 [debug] [ThreadPool]: On list_destination_db: No close available on handle
[0m19:54:17.540299 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:54:17.541360 [debug] [MainThread]: Connection 'list_destination_db' was properly closed.
[0m19:54:17.542410 [info ] [MainThread]: 
[0m19:54:17.543834 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.08 seconds (0.08s).
[0m19:54:17.545320 [error] [MainThread]: Encountered an error:
Database Error
  could not connect to server: Connection refused
  	Is the server running on host "elt-destination_postgres-1" (192.168.144.3) and accepting
  	TCP/IP connections on port 5434?
  
[0m19:54:17.548178 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.177967, "process_user_time": 3.28761, "process_kernel_time": 0.206767, "process_mem_max_rss": "107312", "process_in_blocks": "100128", "process_out_blocks": "1056", "command_success": false}
[0m19:54:17.549819 [debug] [MainThread]: Command `dbt run` failed at 19:54:17.549654 after 2.18 seconds
[0m19:54:17.551007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafd34ea2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafd2b17310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafd351c110>]}
[0m19:54:17.552230 [debug] [MainThread]: Flushing usage events
[0m19:55:32.094891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb176623f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb175a44290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb175a46f10>]}


============================== 19:55:32.101697 | 7974ba05-f894-4218-8c53-0eca543216e1 ==============================
[0m19:55:32.101697 [info ] [MainThread]: Running with dbt=1.8.1
[0m19:55:32.103191 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:55:32.299364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7974ba05-f894-4218-8c53-0eca543216e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb175a36810>]}
[0m19:55:32.350574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7974ba05-f894-4218-8c53-0eca543216e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1777872d0>]}
[0m19:55:32.352683 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m19:55:32.365899 [debug] [MainThread]: checksum: 8dc0a8b3d70f1f34b0ae4fcce5e5a1fd7ffa186bf54a1762a302cc92429dddc4, vars: {}, profile: custom_postgres, target: dev, version: 1.8.1
[0m19:55:32.481969 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m19:55:32.483795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7974ba05-f894-4218-8c53-0eca543216e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb176ff3190>]}
[0m19:55:33.610928 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m19:55:33.612855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7974ba05-f894-4218-8c53-0eca543216e1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb175052750>]}
[0m19:55:33.977273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7974ba05-f894-4218-8c53-0eca543216e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16eb5f1d0>]}
[0m19:55:34.104683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7974ba05-f894-4218-8c53-0eca543216e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1773adb50>]}
[0m19:55:34.105729 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 413 macros
[0m19:55:34.106926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7974ba05-f894-4218-8c53-0eca543216e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16eb47210>]}
[0m19:55:34.109725 [info ] [MainThread]: 
[0m19:55:34.110960 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:55:34.115496 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m19:55:34.164731 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m19:55:34.166077 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m19:55:34.166996 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:55:44.178604 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
timeout expired

[0m19:55:54.188638 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m19:55:54.190134 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m19:55:54.191242 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m19:55:54.192115 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m19:55:54.192928 [debug] [ThreadPool]: On list_destination_db: No close available on handle
[0m19:55:54.194284 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:55:54.195078 [debug] [MainThread]: Connection 'list_destination_db' was properly closed.
[0m19:55:54.196068 [info ] [MainThread]: 
[0m19:55:54.197429 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 20.09 seconds (20.09s).
[0m19:55:54.198721 [error] [MainThread]: Encountered an error:
Database Error
  timeout expired
  
[0m19:55:54.201296 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 22.166727, "process_user_time": 3.130949, "process_kernel_time": 0.318064, "process_mem_max_rss": "109236", "process_in_blocks": "99712", "process_out_blocks": "1056", "command_success": false}
[0m19:55:54.202618 [debug] [MainThread]: Command `dbt run` failed at 19:55:54.202492 after 22.17 seconds
[0m19:55:54.203583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb175878990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb174ddf050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb174f2e550>]}
[0m19:55:54.204491 [debug] [MainThread]: Flushing usage events
[0m19:57:38.710623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb5322e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb58c1d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb58c1a90>]}


============================== 19:57:38.718020 | c962fa1c-7d9f-49c0-a305-f9c6e18b15f1 ==============================
[0m19:57:38.718020 [info ] [MainThread]: Running with dbt=1.8.1
[0m19:57:38.719334 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'version_check': 'True', 'debug': 'False', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:57:38.920062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c962fa1c-7d9f-49c0-a305-f9c6e18b15f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb5360e10>]}
[0m19:57:38.971115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c962fa1c-7d9f-49c0-a305-f9c6e18b15f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb7237850>]}
[0m19:57:38.973159 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m19:57:38.986707 [debug] [MainThread]: checksum: 8dc0a8b3d70f1f34b0ae4fcce5e5a1fd7ffa186bf54a1762a302cc92429dddc4, vars: {}, profile: custom_postgres, target: dev, version: 1.8.1
[0m19:57:39.105741 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m19:57:39.107217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c962fa1c-7d9f-49c0-a305-f9c6e18b15f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb6aa30d0>]}
[0m19:57:40.174238 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m19:57:40.176074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c962fa1c-7d9f-49c0-a305-f9c6e18b15f1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb48a2650>]}
[0m19:57:40.552536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c962fa1c-7d9f-49c0-a305-f9c6e18b15f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb40ddfd0>]}
[0m19:57:40.692515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c962fa1c-7d9f-49c0-a305-f9c6e18b15f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb47d9090>]}
[0m19:57:40.693582 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 413 macros
[0m19:57:40.694852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c962fa1c-7d9f-49c0-a305-f9c6e18b15f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eae51a310>]}
[0m19:57:40.697754 [info ] [MainThread]: 
[0m19:57:40.698942 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:57:40.703546 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m19:57:40.755583 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m19:57:40.756989 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m19:57:40.758075 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:57:40.786404 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m19:57:40.788840 [debug] [ThreadPool]: On list_destination_db: Close
[0m19:57:40.791600 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m19:57:40.799235 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m19:57:40.800495 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m19:57:40.801459 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:57:40.819970 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:57:40.821212 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m19:57:40.822184 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:57:40.829364 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m19:57:40.831719 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m19:57:40.835740 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m19:57:40.843149 [debug] [MainThread]: Using postgres connection "master"
[0m19:57:40.844576 [debug] [MainThread]: On master: BEGIN
[0m19:57:40.845649 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:57:40.866491 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:57:40.867913 [debug] [MainThread]: Using postgres connection "master"
[0m19:57:40.869149 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:57:40.876787 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m19:57:40.879375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c962fa1c-7d9f-49c0-a305-f9c6e18b15f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb49f8fd0>]}
[0m19:57:40.880850 [debug] [MainThread]: On master: ROLLBACK
[0m19:57:40.885005 [debug] [MainThread]: Using postgres connection "master"
[0m19:57:40.886458 [debug] [MainThread]: On master: BEGIN
[0m19:57:40.892321 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:57:40.893723 [debug] [MainThread]: On master: COMMIT
[0m19:57:40.894864 [debug] [MainThread]: Using postgres connection "master"
[0m19:57:40.895966 [debug] [MainThread]: On master: COMMIT
[0m19:57:40.899401 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:57:40.900478 [debug] [MainThread]: On master: Close
[0m19:57:40.901821 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:57:40.903038 [info ] [MainThread]: 
[0m19:57:40.915080 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m19:57:40.916972 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m19:57:40.918594 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m19:57:40.920082 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m19:57:40.930860 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m19:57:40.940905 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m19:57:40.994232 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m19:57:41.003914 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m19:57:41.005094 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m19:57:41.006239 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:57:41.026340 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:57:41.027806 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m19:57:41.028945 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m19:57:41.033813 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                           ^

[0m19:57:41.034989 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m19:57:41.038777 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m19:57:41.049851 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m19:57:41.052919 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c962fa1c-7d9f-49c0-a305-f9c6e18b15f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ead95f3d0>]}
[0m19:57:41.054761 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.13s]
[0m19:57:41.056575 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m19:57:41.059087 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m19:57:41.061914 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m19:57:41.063809 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m19:57:41.065151 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m19:57:41.071145 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m19:57:41.082397 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m19:57:41.090694 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m19:57:41.101548 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m19:57:41.103036 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m19:57:41.104411 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:57:41.129081 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:57:41.130813 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m19:57:41.132163 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m19:57:41.137234 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                           ^

[0m19:57:41.138880 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m19:57:41.143172 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m19:57:41.147676 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m19:57:41.149750 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c962fa1c-7d9f-49c0-a305-f9c6e18b15f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ead95cfd0>]}
[0m19:57:41.152348 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.09s]
[0m19:57:41.154398 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m19:57:41.156027 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m19:57:41.157692 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m19:57:41.159609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m19:57:41.161171 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m19:57:41.166906 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m19:57:41.179024 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m19:57:41.186495 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m19:57:41.197479 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m19:57:41.199007 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m19:57:41.200309 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:57:41.224897 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:57:41.226929 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m19:57:41.228394 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m19:57:41.233040 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."films"
                           ^

[0m19:57:41.234760 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m19:57:41.239390 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m19:57:41.243830 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m19:57:41.245924 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c962fa1c-7d9f-49c0-a305-f9c6e18b15f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ead95d090>]}
[0m19:57:41.247824 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.09s]
[0m19:57:41.249816 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m19:57:41.252863 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m19:57:41.254519 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m19:57:41.256125 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m19:57:41.259626 [debug] [MainThread]: Using postgres connection "master"
[0m19:57:41.261306 [debug] [MainThread]: On master: BEGIN
[0m19:57:41.262738 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:57:41.290088 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:57:41.291770 [debug] [MainThread]: On master: COMMIT
[0m19:57:41.293329 [debug] [MainThread]: Using postgres connection "master"
[0m19:57:41.294834 [debug] [MainThread]: On master: COMMIT
[0m19:57:41.299737 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:57:41.301654 [debug] [MainThread]: On master: Close
[0m19:57:41.303685 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:57:41.305070 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m19:57:41.306675 [info ] [MainThread]: 
[0m19:57:41.308083 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m19:57:41.311283 [debug] [MainThread]: Command end result
[0m19:57:41.386692 [info ] [MainThread]: 
[0m19:57:41.388452 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m19:57:41.389886 [info ] [MainThread]: 
[0m19:57:41.391457 [error] [MainThread]:   Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m19:57:41.392818 [info ] [MainThread]: 
[0m19:57:41.394259 [error] [MainThread]:   Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m19:57:41.395970 [info ] [MainThread]: 
[0m19:57:41.397400 [error] [MainThread]:   Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m19:57:41.398892 [info ] [MainThread]: 
[0m19:57:41.400611 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m19:57:41.403991 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.7549324, "process_user_time": 3.540862, "process_kernel_time": 0.309202, "process_mem_max_rss": "112360", "process_in_blocks": "101328", "process_out_blocks": "1152", "command_success": false}
[0m19:57:41.406006 [debug] [MainThread]: Command `dbt run` failed at 19:57:41.405742 after 2.76 seconds
[0m19:57:41.408059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb5322110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb8d20b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb8d20cd0>]}
[0m19:57:41.409879 [debug] [MainThread]: Flushing usage events
[0m20:01:38.269018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f758beb0dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f758c456250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f758c09f850>]}


============================== 20:01:38.277154 | 5f39028e-6c7d-4fa9-9bcb-9cfc2b322935 ==============================
[0m20:01:38.277154 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:01:38.278616 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'profiles_dir': '/root', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:01:38.516528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f39028e-6c7d-4fa9-9bcb-9cfc2b322935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f758b657b10>]}
[0m20:01:38.576786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f39028e-6c7d-4fa9-9bcb-9cfc2b322935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f758ddc3a90>]}
[0m20:01:38.579323 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m20:01:38.597412 [debug] [MainThread]: checksum: 8dc0a8b3d70f1f34b0ae4fcce5e5a1fd7ffa186bf54a1762a302cc92429dddc4, vars: {}, profile: custom_postgres, target: dev, version: 1.8.1
[0m20:01:39.019612 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:01:39.020926 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:01:39.082433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f39028e-6c7d-4fa9-9bcb-9cfc2b322935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f758b45c4d0>]}
[0m20:01:39.243542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f39028e-6c7d-4fa9-9bcb-9cfc2b322935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f758b3dc090>]}
[0m20:01:39.244585 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 413 macros
[0m20:01:39.245675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f39028e-6c7d-4fa9-9bcb-9cfc2b322935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f758b53f8d0>]}
[0m20:01:39.248735 [info ] [MainThread]: 
[0m20:01:39.250099 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:01:39.254927 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m20:01:39.304307 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m20:01:39.305876 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m20:01:39.307071 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:01:39.335023 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m20:01:39.337397 [debug] [ThreadPool]: On list_destination_db: Close
[0m20:01:39.340070 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m20:01:39.348002 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m20:01:39.349107 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m20:01:39.350052 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:01:39.368837 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:01:39.370133 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m20:01:39.371241 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:01:39.377696 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m20:01:39.379799 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m20:01:39.382720 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m20:01:39.389688 [debug] [MainThread]: Using postgres connection "master"
[0m20:01:39.391168 [debug] [MainThread]: On master: BEGIN
[0m20:01:39.392279 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:01:39.412907 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:01:39.414386 [debug] [MainThread]: Using postgres connection "master"
[0m20:01:39.415772 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:01:39.424610 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m20:01:39.427194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f39028e-6c7d-4fa9-9bcb-9cfc2b322935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f758b473a10>]}
[0m20:01:39.428485 [debug] [MainThread]: On master: ROLLBACK
[0m20:01:39.432532 [debug] [MainThread]: Using postgres connection "master"
[0m20:01:39.434062 [debug] [MainThread]: On master: BEGIN
[0m20:01:39.440623 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:01:39.442553 [debug] [MainThread]: On master: COMMIT
[0m20:01:39.443811 [debug] [MainThread]: Using postgres connection "master"
[0m20:01:39.444940 [debug] [MainThread]: On master: COMMIT
[0m20:01:39.449213 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:01:39.450760 [debug] [MainThread]: On master: Close
[0m20:01:39.452311 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:01:39.453994 [info ] [MainThread]: 
[0m20:01:39.467009 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m20:01:39.468744 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m20:01:39.470295 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m20:01:39.471602 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m20:01:39.482992 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m20:01:39.493636 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m20:01:39.546649 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m20:01:39.555986 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m20:01:39.557164 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m20:01:39.558144 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:01:39.577262 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:01:39.578665 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m20:01:39.579880 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m20:01:39.585548 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                           ^

[0m20:01:39.587255 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m20:01:39.592041 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m20:01:39.605098 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m20:01:39.608906 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f39028e-6c7d-4fa9-9bcb-9cfc2b322935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f758a90d2d0>]}
[0m20:01:39.611140 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.14s]
[0m20:01:39.613502 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m20:01:39.615459 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m20:01:39.618467 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m20:01:39.620324 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m20:01:39.621750 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m20:01:39.628494 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m20:01:39.642231 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m20:01:39.649464 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m20:01:39.661693 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m20:01:39.663262 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m20:01:39.664664 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:01:39.694737 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:01:39.696681 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m20:01:39.698183 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m20:01:39.703472 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                           ^

[0m20:01:39.704973 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m20:01:39.709803 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m20:01:39.714687 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m20:01:39.716943 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f39028e-6c7d-4fa9-9bcb-9cfc2b322935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f758b655d50>]}
[0m20:01:39.718976 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.10s]
[0m20:01:39.721052 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m20:01:39.722906 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m20:01:39.724888 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m20:01:39.726767 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m20:01:39.728582 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m20:01:39.734487 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m20:01:39.747029 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m20:01:39.754254 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m20:01:39.765434 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m20:01:39.767078 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m20:01:39.768454 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:01:39.794166 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:01:39.795965 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m20:01:39.797394 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m20:01:39.802924 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."films"
                           ^

[0m20:01:39.804608 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m20:01:39.809267 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m20:01:39.814519 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m20:01:39.816640 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f39028e-6c7d-4fa9-9bcb-9cfc2b322935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f758a918210>]}
[0m20:01:39.818543 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.09s]
[0m20:01:39.820691 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m20:01:39.823440 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m20:01:39.825465 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m20:01:39.827259 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m20:01:39.830277 [debug] [MainThread]: Using postgres connection "master"
[0m20:01:39.831949 [debug] [MainThread]: On master: BEGIN
[0m20:01:39.833390 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:01:39.860925 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:01:39.862746 [debug] [MainThread]: On master: COMMIT
[0m20:01:39.864297 [debug] [MainThread]: Using postgres connection "master"
[0m20:01:39.865918 [debug] [MainThread]: On master: COMMIT
[0m20:01:39.870577 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:01:39.872281 [debug] [MainThread]: On master: Close
[0m20:01:39.874097 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:01:39.875948 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m20:01:39.877393 [info ] [MainThread]: 
[0m20:01:39.878757 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m20:01:39.881130 [debug] [MainThread]: Command end result
[0m20:01:39.949848 [info ] [MainThread]: 
[0m20:01:39.951244 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m20:01:39.952478 [info ] [MainThread]: 
[0m20:01:39.953778 [error] [MainThread]:   Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m20:01:39.954943 [info ] [MainThread]: 
[0m20:01:39.956124 [error] [MainThread]:   Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m20:01:39.957181 [info ] [MainThread]: 
[0m20:01:39.958317 [error] [MainThread]:   Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m20:01:39.959439 [info ] [MainThread]: 
[0m20:01:39.960729 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m20:01:39.963443 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.762956, "process_user_time": 2.52547, "process_kernel_time": 0.320858, "process_mem_max_rss": "106852", "process_in_blocks": "100688", "process_out_blocks": "1152", "command_success": false}
[0m20:01:39.964950 [debug] [MainThread]: Command `dbt run` failed at 20:01:39.964787 after 1.76 seconds
[0m20:01:39.966374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f758bf074d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f758f8b4cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f758c09fad0>]}
[0m20:01:39.968179 [debug] [MainThread]: Flushing usage events
[0m20:01:45.364316 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m20:03:09.129993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a661ecc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a66791a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a663dab90>]}


============================== 20:03:09.137737 | d4abb467-642e-4545-97cf-1db1b2a3a7de ==============================
[0m20:03:09.137737 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:03:09.138999 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:03:09.336366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd4abb467-642e-4545-97cf-1db1b2a3a7de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a663da910>]}
[0m20:03:09.388018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd4abb467-642e-4545-97cf-1db1b2a3a7de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a6811f550>]}
[0m20:03:09.390048 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m20:03:09.403640 [debug] [MainThread]: checksum: 8dc0a8b3d70f1f34b0ae4fcce5e5a1fd7ffa186bf54a1762a302cc92429dddc4, vars: {}, profile: custom_postgres, target: dev, version: 1.8.1
[0m20:03:09.519314 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m20:03:09.521087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd4abb467-642e-4545-97cf-1db1b2a3a7de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a67987210>]}
[0m20:03:10.566756 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:03:10.568450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd4abb467-642e-4545-97cf-1db1b2a3a7de', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a656bbd10>]}
[0m20:03:10.942367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd4abb467-642e-4545-97cf-1db1b2a3a7de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a6571b8d0>]}
[0m20:03:11.071385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd4abb467-642e-4545-97cf-1db1b2a3a7de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a659f1490>]}
[0m20:03:11.072500 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 413 macros
[0m20:03:11.073531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4abb467-642e-4545-97cf-1db1b2a3a7de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a65921a50>]}
[0m20:03:11.076341 [info ] [MainThread]: 
[0m20:03:11.077617 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:03:11.082627 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m20:03:11.133295 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m20:03:11.134844 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m20:03:11.135854 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:03:21.147646 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
timeout expired

[0m20:03:31.159282 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m20:03:31.160610 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m20:03:31.161571 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m20:03:31.162323 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m20:03:31.163073 [debug] [ThreadPool]: On list_destination_db: No close available on handle
[0m20:03:31.164234 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:03:31.164968 [debug] [MainThread]: Connection 'list_destination_db' was properly closed.
[0m20:03:31.165854 [info ] [MainThread]: 
[0m20:03:31.166921 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 20.09 seconds (20.09s).
[0m20:03:31.168083 [error] [MainThread]: Encountered an error:
Database Error
  timeout expired
  
[0m20:03:31.170151 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 22.100443, "process_user_time": 3.1811, "process_kernel_time": 0.29364, "process_mem_max_rss": "109480", "process_in_blocks": "99712", "process_out_blocks": "1056", "command_success": false}
[0m20:03:31.171121 [debug] [MainThread]: Command `dbt run` failed at 20:03:31.171020 after 22.10 seconds
[0m20:03:31.171965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a662432d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a66243410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a65a5d7d0>]}
[0m20:03:31.172754 [debug] [MainThread]: Flushing usage events
[0m20:04:19.549136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb26ef08550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb26f3993d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb26f4b1e90>]}


============================== 20:04:19.556179 | 0648194e-b815-40f8-9187-1ae702b38d23 ==============================
[0m20:04:19.556179 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:04:19.557504 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'debug': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:04:19.755624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0648194e-b815-40f8-9187-1ae702b38d23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb26ef4a210>]}
[0m20:04:19.807559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0648194e-b815-40f8-9187-1ae702b38d23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb270e3f810>]}
[0m20:04:19.809616 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m20:04:19.823839 [debug] [MainThread]: checksum: 8dc0a8b3d70f1f34b0ae4fcce5e5a1fd7ffa186bf54a1762a302cc92429dddc4, vars: {}, profile: custom_postgres, target: dev, version: 1.8.1
[0m20:04:19.943717 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m20:04:19.945465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0648194e-b815-40f8-9187-1ae702b38d23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2706a32d0>]}
[0m20:04:21.069342 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:04:21.071103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0648194e-b815-40f8-9187-1ae702b38d23', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb26e62a0d0>]}
[0m20:04:21.447948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0648194e-b815-40f8-9187-1ae702b38d23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb27062bbd0>]}
[0m20:04:21.580865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0648194e-b815-40f8-9187-1ae702b38d23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb26e5348d0>]}
[0m20:04:21.581925 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 413 macros
[0m20:04:21.582982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0648194e-b815-40f8-9187-1ae702b38d23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb26c1a6610>]}
[0m20:04:21.585886 [info ] [MainThread]: 
[0m20:04:21.587280 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:04:21.592214 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m20:04:21.640976 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m20:04:21.642524 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m20:04:21.643732 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:04:42.692135 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not connect to server: Connection refused
	Is the server running on host "192.168.192.3" and accepting
	TCP/IP connections on port 5434?

[0m20:05:03.729254 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m20:05:03.730489 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m20:05:03.731469 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m20:05:03.732279 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m20:05:03.733111 [debug] [ThreadPool]: On list_destination_db: No close available on handle
[0m20:05:03.734462 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:05:03.735215 [debug] [MainThread]: Connection 'list_destination_db' was properly closed.
[0m20:05:03.736027 [info ] [MainThread]: 
[0m20:05:03.737111 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 42.15 seconds (42.15s).
[0m20:05:03.738196 [error] [MainThread]: Encountered an error:
Database Error
  could not connect to server: Connection refused
  	Is the server running on host "192.168.192.3" and accepting
  	TCP/IP connections on port 5434?
  
[0m20:05:03.740242 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 44.254444, "process_user_time": 3.277105, "process_kernel_time": 0.306699, "process_mem_max_rss": "109052", "process_in_blocks": "99712", "process_out_blocks": "1056", "command_success": false}
[0m20:05:03.741196 [debug] [MainThread]: Command `dbt run` failed at 20:05:03.741090 after 44.26 seconds
[0m20:05:03.742045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb26ef5f2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb26ef0a4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb26e3d4990>]}
[0m20:05:03.742838 [debug] [MainThread]: Flushing usage events
[0m20:07:33.433652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107d9fef90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107df95e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107dbea850>]}


============================== 20:07:33.441449 | 7cf67c8e-4f2e-453d-b7ac-3cb3f15914fd ==============================
[0m20:07:33.441449 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:07:33.442839 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:07:33.647139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7cf67c8e-4f2e-453d-b7ac-3cb3f15914fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107dbeaf10>]}
[0m20:07:33.699808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7cf67c8e-4f2e-453d-b7ac-3cb3f15914fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107f917310>]}
[0m20:07:33.701920 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m20:07:33.715364 [debug] [MainThread]: checksum: 8dc0a8b3d70f1f34b0ae4fcce5e5a1fd7ffa186bf54a1762a302cc92429dddc4, vars: {}, profile: custom_postgres, target: dev, version: 1.8.1
[0m20:07:33.833244 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m20:07:33.835103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7cf67c8e-4f2e-453d-b7ac-3cb3f15914fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107f17f090>]}
[0m20:07:34.937939 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:07:34.939814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7cf67c8e-4f2e-453d-b7ac-3cb3f15914fd', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107cfad290>]}
[0m20:07:35.360015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7cf67c8e-4f2e-453d-b7ac-3cb3f15914fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107ced8c10>]}
[0m20:07:35.518044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7cf67c8e-4f2e-453d-b7ac-3cb3f15914fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107d1cfd50>]}
[0m20:07:35.519219 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 413 macros
[0m20:07:35.520496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cf67c8e-4f2e-453d-b7ac-3cb3f15914fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107ceeb410>]}
[0m20:07:35.523333 [info ] [MainThread]: 
[0m20:07:35.524737 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:07:35.530041 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m20:07:35.580513 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m20:07:35.581941 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m20:07:35.583027 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:07:35.587860 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not connect to server: Connection refused
	Is the server running on host "destination_postgres" (192.168.240.3) and accepting
	TCP/IP connections on port 5434?

[0m20:07:35.589947 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m20:07:35.591092 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m20:07:35.592136 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m20:07:35.593090 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m20:07:35.594086 [debug] [ThreadPool]: On list_destination_db: No close available on handle
[0m20:07:35.595633 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:07:35.596522 [debug] [MainThread]: Connection 'list_destination_db' was properly closed.
[0m20:07:35.597496 [info ] [MainThread]: 
[0m20:07:35.598819 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.07 seconds (0.07s).
[0m20:07:35.600225 [error] [MainThread]: Encountered an error:
Database Error
  could not connect to server: Connection refused
  	Is the server running on host "destination_postgres" (192.168.240.3) and accepting
  	TCP/IP connections on port 5434?
  
[0m20:07:35.602608 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.2311532, "process_user_time": 3.279481, "process_kernel_time": 0.304595, "process_mem_max_rss": "109328", "process_in_blocks": "100128", "process_out_blocks": "1056", "command_success": false}
[0m20:07:35.603920 [debug] [MainThread]: Command `dbt run` failed at 20:07:35.603783 after 2.23 seconds
[0m20:07:35.605033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107da53350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107d9fe490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107d1fe990>]}
[0m20:07:35.606072 [debug] [MainThread]: Flushing usage events
[0m20:10:57.392336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa37642c890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa37661a390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa37642c750>]}


============================== 20:10:57.398962 | 01d26f75-67c9-477b-b718-a288badfcd66 ==============================
[0m20:10:57.398962 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:10:57.400151 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:10:57.577835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01d26f75-67c9-477b-b718-a288badfcd66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3769c9cd0>]}
[0m20:10:57.627355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01d26f75-67c9-477b-b718-a288badfcd66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa378337a90>]}
[0m20:10:57.629651 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m20:10:57.642439 [debug] [MainThread]: checksum: 8dc0a8b3d70f1f34b0ae4fcce5e5a1fd7ffa186bf54a1762a302cc92429dddc4, vars: {}, profile: custom_postgres, target: dev, version: 1.8.1
[0m20:10:57.741640 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m20:10:57.743143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '01d26f75-67c9-477b-b718-a288badfcd66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa377b9f2d0>]}
[0m20:10:58.740180 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:10:58.741840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '01d26f75-67c9-477b-b718-a288badfcd66', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3758a3450>]}
[0m20:10:59.091138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01d26f75-67c9-477b-b718-a288badfcd66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa375989250>]}
[0m20:10:59.215824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01d26f75-67c9-477b-b718-a288badfcd66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa375c4e390>]}
[0m20:10:59.216788 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 413 macros
[0m20:10:59.218097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01d26f75-67c9-477b-b718-a288badfcd66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa34b635450>]}
[0m20:10:59.220679 [info ] [MainThread]: 
[0m20:10:59.221804 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:10:59.226681 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m20:10:59.269247 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m20:10:59.270741 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m20:10:59.271866 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:59.296187 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m20:10:59.298502 [debug] [ThreadPool]: On list_destination_db: Close
[0m20:10:59.300773 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m20:10:59.307954 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m20:10:59.309083 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m20:10:59.310167 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:10:59.325586 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:10:59.326642 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m20:10:59.327491 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:10:59.332347 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m20:10:59.334129 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m20:10:59.336436 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m20:10:59.342011 [debug] [MainThread]: Using postgres connection "master"
[0m20:10:59.343149 [debug] [MainThread]: On master: BEGIN
[0m20:10:59.343984 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:10:59.360852 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:10:59.362186 [debug] [MainThread]: Using postgres connection "master"
[0m20:10:59.363524 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:10:59.369878 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m20:10:59.372409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01d26f75-67c9-477b-b718-a288badfcd66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa375a5f390>]}
[0m20:10:59.373646 [debug] [MainThread]: On master: ROLLBACK
[0m20:10:59.376608 [debug] [MainThread]: Using postgres connection "master"
[0m20:10:59.377432 [debug] [MainThread]: On master: BEGIN
[0m20:10:59.382331 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:10:59.383831 [debug] [MainThread]: On master: COMMIT
[0m20:10:59.384995 [debug] [MainThread]: Using postgres connection "master"
[0m20:10:59.385893 [debug] [MainThread]: On master: COMMIT
[0m20:10:59.389532 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:10:59.390826 [debug] [MainThread]: On master: Close
[0m20:10:59.392391 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:10:59.393718 [info ] [MainThread]: 
[0m20:10:59.404336 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m20:10:59.405883 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m20:10:59.407304 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m20:10:59.408485 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m20:10:59.417121 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m20:10:59.425454 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m20:10:59.466705 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m20:10:59.473973 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m20:10:59.474887 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m20:10:59.475676 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:59.491283 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:10:59.492384 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m20:10:59.493243 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m20:10:59.497530 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                           ^

[0m20:10:59.498724 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m20:10:59.502121 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m20:10:59.511080 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m20:10:59.513560 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01d26f75-67c9-477b-b718-a288badfcd66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa375aec250>]}
[0m20:10:59.514954 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.11s]
[0m20:10:59.516276 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m20:10:59.517225 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m20:10:59.518820 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m20:10:59.520082 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m20:10:59.521334 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m20:10:59.525842 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m20:10:59.534088 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m20:10:59.540377 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m20:10:59.548386 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m20:10:59.549429 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m20:10:59.550363 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:59.568846 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:10:59.570284 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m20:10:59.571534 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m20:10:59.575240 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                           ^

[0m20:10:59.576264 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m20:10:59.579741 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m20:10:59.583483 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m20:10:59.585038 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01d26f75-67c9-477b-b718-a288badfcd66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa34aaecdd0>]}
[0m20:10:59.586389 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.07s]
[0m20:10:59.588391 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m20:10:59.589865 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m20:10:59.590980 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m20:10:59.592330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m20:10:59.593420 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m20:10:59.597567 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m20:10:59.606134 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m20:10:59.611302 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m20:10:59.619440 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m20:10:59.620476 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m20:10:59.621612 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:59.639888 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:10:59.641116 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m20:10:59.642056 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m20:10:59.646043 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."films"
                           ^

[0m20:10:59.647736 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m20:10:59.651374 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m20:10:59.654770 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m20:10:59.656676 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01d26f75-67c9-477b-b718-a288badfcd66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa375ac93d0>]}
[0m20:10:59.658189 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.06s]
[0m20:10:59.659605 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m20:10:59.661380 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m20:10:59.662541 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m20:10:59.664295 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m20:10:59.666682 [debug] [MainThread]: Using postgres connection "master"
[0m20:10:59.667751 [debug] [MainThread]: On master: BEGIN
[0m20:10:59.668649 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:10:59.688441 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:10:59.689865 [debug] [MainThread]: On master: COMMIT
[0m20:10:59.690839 [debug] [MainThread]: Using postgres connection "master"
[0m20:10:59.691846 [debug] [MainThread]: On master: COMMIT
[0m20:10:59.695104 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:10:59.696538 [debug] [MainThread]: On master: Close
[0m20:10:59.698075 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:10:59.699148 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m20:10:59.700294 [info ] [MainThread]: 
[0m20:10:59.701266 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m20:10:59.702922 [debug] [MainThread]: Command end result
[0m20:10:59.753252 [info ] [MainThread]: 
[0m20:10:59.754670 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m20:10:59.755804 [info ] [MainThread]: 
[0m20:10:59.756751 [error] [MainThread]:   Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m20:10:59.757570 [info ] [MainThread]: 
[0m20:10:59.758586 [error] [MainThread]:   Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m20:10:59.759418 [info ] [MainThread]: 
[0m20:10:59.760372 [error] [MainThread]:   Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m20:10:59.761192 [info ] [MainThread]: 
[0m20:10:59.762155 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m20:10:59.764459 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.432179, "process_user_time": 3.031201, "process_kernel_time": 0.200741, "process_mem_max_rss": "112444", "process_in_blocks": "101328", "process_out_blocks": "1152", "command_success": false}
[0m20:10:59.765530 [debug] [MainThread]: Command `dbt run` failed at 20:10:59.765403 after 2.43 seconds
[0m20:10:59.766464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa376483910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa376483890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa376483450>]}
[0m20:10:59.767303 [debug] [MainThread]: Flushing usage events
[0m20:14:57.024268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2229fcef90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f222a565e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2229fcc050>]}


============================== 20:14:57.031214 | 2f4da9c3-8b21-483a-887c-b44f06b0019d ==============================
[0m20:14:57.031214 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:14:57.032364 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'debug': 'False', 'profiles_dir': '/root', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:14:57.209176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f4da9c3-8b21-483a-887c-b44f06b0019d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f222a00d8d0>]}
[0m20:14:57.258513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f4da9c3-8b21-483a-887c-b44f06b0019d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f222bedf550>]}
[0m20:14:57.260865 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m20:14:57.272552 [debug] [MainThread]: checksum: 8dc0a8b3d70f1f34b0ae4fcce5e5a1fd7ffa186bf54a1762a302cc92429dddc4, vars: {}, profile: custom_postgres, target: dev, version: 1.8.1
[0m20:14:57.521141 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:14:57.522676 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:14:57.565623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f4da9c3-8b21-483a-887c-b44f06b0019d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22295b2510>]}
[0m20:14:57.686669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f4da9c3-8b21-483a-887c-b44f06b0019d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22294f40d0>]}
[0m20:14:57.687616 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 413 macros
[0m20:14:57.688667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f4da9c3-8b21-483a-887c-b44f06b0019d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2229485d10>]}
[0m20:14:57.691283 [info ] [MainThread]: 
[0m20:14:57.692527 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:14:57.696684 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m20:14:57.743436 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m20:14:57.745087 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m20:14:57.746163 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:14:57.772614 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m20:14:57.775088 [debug] [ThreadPool]: On list_destination_db: Close
[0m20:14:57.778108 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m20:14:57.784910 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m20:14:57.785930 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m20:14:57.786802 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:14:57.801918 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:14:57.802985 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m20:14:57.803845 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:14:57.810749 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m20:14:57.812828 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m20:14:57.815365 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m20:14:57.821072 [debug] [MainThread]: Using postgres connection "master"
[0m20:14:57.822403 [debug] [MainThread]: On master: BEGIN
[0m20:14:57.823380 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:14:57.840695 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:14:57.841828 [debug] [MainThread]: Using postgres connection "master"
[0m20:14:57.842814 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:14:57.848502 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m20:14:57.850831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f4da9c3-8b21-483a-887c-b44f06b0019d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2229ffe790>]}
[0m20:14:57.852148 [debug] [MainThread]: On master: ROLLBACK
[0m20:14:57.855056 [debug] [MainThread]: Using postgres connection "master"
[0m20:14:57.855889 [debug] [MainThread]: On master: BEGIN
[0m20:14:57.859758 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:14:57.860628 [debug] [MainThread]: On master: COMMIT
[0m20:14:57.861420 [debug] [MainThread]: Using postgres connection "master"
[0m20:14:57.862210 [debug] [MainThread]: On master: COMMIT
[0m20:14:57.865049 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:14:57.865907 [debug] [MainThread]: On master: Close
[0m20:14:57.867026 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:14:57.868012 [info ] [MainThread]: 
[0m20:14:57.877790 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m20:14:57.879350 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m20:14:57.880577 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m20:14:57.881510 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m20:14:57.892060 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m20:14:57.901061 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m20:14:57.946425 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m20:14:57.953902 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m20:14:57.954955 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m20:14:57.955879 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:14:57.972448 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:14:57.973663 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m20:14:57.974631 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m20:14:57.978821 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                           ^

[0m20:14:57.979933 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m20:14:57.983217 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m20:14:57.992178 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m20:14:57.994557 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f4da9c3-8b21-483a-887c-b44f06b0019d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2229781c10>]}
[0m20:14:57.996248 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.11s]
[0m20:14:57.997569 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m20:14:57.998887 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m20:14:58.000630 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m20:14:58.001745 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m20:14:58.002822 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m20:14:58.007414 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m20:14:58.015853 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m20:14:58.020977 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m20:14:58.029409 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m20:14:58.030587 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m20:14:58.031451 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:14:58.066883 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:14:58.068153 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m20:14:58.069252 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m20:14:58.073139 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                           ^

[0m20:14:58.074211 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m20:14:58.077201 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m20:14:58.081029 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m20:14:58.082826 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f4da9c3-8b21-483a-887c-b44f06b0019d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f222889c190>]}
[0m20:14:58.084697 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.08s]
[0m20:14:58.086446 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m20:14:58.087726 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m20:14:58.088964 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m20:14:58.090375 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m20:14:58.091793 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m20:14:58.096654 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m20:14:58.104959 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m20:14:58.110555 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m20:14:58.118430 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m20:14:58.119556 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m20:14:58.120618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:14:58.139149 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:14:58.140558 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m20:14:58.141748 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m20:14:58.146534 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."films"
                           ^

[0m20:14:58.147863 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m20:14:58.151279 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m20:14:58.155435 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m20:14:58.157080 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f4da9c3-8b21-483a-887c-b44f06b0019d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f222b5da090>]}
[0m20:14:58.159334 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.07s]
[0m20:14:58.161132 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m20:14:58.163544 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m20:14:58.164794 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m20:14:58.166428 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m20:14:58.169224 [debug] [MainThread]: Using postgres connection "master"
[0m20:14:58.170694 [debug] [MainThread]: On master: BEGIN
[0m20:14:58.171783 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:14:58.192053 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:14:58.193284 [debug] [MainThread]: On master: COMMIT
[0m20:14:58.194302 [debug] [MainThread]: Using postgres connection "master"
[0m20:14:58.195196 [debug] [MainThread]: On master: COMMIT
[0m20:14:58.198448 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:14:58.199404 [debug] [MainThread]: On master: Close
[0m20:14:58.200489 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:14:58.201351 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m20:14:58.202324 [info ] [MainThread]: 
[0m20:14:58.203385 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m20:14:58.205305 [debug] [MainThread]: Command end result
[0m20:14:58.255849 [info ] [MainThread]: 
[0m20:14:58.257011 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m20:14:58.258093 [info ] [MainThread]: 
[0m20:14:58.259032 [error] [MainThread]:   Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m20:14:58.259999 [info ] [MainThread]: 
[0m20:14:58.260995 [error] [MainThread]:   Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m20:14:58.261850 [info ] [MainThread]: 
[0m20:14:58.262739 [error] [MainThread]:   Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m20:14:58.263523 [info ] [MainThread]: 
[0m20:14:58.264372 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m20:14:58.267121 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.2996902, "process_user_time": 2.000175, "process_kernel_time": 0.184482, "process_mem_max_rss": "107960", "process_in_blocks": "100688", "process_out_blocks": "1152", "command_success": false}
[0m20:14:58.268139 [debug] [MainThread]: Command `dbt run` failed at 20:14:58.268023 after 1.30 seconds
[0m20:14:58.269051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f222a0232d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f222a0234d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f222d9bcb90>]}
[0m20:14:58.270040 [debug] [MainThread]: Flushing usage events
[0m20:17:33.111288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16b466bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16ba09c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16bbef9d0>]}


============================== 20:17:33.118833 | f99055fe-60e9-4014-9a82-009436ae5481 ==============================
[0m20:17:33.118833 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:17:33.120347 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/root', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:17:33.307676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f99055fe-60e9-4014-9a82-009436ae5481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16b8b71d0>]}
[0m20:17:33.356382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f99055fe-60e9-4014-9a82-009436ae5481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16d3b2f10>]}
[0m20:17:33.358492 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m20:17:33.371723 [debug] [MainThread]: checksum: 8dc0a8b3d70f1f34b0ae4fcce5e5a1fd7ffa186bf54a1762a302cc92429dddc4, vars: {}, profile: custom_postgres, target: dev, version: 1.8.1
[0m20:17:33.626832 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m20:17:33.628431 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/films.sql
[0m20:17:33.629544 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/actors.sql
[0m20:17:33.630485 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/film_actors.sql
[0m20:17:33.631440 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/film_ratings.sql
[0m20:17:33.844631 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:17:33.846187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f99055fe-60e9-4014-9a82-009436ae5481', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16ac5ee50>]}
[0m20:17:34.047535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f99055fe-60e9-4014-9a82-009436ae5481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb168766d90>]}
[0m20:17:34.169039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f99055fe-60e9-4014-9a82-009436ae5481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16a9e1e10>]}
[0m20:17:34.170141 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 413 macros
[0m20:17:34.171167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f99055fe-60e9-4014-9a82-009436ae5481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16ab79690>]}
[0m20:17:34.173713 [info ] [MainThread]: 
[0m20:17:34.174876 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:17:34.179517 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m20:17:34.222416 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m20:17:34.224040 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m20:17:34.225074 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:17:34.249950 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m20:17:34.252113 [debug] [ThreadPool]: On list_destination_db: Close
[0m20:17:34.254366 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m20:17:34.261384 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m20:17:34.262403 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m20:17:34.263187 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:17:34.278229 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:17:34.279287 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m20:17:34.280139 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:17:34.285051 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m20:17:34.286841 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m20:17:34.289156 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m20:17:34.294678 [debug] [MainThread]: Using postgres connection "master"
[0m20:17:34.295946 [debug] [MainThread]: On master: BEGIN
[0m20:17:34.296891 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:17:34.313870 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:17:34.315073 [debug] [MainThread]: Using postgres connection "master"
[0m20:17:34.316098 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:17:34.322068 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m20:17:34.324329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f99055fe-60e9-4014-9a82-009436ae5481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16b8eef10>]}
[0m20:17:34.325813 [debug] [MainThread]: On master: ROLLBACK
[0m20:17:34.329252 [debug] [MainThread]: Using postgres connection "master"
[0m20:17:34.330395 [debug] [MainThread]: On master: BEGIN
[0m20:17:34.335335 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:17:34.336682 [debug] [MainThread]: On master: COMMIT
[0m20:17:34.337615 [debug] [MainThread]: Using postgres connection "master"
[0m20:17:34.338464 [debug] [MainThread]: On master: COMMIT
[0m20:17:34.341327 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:17:34.342311 [debug] [MainThread]: On master: Close
[0m20:17:34.343385 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:17:34.344309 [info ] [MainThread]: 
[0m20:17:34.354253 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m20:17:34.355644 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m20:17:34.356828 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m20:17:34.357775 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m20:17:34.366046 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m20:17:34.373912 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m20:17:34.417094 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m20:17:34.424705 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m20:17:34.425641 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m20:17:34.426422 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:17:34.441710 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:17:34.442881 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m20:17:34.443790 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors";
  );
  
[0m20:17:34.447874 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 12:     SELECT * FROM "destination_db"."public"."actors";
                                                             ^

[0m20:17:34.448893 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m20:17:34.452077 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m20:17:34.461284 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  syntax error at or near ";"
  LINE 12:     SELECT * FROM "destination_db"."public"."actors";
                                                               ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m20:17:34.463483 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f99055fe-60e9-4014-9a82-009436ae5481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16b8eef10>]}
[0m20:17:34.464720 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.11s]
[0m20:17:34.466244 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m20:17:34.467323 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m20:17:34.469132 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m20:17:34.470557 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m20:17:34.471557 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m20:17:34.475696 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m20:17:34.483889 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m20:17:34.488391 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m20:17:34.496453 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m20:17:34.497551 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m20:17:34.498525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:17:34.518163 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:17:34.519439 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m20:17:34.520379 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors";
  );
  
[0m20:17:34.524223 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 12:     SELECT * FROM "destination_db"."public"."film_actors";
                                                                  ^

[0m20:17:34.525677 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m20:17:34.529345 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m20:17:34.532786 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  syntax error at or near ";"
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors";
                                                                    ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m20:17:34.534466 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f99055fe-60e9-4014-9a82-009436ae5481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1683add90>]}
[0m20:17:34.535951 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.06s]
[0m20:17:34.537435 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m20:17:34.538963 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m20:17:34.540245 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m20:17:34.541542 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m20:17:34.542587 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m20:17:34.546641 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m20:17:34.555086 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m20:17:34.560152 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m20:17:34.568173 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m20:17:34.569339 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m20:17:34.570363 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:17:34.589056 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:17:34.590380 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m20:17:34.591478 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films";
  );
  
[0m20:17:34.595117 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 12:     SELECT * FROM "destination_db"."public"."films";
                                                            ^

[0m20:17:34.596533 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m20:17:34.600609 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m20:17:34.605284 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  syntax error at or near ";"
  LINE 12:     SELECT * FROM "destination_db"."public"."films";
                                                              ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m20:17:34.607351 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f99055fe-60e9-4014-9a82-009436ae5481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1680f6090>]}
[0m20:17:34.609088 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.07s]
[0m20:17:34.610442 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m20:17:34.612349 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m20:17:34.613533 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m20:17:34.614841 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m20:17:34.617398 [debug] [MainThread]: Using postgres connection "master"
[0m20:17:34.618518 [debug] [MainThread]: On master: BEGIN
[0m20:17:34.619457 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:17:34.639267 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:17:34.640584 [debug] [MainThread]: On master: COMMIT
[0m20:17:34.641637 [debug] [MainThread]: Using postgres connection "master"
[0m20:17:34.642553 [debug] [MainThread]: On master: COMMIT
[0m20:17:34.646546 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:17:34.647821 [debug] [MainThread]: On master: Close
[0m20:17:34.649109 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:17:34.650169 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m20:17:34.651175 [info ] [MainThread]: 
[0m20:17:34.652119 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m20:17:34.654403 [debug] [MainThread]: Command end result
[0m20:17:34.775451 [info ] [MainThread]: 
[0m20:17:34.776691 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m20:17:34.777762 [info ] [MainThread]: 
[0m20:17:34.778804 [error] [MainThread]:   Database Error in model actors (models/example/actors.sql)
  syntax error at or near ";"
  LINE 12:     SELECT * FROM "destination_db"."public"."actors";
                                                               ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m20:17:34.779748 [info ] [MainThread]: 
[0m20:17:34.780692 [error] [MainThread]:   Database Error in model film_actors (models/example/film_actors.sql)
  syntax error at or near ";"
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors";
                                                                    ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m20:17:34.781532 [info ] [MainThread]: 
[0m20:17:34.782484 [error] [MainThread]:   Database Error in model films (models/example/films.sql)
  syntax error at or near ";"
  LINE 12:     SELECT * FROM "destination_db"."public"."films";
                                                              ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m20:17:34.783326 [info ] [MainThread]: 
[0m20:17:34.784251 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m20:17:34.786651 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.7315906, "process_user_time": 2.32722, "process_kernel_time": 0.230715, "process_mem_max_rss": "111684", "process_in_blocks": "101328", "process_out_blocks": "1152", "command_success": false}
[0m20:17:34.787983 [debug] [MainThread]: Command `dbt run` failed at 20:17:34.787838 after 1.73 seconds
[0m20:17:34.788969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb168136790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb168136690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb168136750>]}
[0m20:17:34.789884 [debug] [MainThread]: Flushing usage events
[0m20:18:14.793737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c697f390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c6d563d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c697ee90>]}


============================== 20:18:14.800597 | dbea1803-d610-4eb5-b555-56340c8de380 ==============================
[0m20:18:14.800597 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:18:14.802217 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'version_check': 'True', 'debug': 'False', 'log_path': '/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'send_anonymous_usage_stats': 'True'}
[0m20:18:14.964894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dbea1803-d610-4eb5-b555-56340c8de380', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c67d1390>]}
[0m20:18:15.018071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dbea1803-d610-4eb5-b555-56340c8de380', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c86c38d0>]}
[0m20:18:15.020426 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m20:18:15.032423 [debug] [MainThread]: checksum: 8dc0a8b3d70f1f34b0ae4fcce5e5a1fd7ffa186bf54a1762a302cc92429dddc4, vars: {}, profile: custom_postgres, target: dev, version: 1.8.1
[0m20:18:15.285441 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m20:18:15.286911 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/film_actors.sql
[0m20:18:15.288080 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/films.sql
[0m20:18:15.289166 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/actors.sql
[0m20:18:15.290134 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/film_ratings.sql
[0m20:18:15.527035 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:18:15.528920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'dbea1803-d610-4eb5-b555-56340c8de380', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c67d0b10>]}
[0m20:18:15.761124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dbea1803-d610-4eb5-b555-56340c8de380', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6bfa60d50>]}
[0m20:18:15.884249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dbea1803-d610-4eb5-b555-56340c8de380', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c5ea2e90>]}
[0m20:18:15.885334 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 413 macros
[0m20:18:15.886570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbea1803-d610-4eb5-b555-56340c8de380', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6bfb8fad0>]}
[0m20:18:15.889785 [info ] [MainThread]: 
[0m20:18:15.891186 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:18:15.896332 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m20:18:15.940945 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m20:18:15.942651 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m20:18:15.944138 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:18:15.970764 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m20:18:15.973371 [debug] [ThreadPool]: On list_destination_db: Close
[0m20:18:15.976267 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m20:18:15.985366 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m20:18:15.986595 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m20:18:15.987670 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:18:16.007724 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:18:16.009019 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m20:18:16.010098 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:18:16.016679 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m20:18:16.018996 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m20:18:16.022135 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m20:18:16.029300 [debug] [MainThread]: Using postgres connection "master"
[0m20:18:16.030544 [debug] [MainThread]: On master: BEGIN
[0m20:18:16.031528 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:18:16.052985 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:18:16.054399 [debug] [MainThread]: Using postgres connection "master"
[0m20:18:16.055707 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:18:16.063468 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m20:18:16.066088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbea1803-d610-4eb5-b555-56340c8de380', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c5ea1790>]}
[0m20:18:16.067493 [debug] [MainThread]: On master: ROLLBACK
[0m20:18:16.071683 [debug] [MainThread]: Using postgres connection "master"
[0m20:18:16.073611 [debug] [MainThread]: On master: BEGIN
[0m20:18:16.080759 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:18:16.082135 [debug] [MainThread]: On master: COMMIT
[0m20:18:16.083318 [debug] [MainThread]: Using postgres connection "master"
[0m20:18:16.084449 [debug] [MainThread]: On master: COMMIT
[0m20:18:16.088374 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:18:16.089653 [debug] [MainThread]: On master: Close
[0m20:18:16.091167 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:18:16.092654 [info ] [MainThread]: 
[0m20:18:16.106220 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m20:18:16.108220 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m20:18:16.110111 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m20:18:16.111730 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m20:18:16.123541 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m20:18:16.134083 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m20:18:16.190978 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m20:18:16.200646 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m20:18:16.201778 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m20:18:16.202851 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:18:16.221927 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:18:16.223318 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m20:18:16.224447 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m20:18:16.228074 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                           ^

[0m20:18:16.229358 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m20:18:16.233495 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m20:18:16.239246 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m20:18:16.242602 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbea1803-d610-4eb5-b555-56340c8de380', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c5cc3610>]}
[0m20:18:16.244633 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.13s]
[0m20:18:16.246441 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m20:18:16.247874 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m20:18:16.250159 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m20:18:16.252200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m20:18:16.253565 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m20:18:16.259086 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m20:18:16.270196 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m20:18:16.276749 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m20:18:16.287646 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m20:18:16.289245 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m20:18:16.290517 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:18:16.315479 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:18:16.317310 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m20:18:16.319059 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m20:18:16.323983 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                           ^

[0m20:18:16.325512 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m20:18:16.330438 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m20:18:16.336241 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m20:18:16.338504 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbea1803-d610-4eb5-b555-56340c8de380', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c5e94d90>]}
[0m20:18:16.340462 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.09s]
[0m20:18:16.343084 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m20:18:16.345152 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m20:18:16.347044 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m20:18:16.349120 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m20:18:16.351005 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m20:18:16.356937 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m20:18:16.369142 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m20:18:16.376246 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m20:18:16.388292 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m20:18:16.389811 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m20:18:16.391164 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:18:16.419405 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:18:16.421253 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m20:18:16.422740 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m20:18:16.428649 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."films"
                           ^

[0m20:18:16.430415 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m20:18:16.435040 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m20:18:16.440715 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m20:18:16.443275 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbea1803-d610-4eb5-b555-56340c8de380', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6beed61d0>]}
[0m20:18:16.445713 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.09s]
[0m20:18:16.447802 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m20:18:16.450506 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m20:18:16.452589 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m20:18:16.454330 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m20:18:16.457496 [debug] [MainThread]: Using postgres connection "master"
[0m20:18:16.458831 [debug] [MainThread]: On master: BEGIN
[0m20:18:16.460109 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:18:16.489467 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:18:16.491261 [debug] [MainThread]: On master: COMMIT
[0m20:18:16.492896 [debug] [MainThread]: Using postgres connection "master"
[0m20:18:16.494451 [debug] [MainThread]: On master: COMMIT
[0m20:18:16.499334 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:18:16.501399 [debug] [MainThread]: On master: Close
[0m20:18:16.503373 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:18:16.504782 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m20:18:16.506397 [info ] [MainThread]: 
[0m20:18:16.508044 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m20:18:16.510988 [debug] [MainThread]: Command end result
[0m20:18:16.647884 [info ] [MainThread]: 
[0m20:18:16.649310 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m20:18:16.650479 [info ] [MainThread]: 
[0m20:18:16.651714 [error] [MainThread]:   Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m20:18:16.652765 [info ] [MainThread]: 
[0m20:18:16.653798 [error] [MainThread]:   Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m20:18:16.654759 [info ] [MainThread]: 
[0m20:18:16.655808 [error] [MainThread]:   Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m20:18:16.656916 [info ] [MainThread]: 
[0m20:18:16.657908 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m20:18:16.659664 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.9228718, "process_user_time": 2.799125, "process_kernel_time": 0.331079, "process_mem_max_rss": "114116", "process_out_blocks": "1152", "command_success": false, "process_in_blocks": "0"}
[0m20:18:16.661169 [debug] [MainThread]: Command `dbt run` failed at 20:18:16.660952 after 1.92 seconds
[0m20:18:16.662394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6bd44e910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6bd44e710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6bd44e690>]}
[0m20:18:16.663524 [debug] [MainThread]: Flushing usage events
[0m20:20:24.743854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f893b8fb0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f893b8fb890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f893be7e290>]}


============================== 20:20:24.750571 | a8521e54-8a6d-4221-ba75-e25c4d45be04 ==============================
[0m20:20:24.750571 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:20:24.751816 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:20:24.928097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8521e54-8a6d-4221-ba75-e25c4d45be04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f893b8fb650>]}
[0m20:20:24.975553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a8521e54-8a6d-4221-ba75-e25c4d45be04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f893d7fb410>]}
[0m20:20:24.977659 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m20:20:24.989620 [debug] [MainThread]: checksum: 8dc0a8b3d70f1f34b0ae4fcce5e5a1fd7ffa186bf54a1762a302cc92429dddc4, vars: {}, profile: custom_postgres, target: dev, version: 1.8.1
[0m20:20:25.236682 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:20:25.237936 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:20:25.282463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8521e54-8a6d-4221-ba75-e25c4d45be04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f893aeb5f10>]}
[0m20:20:25.405964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8521e54-8a6d-4221-ba75-e25c4d45be04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f893d40b8d0>]}
[0m20:20:25.406969 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 413 macros
[0m20:20:25.408010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8521e54-8a6d-4221-ba75-e25c4d45be04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f893af794d0>]}
[0m20:20:25.410534 [info ] [MainThread]: 
[0m20:20:25.411622 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:20:25.416021 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m20:20:25.460529 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m20:20:25.461838 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m20:20:25.462775 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:20:25.485396 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m20:20:25.487360 [debug] [ThreadPool]: On list_destination_db: Close
[0m20:20:25.489455 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m20:20:25.495975 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m20:20:25.497042 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m20:20:25.497855 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:20:25.513094 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:20:25.514252 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m20:20:25.515139 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:20:25.520197 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m20:20:25.522025 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m20:20:25.524623 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m20:20:25.530867 [debug] [MainThread]: Using postgres connection "master"
[0m20:20:25.531941 [debug] [MainThread]: On master: BEGIN
[0m20:20:25.532719 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:20:25.548755 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:20:25.550027 [debug] [MainThread]: Using postgres connection "master"
[0m20:20:25.550971 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:20:25.556393 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m20:20:25.558617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8521e54-8a6d-4221-ba75-e25c4d45be04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f893affd950>]}
[0m20:20:25.559746 [debug] [MainThread]: On master: ROLLBACK
[0m20:20:25.562563 [debug] [MainThread]: Using postgres connection "master"
[0m20:20:25.563488 [debug] [MainThread]: On master: BEGIN
[0m20:20:25.567570 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:20:25.568674 [debug] [MainThread]: On master: COMMIT
[0m20:20:25.570159 [debug] [MainThread]: Using postgres connection "master"
[0m20:20:25.571338 [debug] [MainThread]: On master: COMMIT
[0m20:20:25.574765 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:20:25.575826 [debug] [MainThread]: On master: Close
[0m20:20:25.576972 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:20:25.578143 [info ] [MainThread]: 
[0m20:20:25.589205 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m20:20:25.590831 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m20:20:25.592150 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m20:20:25.593169 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m20:20:25.601820 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m20:20:25.609495 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m20:20:25.649596 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m20:20:25.656532 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m20:20:25.657387 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m20:20:25.658165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:20:25.681626 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:20:25.682637 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m20:20:25.683458 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m20:20:25.686964 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                           ^

[0m20:20:25.687904 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m20:20:25.690772 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m20:20:25.700108 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m20:20:25.702716 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8521e54-8a6d-4221-ba75-e25c4d45be04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f893b0c0650>]}
[0m20:20:25.704403 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.11s]
[0m20:20:25.706027 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m20:20:25.707101 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m20:20:25.709223 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m20:20:25.710518 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m20:20:25.711605 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m20:20:25.716032 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m20:20:25.724293 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m20:20:25.729093 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m20:20:25.736053 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m20:20:25.736980 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m20:20:25.737806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:20:25.755223 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:20:25.756764 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m20:20:25.757844 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m20:20:25.761912 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                           ^

[0m20:20:25.763634 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m20:20:25.768205 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m20:20:25.772395 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m20:20:25.774165 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8521e54-8a6d-4221-ba75-e25c4d45be04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f893b0ac8d0>]}
[0m20:20:25.776466 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.06s]
[0m20:20:25.778380 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m20:20:25.779964 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m20:20:25.781351 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m20:20:25.782795 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m20:20:25.784008 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m20:20:25.789149 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m20:20:25.798944 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m20:20:25.804618 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m20:20:25.812731 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m20:20:25.814090 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m20:20:25.815161 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:20:25.835260 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:20:25.836821 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m20:20:25.838442 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m20:20:25.843724 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."films"
                           ^

[0m20:20:25.845619 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m20:20:25.850725 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m20:20:25.855556 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m20:20:25.857596 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8521e54-8a6d-4221-ba75-e25c4d45be04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f893b8fbd10>]}
[0m20:20:25.860137 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.07s]
[0m20:20:25.863182 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m20:20:25.866093 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m20:20:25.867510 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m20:20:25.869126 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m20:20:25.872327 [debug] [MainThread]: Using postgres connection "master"
[0m20:20:25.874041 [debug] [MainThread]: On master: BEGIN
[0m20:20:25.875244 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:20:25.898736 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:20:25.900083 [debug] [MainThread]: On master: COMMIT
[0m20:20:25.901087 [debug] [MainThread]: Using postgres connection "master"
[0m20:20:25.902145 [debug] [MainThread]: On master: COMMIT
[0m20:20:25.905938 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:20:25.907253 [debug] [MainThread]: On master: Close
[0m20:20:25.908591 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:20:25.909645 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m20:20:25.910691 [info ] [MainThread]: 
[0m20:20:25.911831 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m20:20:25.913970 [debug] [MainThread]: Command end result
[0m20:20:25.964121 [info ] [MainThread]: 
[0m20:20:25.965231 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m20:20:25.966138 [info ] [MainThread]: 
[0m20:20:25.967104 [error] [MainThread]:   Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m20:20:25.967941 [info ] [MainThread]: 
[0m20:20:25.968897 [error] [MainThread]:   Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m20:20:25.969840 [info ] [MainThread]: 
[0m20:20:25.970877 [error] [MainThread]:   Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m20:20:25.971711 [info ] [MainThread]: 
[0m20:20:25.972597 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m20:20:25.978421 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.2897006, "process_user_time": 1.76898, "process_kernel_time": 0.273654, "process_mem_max_rss": "106756", "process_in_blocks": "100808", "process_out_blocks": "1152", "command_success": false}
[0m20:20:25.979778 [debug] [MainThread]: Command `dbt run` failed at 20:20:25.979643 after 1.29 seconds
[0m20:20:25.980776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f893f2e8b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f893f2e8390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f893baafb90>]}
[0m20:20:25.981908 [debug] [MainThread]: Flushing usage events
[0m20:26:52.256439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb573d52cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb573d52c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb573d52910>]}


============================== 20:26:52.263279 | 48a32393-10c1-46f2-a78d-6f606a0d001f ==============================
[0m20:26:52.263279 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:26:52.264521 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'version_check': 'True', 'profiles_dir': '/root', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:26:52.440765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '48a32393-10c1-46f2-a78d-6f606a0d001f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb57419f190>]}
[0m20:26:52.487716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '48a32393-10c1-46f2-a78d-6f606a0d001f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb575c5fe90>]}
[0m20:26:52.490660 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m20:26:52.503316 [debug] [MainThread]: checksum: 8dc0a8b3d70f1f34b0ae4fcce5e5a1fd7ffa186bf54a1762a302cc92429dddc4, vars: {}, profile: custom_postgres, target: dev, version: 1.8.1
[0m20:26:52.766380 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:26:52.767713 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:26:52.811410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48a32393-10c1-46f2-a78d-6f606a0d001f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5732f0c50>]}
[0m20:26:52.951204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '48a32393-10c1-46f2-a78d-6f606a0d001f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5735a77d0>]}
[0m20:26:52.952233 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 413 macros
[0m20:26:52.953055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48a32393-10c1-46f2-a78d-6f606a0d001f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb575331890>]}
[0m20:26:52.955810 [info ] [MainThread]: 
[0m20:26:52.957086 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:26:52.961368 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m20:26:53.004533 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m20:26:53.006007 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m20:26:53.006943 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:26:53.030787 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m20:26:53.032853 [debug] [ThreadPool]: On list_destination_db: Close
[0m20:26:53.035332 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m20:26:53.042383 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m20:26:53.043503 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m20:26:53.044432 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:26:53.060561 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:26:53.061724 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m20:26:53.062632 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:26:53.068268 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m20:26:53.070476 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m20:26:53.073571 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m20:26:53.080360 [debug] [MainThread]: Using postgres connection "master"
[0m20:26:53.081649 [debug] [MainThread]: On master: BEGIN
[0m20:26:53.082620 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:26:53.100386 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:26:53.101521 [debug] [MainThread]: Using postgres connection "master"
[0m20:26:53.102451 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:26:53.108095 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m20:26:53.110503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48a32393-10c1-46f2-a78d-6f606a0d001f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb57263c450>]}
[0m20:26:53.111686 [debug] [MainThread]: On master: ROLLBACK
[0m20:26:53.114907 [debug] [MainThread]: Using postgres connection "master"
[0m20:26:53.116240 [debug] [MainThread]: On master: BEGIN
[0m20:26:53.120643 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:26:53.121688 [debug] [MainThread]: On master: COMMIT
[0m20:26:53.122584 [debug] [MainThread]: Using postgres connection "master"
[0m20:26:53.123452 [debug] [MainThread]: On master: COMMIT
[0m20:26:53.126586 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:26:53.127640 [debug] [MainThread]: On master: Close
[0m20:26:53.128870 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:26:53.130019 [info ] [MainThread]: 
[0m20:26:53.140456 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m20:26:53.141927 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m20:26:53.143126 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m20:26:53.144113 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m20:26:53.152669 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m20:26:53.160127 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m20:26:53.199219 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m20:26:53.206588 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m20:26:53.207571 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m20:26:53.208461 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:26:53.224462 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:26:53.225488 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m20:26:53.226428 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m20:26:53.229731 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                           ^

[0m20:26:53.230661 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m20:26:53.233627 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m20:26:53.242811 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m20:26:53.245085 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48a32393-10c1-46f2-a78d-6f606a0d001f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5725fde10>]}
[0m20:26:53.246424 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.10s]
[0m20:26:53.248540 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m20:26:53.249929 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m20:26:53.251931 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m20:26:53.253515 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m20:26:53.254941 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m20:26:53.259811 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m20:26:53.267839 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m20:26:53.272635 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m20:26:53.280301 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m20:26:53.281396 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m20:26:53.282283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:26:53.298957 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:26:53.300541 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m20:26:53.301532 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m20:26:53.305089 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                           ^

[0m20:26:53.306408 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m20:26:53.309964 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m20:26:53.313419 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m20:26:53.315075 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48a32393-10c1-46f2-a78d-6f606a0d001f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5724bff50>]}
[0m20:26:53.316617 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.06s]
[0m20:26:53.318256 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m20:26:53.319335 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m20:26:53.320434 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m20:26:53.321728 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m20:26:53.322908 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m20:26:53.326993 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m20:26:53.334673 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m20:26:53.340316 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m20:26:53.347846 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m20:26:53.348887 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m20:26:53.349780 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:26:53.366588 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:26:53.367890 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m20:26:53.368910 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m20:26:53.372623 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."films"
                           ^

[0m20:26:53.373848 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m20:26:53.376953 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m20:26:53.380048 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m20:26:53.381637 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48a32393-10c1-46f2-a78d-6f606a0d001f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5727af450>]}
[0m20:26:53.383029 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.06s]
[0m20:26:53.384321 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m20:26:53.386187 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m20:26:53.387199 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m20:26:53.388418 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m20:26:53.390909 [debug] [MainThread]: Using postgres connection "master"
[0m20:26:53.391944 [debug] [MainThread]: On master: BEGIN
[0m20:26:53.392780 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:26:53.410564 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:26:53.411757 [debug] [MainThread]: On master: COMMIT
[0m20:26:53.412706 [debug] [MainThread]: Using postgres connection "master"
[0m20:26:53.413590 [debug] [MainThread]: On master: COMMIT
[0m20:26:53.417025 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:26:53.418233 [debug] [MainThread]: On master: Close
[0m20:26:53.419428 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:26:53.420476 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m20:26:53.421513 [info ] [MainThread]: 
[0m20:26:53.422724 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m20:26:53.424653 [debug] [MainThread]: Command end result
[0m20:26:53.473281 [info ] [MainThread]: 
[0m20:26:53.474438 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m20:26:53.475501 [info ] [MainThread]: 
[0m20:26:53.476541 [error] [MainThread]:   Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m20:26:53.477388 [info ] [MainThread]: 
[0m20:26:53.478397 [error] [MainThread]:   Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m20:26:53.479239 [info ] [MainThread]: 
[0m20:26:53.480126 [error] [MainThread]:   Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m20:26:53.480956 [info ] [MainThread]: 
[0m20:26:53.481807 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m20:26:53.484148 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.284435, "process_user_time": 1.861818, "process_kernel_time": 0.276203, "process_mem_max_rss": "106796", "process_in_blocks": "100840", "process_out_blocks": "1152", "command_success": false}
[0m20:26:53.485666 [debug] [MainThread]: Command `dbt run` failed at 20:26:53.485447 after 1.29 seconds
[0m20:26:53.486825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb573da78d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb573da7850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb577754dd0>]}
[0m20:26:53.487788 [debug] [MainThread]: Flushing usage events
[0m20:30:39.358805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f530800cd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5308516f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f530800c850>]}


============================== 20:30:39.366183 | fd41b0ad-5920-44f5-b4ee-5dd6a3ce8fe5 ==============================
[0m20:30:39.366183 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:30:39.367578 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'debug': 'False', 'profiles_dir': '/root', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:30:39.544424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd41b0ad-5920-44f5-b4ee-5dd6a3ce8fe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5308490590>]}
[0m20:30:39.592909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd41b0ad-5920-44f5-b4ee-5dd6a3ce8fe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5309f43350>]}
[0m20:30:39.595373 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m20:30:39.608393 [debug] [MainThread]: checksum: 8dc0a8b3d70f1f34b0ae4fcce5e5a1fd7ffa186bf54a1762a302cc92429dddc4, vars: {}, profile: custom_postgres, target: dev, version: 1.8.1
[0m20:30:39.704193 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m20:30:39.705974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fd41b0ad-5920-44f5-b4ee-5dd6a3ce8fe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53097a71d0>]}
[0m20:30:40.668294 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:30:40.669995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fd41b0ad-5920-44f5-b4ee-5dd6a3ce8fe5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53077a4e90>]}
[0m20:30:41.001573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd41b0ad-5920-44f5-b4ee-5dd6a3ce8fe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5307567dd0>]}
[0m20:30:41.122950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd41b0ad-5920-44f5-b4ee-5dd6a3ce8fe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5307812e50>]}
[0m20:30:41.123914 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 413 macros
[0m20:30:41.124969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd41b0ad-5920-44f5-b4ee-5dd6a3ce8fe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5307741810>]}
[0m20:30:41.127589 [info ] [MainThread]: 
[0m20:30:41.128883 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:30:41.133091 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m20:30:41.176378 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m20:30:41.178492 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m20:30:41.179509 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:30:41.183559 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not connect to server: Connection refused
	Is the server running on host "destination_postgres" (172.25.0.3) and accepting
	TCP/IP connections on port 5434?

[0m20:30:41.185189 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m20:30:41.185981 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m20:30:41.186832 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m20:30:41.187765 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m20:30:41.188598 [debug] [ThreadPool]: On list_destination_db: No close available on handle
[0m20:30:41.189829 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:30:41.190571 [debug] [MainThread]: Connection 'list_destination_db' was properly closed.
[0m20:30:41.191316 [info ] [MainThread]: 
[0m20:30:41.192277 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.06 seconds (0.06s).
[0m20:30:41.193357 [error] [MainThread]: Encountered an error:
Database Error
  could not connect to server: Connection refused
  	Is the server running on host "destination_postgres" (172.25.0.3) and accepting
  	TCP/IP connections on port 5434?
  
[0m20:30:41.195376 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.8935205, "process_user_time": 2.704938, "process_kernel_time": 0.233885, "process_mem_max_rss": "107548", "process_in_blocks": "100128", "process_out_blocks": "1056", "command_success": false}
[0m20:30:41.196467 [debug] [MainThread]: Command `dbt run` failed at 20:30:41.196339 after 1.89 seconds
[0m20:30:41.197364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f530804c750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f530804e4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f530804c510>]}
[0m20:30:41.198178 [debug] [MainThread]: Flushing usage events
[0m20:31:37.041365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7838fa47d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7839545b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7838fa4990>]}


============================== 20:31:37.048254 | bc35ef25-01ba-47a8-8aef-9d2a131e8c15 ==============================
[0m20:31:37.048254 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:31:37.049656 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root', 'log_path': '/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:31:37.235457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc35ef25-01ba-47a8-8aef-9d2a131e8c15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7839192d90>]}
[0m20:31:37.283598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc35ef25-01ba-47a8-8aef-9d2a131e8c15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f783aeb3950>]}
[0m20:31:37.285675 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m20:31:37.298360 [debug] [MainThread]: checksum: 8dc0a8b3d70f1f34b0ae4fcce5e5a1fd7ffa186bf54a1762a302cc92429dddc4, vars: {}, profile: custom_postgres, target: dev, version: 1.8.1
[0m20:31:37.561117 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:31:37.562706 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:31:37.606229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc35ef25-01ba-47a8-8aef-9d2a131e8c15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78393e3f90>]}
[0m20:31:37.730865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc35ef25-01ba-47a8-8aef-9d2a131e8c15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f783a716290>]}
[0m20:31:37.731871 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 413 macros
[0m20:31:37.732816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc35ef25-01ba-47a8-8aef-9d2a131e8c15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78385ea610>]}
[0m20:31:37.735580 [info ] [MainThread]: 
[0m20:31:37.736883 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:31:37.741051 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m20:31:37.785019 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m20:31:37.786413 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m20:31:37.787298 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:31:37.791553 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not connect to server: Connection refused
	Is the server running on host "destination_postgres" (172.26.0.3) and accepting
	TCP/IP connections on port 5434?

[0m20:31:37.793532 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m20:31:37.794522 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m20:31:37.795443 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m20:31:37.796245 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m20:31:37.797130 [debug] [ThreadPool]: On list_destination_db: No close available on handle
[0m20:31:37.798368 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:31:37.799095 [debug] [MainThread]: Connection 'list_destination_db' was properly closed.
[0m20:31:37.799853 [info ] [MainThread]: 
[0m20:31:37.800729 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.06 seconds (0.06s).
[0m20:31:37.801802 [error] [MainThread]: Encountered an error:
Database Error
  could not connect to server: Connection refused
  	Is the server running on host "destination_postgres" (172.26.0.3) and accepting
  	TCP/IP connections on port 5434?
  
[0m20:31:37.803849 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.81906015, "process_user_time": 1.740227, "process_kernel_time": 0.211241, "process_mem_max_rss": "102636", "process_in_blocks": "99632", "process_out_blocks": "1056", "command_success": false}
[0m20:31:37.805057 [debug] [MainThread]: Command `dbt run` failed at 20:31:37.804932 after 0.82 seconds
[0m20:31:37.805956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7838fd89d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7838fa62d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7838335810>]}
[0m20:31:37.806797 [debug] [MainThread]: Flushing usage events
[0m20:34:42.786055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cfec786d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cff3e1d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cfec78410>]}


============================== 20:34:42.793377 | 034ee9bf-2730-42aa-82b8-75dc017897a0 ==============================
[0m20:34:42.793377 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:34:42.794956 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'debug': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:34:42.978623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '034ee9bf-2730-42aa-82b8-75dc017897a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cfed12ed0>]}
[0m20:34:43.034131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '034ee9bf-2730-42aa-82b8-75dc017897a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d00bb7610>]}
[0m20:34:43.036413 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m20:34:43.051050 [debug] [MainThread]: checksum: 8dc0a8b3d70f1f34b0ae4fcce5e5a1fd7ffa186bf54a1762a302cc92429dddc4, vars: {}, profile: custom_postgres, target: dev, version: 1.8.1
[0m20:34:43.161240 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m20:34:43.162742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '034ee9bf-2730-42aa-82b8-75dc017897a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d00427010>]}
[0m20:34:44.167962 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:34:44.169683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '034ee9bf-2730-42aa-82b8-75dc017897a0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cfe430ad0>]}
[0m20:34:44.518583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '034ee9bf-2730-42aa-82b8-75dc017897a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cfc262090>]}
[0m20:34:44.648365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '034ee9bf-2730-42aa-82b8-75dc017897a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cfe321390>]}
[0m20:34:44.649345 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 413 macros
[0m20:34:44.650388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '034ee9bf-2730-42aa-82b8-75dc017897a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cfe37f590>]}
[0m20:34:44.652948 [info ] [MainThread]: 
[0m20:34:44.654069 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:34:44.659000 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m20:34:44.702068 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m20:34:44.703463 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m20:34:44.704303 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:34:44.707323 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "ost.docker.internal:host-gateway" to address: Name or service not known

[0m20:34:44.708377 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m20:34:44.709107 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m20:34:44.710057 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m20:34:44.710978 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m20:34:44.711750 [debug] [ThreadPool]: On list_destination_db: No close available on handle
[0m20:34:44.712921 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:34:44.713677 [debug] [MainThread]: Connection 'list_destination_db' was properly closed.
[0m20:34:44.714426 [info ] [MainThread]: 
[0m20:34:44.715506 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.06 seconds (0.06s).
[0m20:34:44.716635 [error] [MainThread]: Encountered an error:
Database Error
  could not translate host name "ost.docker.internal:host-gateway" to address: Name or service not known
  
[0m20:34:44.718539 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.991192, "process_user_time": 2.927476, "process_kernel_time": 0.216468, "process_mem_max_rss": "109296", "process_in_blocks": "100128", "process_out_blocks": "1056", "command_success": false}
[0m20:34:44.719644 [debug] [MainThread]: Command `dbt run` failed at 20:34:44.719532 after 1.99 seconds
[0m20:34:44.720473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cfeccf4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cff21e1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1cfecad590>]}
[0m20:34:44.721415 [debug] [MainThread]: Flushing usage events
[0m20:35:24.501628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84bc867210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84bc867790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84bc867450>]}


============================== 20:35:24.508762 | a33841dc-1d1b-4bd7-9576-0512ea41814c ==============================
[0m20:35:24.508762 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:35:24.510258 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/dbt/logs', 'version_check': 'True', 'profiles_dir': '/root', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:35:24.692353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a33841dc-1d1b-4bd7-9576-0512ea41814c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84bc869610>]}
[0m20:35:24.740432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a33841dc-1d1b-4bd7-9576-0512ea41814c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84be767610>]}
[0m20:35:24.742914 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m20:35:24.755290 [debug] [MainThread]: checksum: 8dc0a8b3d70f1f34b0ae4fcce5e5a1fd7ffa186bf54a1762a302cc92429dddc4, vars: {}, profile: custom_postgres, target: dev, version: 1.8.1
[0m20:35:24.854815 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m20:35:24.856388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a33841dc-1d1b-4bd7-9576-0512ea41814c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84be0108d0>]}
[0m20:35:25.835714 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:35:25.837269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a33841dc-1d1b-4bd7-9576-0512ea41814c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84bbdfdf10>]}
[0m20:35:26.184254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a33841dc-1d1b-4bd7-9576-0512ea41814c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84be391d10>]}
[0m20:35:26.313117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a33841dc-1d1b-4bd7-9576-0512ea41814c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84bd1edf50>]}
[0m20:35:26.314163 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 413 macros
[0m20:35:26.315261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a33841dc-1d1b-4bd7-9576-0512ea41814c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84bbd78f10>]}
[0m20:35:26.318033 [info ] [MainThread]: 
[0m20:35:26.319331 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:35:26.323906 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m20:35:26.367640 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m20:35:26.368941 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m20:35:26.370467 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:35:26.373674 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "host.docker.internal:host-gateway" to address: Name or service not known

[0m20:35:26.374928 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m20:35:26.375785 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m20:35:26.376617 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m20:35:26.377508 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m20:35:26.378302 [debug] [ThreadPool]: On list_destination_db: No close available on handle
[0m20:35:26.379528 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:35:26.380283 [debug] [MainThread]: Connection 'list_destination_db' was properly closed.
[0m20:35:26.381040 [info ] [MainThread]: 
[0m20:35:26.381905 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.06 seconds (0.06s).
[0m20:35:26.382951 [error] [MainThread]: Encountered an error:
Database Error
  could not translate host name "host.docker.internal:host-gateway" to address: Name or service not known
  
[0m20:35:26.384983 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.9399035, "process_user_time": 2.811956, "process_kernel_time": 0.231809, "process_mem_max_rss": "107364", "process_in_blocks": "100128", "process_out_blocks": "1056", "command_success": false}
[0m20:35:26.386210 [debug] [MainThread]: Command `dbt run` failed at 20:35:26.386085 after 1.94 seconds
[0m20:35:26.387079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84bc82a410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84bc86bbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b9b84290>]}
[0m20:35:26.387922 [debug] [MainThread]: Flushing usage events
[0m20:35:55.278204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd813064e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd813f8c510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8130a3fd0>]}


============================== 20:35:55.284982 | c12ee317-130a-4efb-a1af-1e7b97f98b92 ==============================
[0m20:35:55.284982 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:35:55.286447 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'send_anonymous_usage_stats': 'True'}
[0m20:35:55.462860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c12ee317-130a-4efb-a1af-1e7b97f98b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8128278d0>]}
[0m20:35:55.524498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c12ee317-130a-4efb-a1af-1e7b97f98b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd814f9b790>]}
[0m20:35:55.526573 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m20:35:55.539588 [debug] [MainThread]: checksum: 8dc0a8b3d70f1f34b0ae4fcce5e5a1fd7ffa186bf54a1762a302cc92429dddc4, vars: {}, profile: custom_postgres, target: dev, version: 1.8.1
[0m20:35:55.669644 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m20:35:55.671117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c12ee317-130a-4efb-a1af-1e7b97f98b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8147ff310>]}
[0m20:35:56.724234 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:35:56.725993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c12ee317-130a-4efb-a1af-1e7b97f98b92', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd810417c90>]}
[0m20:35:57.118901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c12ee317-130a-4efb-a1af-1e7b97f98b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd81252e510>]}
[0m20:35:57.243248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c12ee317-130a-4efb-a1af-1e7b97f98b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd813a27290>]}
[0m20:35:57.244537 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 413 macros
[0m20:35:57.245531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c12ee317-130a-4efb-a1af-1e7b97f98b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8104142d0>]}
[0m20:35:57.248495 [info ] [MainThread]: 
[0m20:35:57.249788 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:35:57.255165 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m20:35:57.304051 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m20:35:57.305345 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m20:35:57.306338 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:35:57.330272 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m20:35:57.332605 [debug] [ThreadPool]: On list_destination_db: Close
[0m20:35:57.335373 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m20:35:57.343253 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m20:35:57.344605 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m20:35:57.345549 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:35:57.363918 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:35:57.365280 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m20:35:57.366376 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:35:57.372822 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m20:35:57.375313 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m20:35:57.378476 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m20:35:57.385917 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:57.387445 [debug] [MainThread]: On master: BEGIN
[0m20:35:57.388505 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:35:57.408739 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:35:57.410053 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:57.411631 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:35:57.418998 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m20:35:57.421811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c12ee317-130a-4efb-a1af-1e7b97f98b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd810303cd0>]}
[0m20:35:57.423351 [debug] [MainThread]: On master: ROLLBACK
[0m20:35:57.427184 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:57.428658 [debug] [MainThread]: On master: BEGIN
[0m20:35:57.435191 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:35:57.436584 [debug] [MainThread]: On master: COMMIT
[0m20:35:57.437831 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:57.439007 [debug] [MainThread]: On master: COMMIT
[0m20:35:57.442710 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:35:57.444004 [debug] [MainThread]: On master: Close
[0m20:35:57.445600 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:35:57.446980 [info ] [MainThread]: 
[0m20:35:57.461806 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m20:35:57.463956 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m20:35:57.465608 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m20:35:57.467211 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m20:35:57.480080 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m20:35:57.491446 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m20:35:57.547902 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m20:35:57.558279 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m20:35:57.559578 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m20:35:57.560745 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:35:57.581919 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:35:57.583221 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m20:35:57.584330 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m20:35:57.588372 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                           ^

[0m20:35:57.589582 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m20:35:57.592911 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m20:35:57.604802 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m20:35:57.607850 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c12ee317-130a-4efb-a1af-1e7b97f98b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7cf7b9e10>]}
[0m20:35:57.609437 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.14s]
[0m20:35:57.611174 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m20:35:57.613007 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m20:35:57.615294 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m20:35:57.616759 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m20:35:57.617910 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m20:35:57.623179 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m20:35:57.632693 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m20:35:57.641614 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m20:35:57.651339 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m20:35:57.652609 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m20:35:57.653911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:35:57.676601 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:35:57.678282 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m20:35:57.679626 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m20:35:57.683625 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                           ^

[0m20:35:57.684917 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m20:35:57.688733 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m20:35:57.693503 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m20:35:57.695269 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c12ee317-130a-4efb-a1af-1e7b97f98b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7cf654590>]}
[0m20:35:57.697054 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.08s]
[0m20:35:57.698576 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m20:35:57.700064 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m20:35:57.701492 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m20:35:57.702960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m20:35:57.704462 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m20:35:57.709819 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m20:35:57.719726 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m20:35:57.726501 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m20:35:57.736933 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m20:35:57.738471 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m20:35:57.739816 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:35:57.762619 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:35:57.764314 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m20:35:57.765774 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m20:35:57.770079 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."films"
                           ^

[0m20:35:57.771682 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m20:35:57.775996 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m20:35:57.781027 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m20:35:57.782798 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c12ee317-130a-4efb-a1af-1e7b97f98b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7cf655ed0>]}
[0m20:35:57.785045 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.08s]
[0m20:35:57.787427 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m20:35:57.790263 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m20:35:57.791693 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m20:35:57.793247 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m20:35:57.796710 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:57.798226 [debug] [MainThread]: On master: BEGIN
[0m20:35:57.799440 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:35:57.824206 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:35:57.826097 [debug] [MainThread]: On master: COMMIT
[0m20:35:57.827431 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:57.828815 [debug] [MainThread]: On master: COMMIT
[0m20:35:57.833535 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:35:57.835234 [debug] [MainThread]: On master: Close
[0m20:35:57.836925 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:35:57.838720 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m20:35:57.840167 [info ] [MainThread]: 
[0m20:35:57.841656 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m20:35:57.844278 [debug] [MainThread]: Command end result
[0m20:35:57.911080 [info ] [MainThread]: 
[0m20:35:57.912432 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m20:35:57.913750 [info ] [MainThread]: 
[0m20:35:57.915028 [error] [MainThread]:   Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m20:35:57.916107 [info ] [MainThread]: 
[0m20:35:57.917834 [error] [MainThread]:   Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m20:35:57.919046 [info ] [MainThread]: 
[0m20:35:57.920421 [error] [MainThread]:   Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m20:35:57.921516 [info ] [MainThread]: 
[0m20:35:57.922589 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m20:35:57.924429 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.7052684, "process_user_time": 3.65471, "process_kernel_time": 0.331333, "process_mem_max_rss": "111924", "process_in_blocks": "928", "process_out_blocks": "1152", "command_success": false}
[0m20:35:57.925899 [debug] [MainThread]: Command `dbt run` failed at 20:35:57.925731 after 2.71 seconds
[0m20:35:57.927145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd813066350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8130641d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd816a7cd90>]}
[0m20:35:57.928450 [debug] [MainThread]: Flushing usage events
[0m20:38:47.993557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6e83349d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6e9829bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6e87c1b10>]}


============================== 20:38:48.003538 | efc0fde6-6a00-4644-97ac-1612c4ac4e1f ==============================
[0m20:38:48.003538 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:38:48.005385 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'debug': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'send_anonymous_usage_stats': 'True'}
[0m20:38:48.267606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'efc0fde6-6a00-4644-97ac-1612c4ac4e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6e83762d0>]}
[0m20:38:48.340032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'efc0fde6-6a00-4644-97ac-1612c4ac4e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6ea2474d0>]}
[0m20:38:48.342862 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m20:38:48.360623 [debug] [MainThread]: checksum: 8dc0a8b3d70f1f34b0ae4fcce5e5a1fd7ffa186bf54a1762a302cc92429dddc4, vars: {}, profile: custom_postgres, target: dev, version: 1.8.1
[0m20:38:48.807574 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:38:48.809906 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:38:48.892290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'efc0fde6-6a00-4644-97ac-1612c4ac4e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6e791ba50>]}
[0m20:38:49.091444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'efc0fde6-6a00-4644-97ac-1612c4ac4e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6e7851090>]}
[0m20:38:49.092971 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 413 macros
[0m20:38:49.094282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efc0fde6-6a00-4644-97ac-1612c4ac4e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6e83342d0>]}
[0m20:38:49.097757 [info ] [MainThread]: 
[0m20:38:49.099283 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:38:49.105164 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m20:38:49.167920 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m20:38:49.169487 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m20:38:49.170618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:38:49.195793 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m20:38:49.198759 [debug] [ThreadPool]: On list_destination_db: Close
[0m20:38:49.201830 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m20:38:49.210620 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m20:38:49.211765 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m20:38:49.212729 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:38:49.229776 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:38:49.231231 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m20:38:49.232404 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:38:49.236934 [debug] [ThreadPool]: Postgres adapter: Postgres error: relation "pg_matviews" does not exist
LINE 23:     from pg_matviews
                  ^

[0m20:38:49.238154 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m20:38:49.242021 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_relations_without_caching
[0m20:38:49.243589 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m20:38:49.245285 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m20:38:49.248148 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:38:49.249573 [debug] [MainThread]: Connection 'list_destination_db_public' was properly closed.
[0m20:38:49.250896 [info ] [MainThread]: 
[0m20:38:49.252837 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m20:38:49.254373 [error] [MainThread]: Encountered an error:
Database Error
  relation "pg_matviews" does not exist
  LINE 23:     from pg_matviews
                    ^
[0m20:38:49.257312 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.3501829, "process_user_time": 2.676386, "process_kernel_time": 0.338279, "process_mem_max_rss": "103688", "process_in_blocks": "100160", "process_out_blocks": "1056", "command_success": false}
[0m20:38:49.259054 [debug] [MainThread]: Command `dbt run` failed at 20:38:49.258845 after 1.35 seconds
[0m20:38:49.260688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6e838b6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6e6c20550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6e838b590>]}
[0m20:38:49.262107 [debug] [MainThread]: Flushing usage events
[0m20:42:14.163793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d26518490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d26c79d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d26557fd0>]}


============================== 20:42:14.172798 | d419a7a7-f277-402f-ae98-85b1c2aca2e9 ==============================
[0m20:42:14.172798 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:42:14.174147 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/dbt/logs', 'version_check': 'True', 'profiles_dir': '/root', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'send_anonymous_usage_stats': 'True'}
[0m20:42:14.477842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd419a7a7-f277-402f-ae98-85b1c2aca2e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d25d2b890>]}
[0m20:42:14.573783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd419a7a7-f277-402f-ae98-85b1c2aca2e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d2843ee50>]}
[0m20:42:14.576509 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m20:42:14.600040 [debug] [MainThread]: checksum: 8dc0a8b3d70f1f34b0ae4fcce5e5a1fd7ffa186bf54a1762a302cc92429dddc4, vars: {}, profile: custom_postgres, target: dev, version: 1.8.1
[0m20:42:15.189202 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:42:15.191788 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:42:15.321561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd419a7a7-f277-402f-ae98-85b1c2aca2e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d25af4f90>]}
[0m20:42:15.796574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd419a7a7-f277-402f-ae98-85b1c2aca2e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d25bb7010>]}
[0m20:42:15.799214 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 413 macros
[0m20:42:15.801768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd419a7a7-f277-402f-ae98-85b1c2aca2e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d27b01790>]}
[0m20:42:15.809850 [info ] [MainThread]: 
[0m20:42:15.814599 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:42:15.830419 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m20:42:15.971843 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m20:42:15.974701 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m20:42:15.976762 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:42:16.036954 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m20:42:16.041518 [debug] [ThreadPool]: On list_destination_db: Close
[0m20:42:16.046987 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m20:42:16.072119 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m20:42:16.074726 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m20:42:16.076785 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:42:16.118989 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:42:16.121493 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m20:42:16.123310 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:42:16.135588 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m20:42:16.140111 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m20:42:16.146072 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m20:42:16.162033 [debug] [MainThread]: Using postgres connection "master"
[0m20:42:16.165835 [debug] [MainThread]: On master: BEGIN
[0m20:42:16.168422 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:42:16.210283 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:42:16.212684 [debug] [MainThread]: Using postgres connection "master"
[0m20:42:16.215227 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:42:16.241692 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m20:42:16.246672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd419a7a7-f277-402f-ae98-85b1c2aca2e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d2589d190>]}
[0m20:42:16.249446 [debug] [MainThread]: On master: ROLLBACK
[0m20:42:16.256598 [debug] [MainThread]: Using postgres connection "master"
[0m20:42:16.260183 [debug] [MainThread]: On master: BEGIN
[0m20:42:16.273788 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:42:16.276358 [debug] [MainThread]: On master: COMMIT
[0m20:42:16.278798 [debug] [MainThread]: Using postgres connection "master"
[0m20:42:16.281381 [debug] [MainThread]: On master: COMMIT
[0m20:42:16.289664 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:42:16.292478 [debug] [MainThread]: On master: Close
[0m20:42:16.295461 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:42:16.298024 [info ] [MainThread]: 
[0m20:42:16.337996 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m20:42:16.341575 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m20:42:16.345759 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m20:42:16.348586 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m20:42:16.381465 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m20:42:16.407485 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m20:42:16.538479 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m20:42:16.557544 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m20:42:16.560093 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m20:42:16.562409 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:42:16.619889 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:42:16.622261 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m20:42:16.624720 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m20:42:16.631652 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                           ^

[0m20:42:16.634644 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m20:42:16.643651 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m20:42:16.666115 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m20:42:16.672700 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd419a7a7-f277-402f-ae98-85b1c2aca2e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d24f7bd50>]}
[0m20:42:16.679027 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.32s]
[0m20:42:16.682808 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m20:42:16.686112 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m20:42:16.690222 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m20:42:16.694163 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m20:42:16.696637 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m20:42:16.708688 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m20:42:16.729528 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m20:42:16.742531 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m20:42:16.766016 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m20:42:16.769034 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m20:42:16.772060 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:42:16.837574 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:42:16.840870 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m20:42:16.843866 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m20:42:16.853617 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                           ^

[0m20:42:16.857103 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m20:42:16.875049 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m20:42:16.884203 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m20:42:16.888996 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd419a7a7-f277-402f-ae98-85b1c2aca2e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d24dce610>]}
[0m20:42:16.897338 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.19s]
[0m20:42:16.902934 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m20:42:16.906189 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m20:42:16.914610 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m20:42:16.918949 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m20:42:16.922182 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m20:42:16.942015 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m20:42:16.972004 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m20:42:16.996609 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m20:42:17.019308 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m20:42:17.023804 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m20:42:17.027863 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:42:17.070749 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:42:17.074381 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m20:42:17.077581 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m20:42:17.109041 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.0 seconds
[0m20:42:17.144758 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m20:42:17.148144 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m20:42:17.184815 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "films" already exists

[0m20:42:17.188747 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m20:42:17.221167 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m20:42:17.224719 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m20:42:17.228216 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m20:42:17.245492 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "films" already exists
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m20:42:17.253481 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd419a7a7-f277-402f-ae98-85b1c2aca2e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d24d504d0>]}
[0m20:42:17.258071 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.33s]
[0m20:42:17.263278 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m20:42:17.269384 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m20:42:17.272973 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m20:42:17.277121 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m20:42:17.283539 [debug] [MainThread]: Using postgres connection "master"
[0m20:42:17.286722 [debug] [MainThread]: On master: BEGIN
[0m20:42:17.290402 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:42:17.468769 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:42:17.472247 [debug] [MainThread]: On master: COMMIT
[0m20:42:17.476375 [debug] [MainThread]: Using postgres connection "master"
[0m20:42:17.479430 [debug] [MainThread]: On master: COMMIT
[0m20:42:17.489223 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:42:17.492447 [debug] [MainThread]: On master: Close
[0m20:42:17.496077 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:42:17.499356 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m20:42:17.502908 [info ] [MainThread]: 
[0m20:42:17.506088 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.69 seconds (1.69s).
[0m20:42:17.511961 [debug] [MainThread]: Command end result
[0m20:42:17.786646 [info ] [MainThread]: 
[0m20:42:17.791891 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m20:42:17.796545 [info ] [MainThread]: 
[0m20:42:17.804026 [error] [MainThread]:   Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m20:42:17.809065 [info ] [MainThread]: 
[0m20:42:17.813746 [error] [MainThread]:   Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m20:42:17.818626 [info ] [MainThread]: 
[0m20:42:17.822737 [error] [MainThread]:   Database Error in model films (models/example/films.sql)
  relation "films" already exists
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m20:42:17.828626 [info ] [MainThread]: 
[0m20:42:17.832559 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m20:42:17.842150 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.764901, "process_user_time": 3.833679, "process_kernel_time": 0.466795, "process_mem_max_rss": "107836", "process_in_blocks": "100712", "process_out_blocks": "1152", "command_success": false}
[0m20:42:17.846728 [debug] [MainThread]: Command `dbt run` failed at 20:42:17.846081 after 3.77 seconds
[0m20:42:17.853950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d2656f590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d2651a3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d25c92690>]}
[0m20:42:17.859450 [debug] [MainThread]: Flushing usage events
[0m20:46:32.336164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55373e4410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5537423450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55373e4190>]}


============================== 20:46:32.351562 | dfd30e2e-2d78-4675-9575-9f5e45072751 ==============================
[0m20:46:32.351562 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:46:32.353850 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'debug': 'False', 'profiles_dir': '/root', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:46:32.699778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dfd30e2e-2d78-4675-9575-9f5e45072751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5537424d50>]}
[0m20:46:32.756087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dfd30e2e-2d78-4675-9575-9f5e45072751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5539317850>]}
[0m20:46:32.758027 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m20:46:32.770693 [debug] [MainThread]: checksum: 8dc0a8b3d70f1f34b0ae4fcce5e5a1fd7ffa186bf54a1762a302cc92429dddc4, vars: {}, profile: custom_postgres, target: dev, version: 1.8.1
[0m20:46:33.021000 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:46:33.022461 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:46:33.075354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dfd30e2e-2d78-4675-9575-9f5e45072751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5536c21b50>]}
[0m20:46:33.198163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dfd30e2e-2d78-4675-9575-9f5e45072751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55369d66d0>]}
[0m20:46:33.199210 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 413 macros
[0m20:46:33.200407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfd30e2e-2d78-4675-9575-9f5e45072751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55369c8390>]}
[0m20:46:33.203104 [info ] [MainThread]: 
[0m20:46:33.204477 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:46:33.209866 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m20:46:33.259259 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m20:46:33.260717 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m20:46:33.261733 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:46:33.288688 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m20:46:33.291335 [debug] [ThreadPool]: On list_destination_db: Close
[0m20:46:33.293861 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m20:46:33.301856 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m20:46:33.303128 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m20:46:33.304086 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:46:33.325102 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:46:33.326401 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m20:46:33.327472 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:46:33.335008 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m20:46:33.337542 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m20:46:33.341090 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m20:46:33.349581 [debug] [MainThread]: Using postgres connection "master"
[0m20:46:33.351553 [debug] [MainThread]: On master: BEGIN
[0m20:46:33.352690 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:46:33.377091 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:46:33.378530 [debug] [MainThread]: Using postgres connection "master"
[0m20:46:33.380057 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:46:33.387264 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m20:46:33.389918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfd30e2e-2d78-4675-9575-9f5e45072751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5538f505d0>]}
[0m20:46:33.391225 [debug] [MainThread]: On master: ROLLBACK
[0m20:46:33.395137 [debug] [MainThread]: Using postgres connection "master"
[0m20:46:33.396642 [debug] [MainThread]: On master: BEGIN
[0m20:46:33.403143 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:46:33.404752 [debug] [MainThread]: On master: COMMIT
[0m20:46:33.406116 [debug] [MainThread]: Using postgres connection "master"
[0m20:46:33.407401 [debug] [MainThread]: On master: COMMIT
[0m20:46:33.411312 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:46:33.412941 [debug] [MainThread]: On master: Close
[0m20:46:33.414513 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:46:33.415906 [info ] [MainThread]: 
[0m20:46:33.431613 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m20:46:33.433412 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m20:46:33.434989 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m20:46:33.436277 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m20:46:33.448513 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m20:46:33.459636 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m20:46:33.518435 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m20:46:33.528222 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m20:46:33.529365 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m20:46:33.530694 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:46:33.551852 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:46:33.553159 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m20:46:33.554323 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m20:46:33.557857 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                           ^

[0m20:46:33.558969 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m20:46:33.562905 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m20:46:33.569719 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m20:46:33.573394 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfd30e2e-2d78-4675-9575-9f5e45072751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5535e67cd0>]}
[0m20:46:33.575771 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.14s]
[0m20:46:33.577869 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m20:46:33.579367 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m20:46:33.581762 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m20:46:33.583609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m20:46:33.585012 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m20:46:33.590480 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m20:46:33.602069 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m20:46:33.610569 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m20:46:33.622833 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m20:46:33.624270 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m20:46:33.625621 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:46:33.686099 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:46:33.688060 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m20:46:33.690041 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m20:46:33.724324 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                           ^

[0m20:46:33.726114 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m20:46:33.731703 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m20:46:33.738092 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m20:46:33.741201 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfd30e2e-2d78-4675-9575-9f5e45072751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5536c17cd0>]}
[0m20:46:33.744188 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.16s]
[0m20:46:33.748141 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m20:46:33.750831 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m20:46:33.753019 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m20:46:33.755375 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m20:46:33.757013 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m20:46:33.762984 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m20:46:33.775783 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m20:46:33.783802 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m20:46:33.795348 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m20:46:33.796901 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m20:46:33.798234 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:46:33.824646 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:46:33.826290 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m20:46:33.827600 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m20:46:33.832094 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."films"
                           ^

[0m20:46:33.833875 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m20:46:33.838259 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m20:46:33.843156 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m20:46:33.845016 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfd30e2e-2d78-4675-9575-9f5e45072751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f553678a290>]}
[0m20:46:33.847307 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.09s]
[0m20:46:33.849462 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m20:46:33.852023 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m20:46:33.853556 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m20:46:33.855430 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m20:46:33.858672 [debug] [MainThread]: Using postgres connection "master"
[0m20:46:33.860220 [debug] [MainThread]: On master: BEGIN
[0m20:46:33.861635 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:46:33.888903 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:46:33.890665 [debug] [MainThread]: On master: COMMIT
[0m20:46:33.892208 [debug] [MainThread]: Using postgres connection "master"
[0m20:46:33.893574 [debug] [MainThread]: On master: COMMIT
[0m20:46:33.898969 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:46:33.900920 [debug] [MainThread]: On master: Close
[0m20:46:33.902478 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:46:33.903742 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m20:46:33.905471 [info ] [MainThread]: 
[0m20:46:33.907024 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.70 seconds (0.70s).
[0m20:46:33.909706 [debug] [MainThread]: Command end result
[0m20:46:33.975464 [info ] [MainThread]: 
[0m20:46:33.976834 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m20:46:33.977911 [info ] [MainThread]: 
[0m20:46:33.979149 [error] [MainThread]:   Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m20:46:33.980328 [info ] [MainThread]: 
[0m20:46:33.981476 [error] [MainThread]:   Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m20:46:33.982457 [info ] [MainThread]: 
[0m20:46:33.983613 [error] [MainThread]:   Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m20:46:33.984707 [info ] [MainThread]: 
[0m20:46:33.985759 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m20:46:33.987638 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.7942317, "process_user_time": 3.282139, "process_kernel_time": 0.320208, "process_mem_max_rss": "106912", "process_out_blocks": "1152", "command_success": false, "process_in_blocks": "0"}
[0m20:46:33.989023 [debug] [MainThread]: Command `dbt run` failed at 20:46:33.988820 after 1.80 seconds
[0m20:46:33.990153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f553adfcb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f553adfc310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55375d3a90>]}
[0m20:46:33.991249 [debug] [MainThread]: Flushing usage events
[0m20:48:41.336624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c36264150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c362644d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c36266f90>]}


============================== 20:48:41.347214 | f622fa3d-b133-4d55-ba71-76e93248b711 ==============================
[0m20:48:41.347214 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:48:41.349394 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/dbt/logs', 'profiles_dir': '/root', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:48:41.572911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f622fa3d-b133-4d55-ba71-76e93248b711', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c366bf310>]}
[0m20:48:41.663300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f622fa3d-b133-4d55-ba71-76e93248b711', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c381aeed0>]}
[0m20:48:41.665843 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m20:48:41.691610 [debug] [MainThread]: checksum: 8dc0a8b3d70f1f34b0ae4fcce5e5a1fd7ffa186bf54a1762a302cc92429dddc4, vars: {}, profile: custom_postgres, target: dev, version: 1.8.1
[0m20:48:42.094973 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:48:42.096628 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:48:42.164297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f622fa3d-b133-4d55-ba71-76e93248b711', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c3585df50>]}
[0m20:48:42.336996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f622fa3d-b133-4d55-ba71-76e93248b711', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c36361690>]}
[0m20:48:42.338607 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 413 macros
[0m20:48:42.339900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f622fa3d-b133-4d55-ba71-76e93248b711', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c358bbe90>]}
[0m20:48:42.343999 [info ] [MainThread]: 
[0m20:48:42.345778 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:48:42.353108 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m20:48:42.416309 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m20:48:42.417945 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m20:48:42.419236 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:48:42.449416 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m20:48:42.452275 [debug] [ThreadPool]: On list_destination_db: Close
[0m20:48:42.455656 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m20:48:42.468893 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m20:48:42.470339 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m20:48:42.471509 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:48:42.494956 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:48:42.496484 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m20:48:42.497722 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:48:42.505592 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m20:48:42.508732 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m20:48:42.513652 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m20:48:42.523932 [debug] [MainThread]: Using postgres connection "master"
[0m20:48:42.525617 [debug] [MainThread]: On master: BEGIN
[0m20:48:42.526984 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:48:42.550321 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:48:42.551860 [debug] [MainThread]: Using postgres connection "master"
[0m20:48:42.553328 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:48:42.560815 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m20:48:42.563419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f622fa3d-b133-4d55-ba71-76e93248b711', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c3592be50>]}
[0m20:48:42.564743 [debug] [MainThread]: On master: ROLLBACK
[0m20:48:42.568710 [debug] [MainThread]: Using postgres connection "master"
[0m20:48:42.570430 [debug] [MainThread]: On master: BEGIN
[0m20:48:42.578478 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:48:42.580294 [debug] [MainThread]: On master: COMMIT
[0m20:48:42.581829 [debug] [MainThread]: Using postgres connection "master"
[0m20:48:42.583400 [debug] [MainThread]: On master: COMMIT
[0m20:48:42.588072 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:48:42.589670 [debug] [MainThread]: On master: Close
[0m20:48:42.591642 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:48:42.593553 [info ] [MainThread]: 
[0m20:48:42.606836 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m20:48:42.609013 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m20:48:42.610801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m20:48:42.612217 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m20:48:42.625570 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m20:48:42.636999 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m20:48:42.698862 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m20:48:42.709708 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m20:48:42.710993 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m20:48:42.712089 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:48:42.733075 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:48:42.734567 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m20:48:42.735811 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m20:48:42.740434 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                           ^

[0m20:48:42.741898 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m20:48:42.746388 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m20:48:42.753651 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m20:48:42.757324 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f622fa3d-b133-4d55-ba71-76e93248b711', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c359403d0>]}
[0m20:48:42.759548 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.15s]
[0m20:48:42.761401 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m20:48:42.762825 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m20:48:42.765252 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m20:48:42.767553 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m20:48:42.769564 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m20:48:42.775407 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m20:48:42.786827 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m20:48:42.794315 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m20:48:42.806636 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m20:48:42.808360 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m20:48:42.809927 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:48:42.837113 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:48:42.838954 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m20:48:42.840506 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m20:48:42.846254 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                           ^

[0m20:48:42.847939 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m20:48:42.853244 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m20:48:42.858392 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m20:48:42.860551 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f622fa3d-b133-4d55-ba71-76e93248b711', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c36266d10>]}
[0m20:48:42.862938 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.09s]
[0m20:48:42.865524 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m20:48:42.867432 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m20:48:42.869294 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m20:48:42.871087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m20:48:42.872640 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m20:48:42.880825 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m20:48:42.896975 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m20:48:42.906893 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m20:48:42.922999 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m20:48:42.924857 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m20:48:42.926776 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:48:42.956909 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:48:42.958713 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m20:48:42.960305 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m20:48:42.965958 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."films"
                           ^

[0m20:48:42.967659 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m20:48:42.972676 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m20:48:42.977876 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m20:48:42.980059 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f622fa3d-b133-4d55-ba71-76e93248b711', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c358b0750>]}
[0m20:48:42.982819 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.11s]
[0m20:48:42.985466 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m20:48:42.988653 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m20:48:42.990560 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m20:48:42.992732 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m20:48:42.996839 [debug] [MainThread]: Using postgres connection "master"
[0m20:48:42.998671 [debug] [MainThread]: On master: BEGIN
[0m20:48:43.000377 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:48:43.031172 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:48:43.032907 [debug] [MainThread]: On master: COMMIT
[0m20:48:43.034528 [debug] [MainThread]: Using postgres connection "master"
[0m20:48:43.036261 [debug] [MainThread]: On master: COMMIT
[0m20:48:43.041220 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:48:43.043437 [debug] [MainThread]: On master: Close
[0m20:48:43.045613 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:48:43.047099 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m20:48:43.048751 [info ] [MainThread]: 
[0m20:48:43.050486 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.70 seconds (0.70s).
[0m20:48:43.054420 [debug] [MainThread]: Command end result
[0m20:48:43.131386 [info ] [MainThread]: 
[0m20:48:43.132941 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m20:48:43.134370 [info ] [MainThread]: 
[0m20:48:43.135990 [error] [MainThread]:   Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m20:48:43.137463 [info ] [MainThread]: 
[0m20:48:43.138986 [error] [MainThread]:   Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m20:48:43.140298 [info ] [MainThread]: 
[0m20:48:43.142068 [error] [MainThread]:   Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m20:48:43.144026 [info ] [MainThread]: 
[0m20:48:43.146016 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m20:48:43.148434 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.9065442, "process_user_time": 3.023675, "process_kernel_time": 0.401199, "process_mem_max_rss": "108004", "process_out_blocks": "1152", "command_success": false, "process_in_blocks": "0"}
[0m20:48:43.151200 [debug] [MainThread]: Command `dbt run` failed at 20:48:43.150774 after 1.91 seconds
[0m20:48:43.153183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c362bb6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c362bb7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c36809d90>]}
[0m20:48:43.154744 [debug] [MainThread]: Flushing usage events
[0m20:55:13.230845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f387bcd44d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f387add3050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f387b342790>]}


============================== 20:55:13.235494 | 64efeef6-5623-47dd-84a6-f0a5c8f9a1a5 ==============================
[0m20:55:13.235494 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:55:13.237223 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/dbt/logs', 'version_check': 'True', 'profiles_dir': '/root', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:55:13.467294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64efeef6-5623-47dd-84a6-f0a5c8f9a1a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f387a616550>]}
[0m20:55:13.524064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '64efeef6-5623-47dd-84a6-f0a5c8f9a1a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f387cce7590>]}
[0m20:55:13.526316 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m20:55:13.539644 [debug] [MainThread]: checksum: 8dc0a8b3d70f1f34b0ae4fcce5e5a1fd7ffa186bf54a1762a302cc92429dddc4, vars: {}, profile: custom_postgres, target: dev, version: 1.8.1
[0m20:55:13.821541 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:55:13.822744 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:55:13.868140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64efeef6-5623-47dd-84a6-f0a5c8f9a1a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f387a39e450>]}
[0m20:55:13.995431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64efeef6-5623-47dd-84a6-f0a5c8f9a1a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f387a643a50>]}
[0m20:55:13.996442 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 413 macros
[0m20:55:13.997750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64efeef6-5623-47dd-84a6-f0a5c8f9a1a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f387aea8910>]}
[0m20:55:14.000867 [info ] [MainThread]: 
[0m20:55:14.002172 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:55:14.006824 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m20:55:14.060713 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m20:55:14.062024 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m20:55:14.063014 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:55:14.093597 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m20:55:14.096003 [debug] [ThreadPool]: On list_destination_db: Close
[0m20:55:14.098655 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m20:55:14.106301 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m20:55:14.107420 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m20:55:14.108322 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:55:14.126715 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:55:14.127922 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m20:55:14.128949 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:55:14.143617 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m20:55:14.146383 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m20:55:14.149966 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m20:55:14.158281 [debug] [MainThread]: Using postgres connection "master"
[0m20:55:14.159706 [debug] [MainThread]: On master: BEGIN
[0m20:55:14.160820 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:55:14.181435 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:55:14.183057 [debug] [MainThread]: Using postgres connection "master"
[0m20:55:14.184245 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:55:14.195456 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m20:55:14.197680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64efeef6-5623-47dd-84a6-f0a5c8f9a1a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f387a5b1f90>]}
[0m20:55:14.199098 [debug] [MainThread]: On master: ROLLBACK
[0m20:55:14.203105 [debug] [MainThread]: Using postgres connection "master"
[0m20:55:14.204548 [debug] [MainThread]: On master: BEGIN
[0m20:55:14.210301 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:55:14.211775 [debug] [MainThread]: On master: COMMIT
[0m20:55:14.212950 [debug] [MainThread]: Using postgres connection "master"
[0m20:55:14.214072 [debug] [MainThread]: On master: COMMIT
[0m20:55:14.217555 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:55:14.218738 [debug] [MainThread]: On master: Close
[0m20:55:14.220116 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:55:14.221503 [info ] [MainThread]: 
[0m20:55:14.226493 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m20:55:14.228484 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m20:55:14.230131 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m20:55:14.231493 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m20:55:14.243631 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m20:55:14.254711 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m20:55:14.307572 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m20:55:14.317099 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m20:55:14.318152 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m20:55:14.319119 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:14.337839 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:55:14.339102 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m20:55:14.340144 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m20:55:14.346583 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.0 seconds
[0m20:55:14.356790 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m20:55:14.358260 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m20:55:14.362324 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:55:14.367319 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m20:55:14.368693 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m20:55:14.372710 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:55:14.397806 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m20:55:14.399550 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m20:55:14.400571 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m20:55:14.405427 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:55:14.414228 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."actors__dbt_backup"
[0m20:55:14.421081 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m20:55:14.422283 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m20:55:14.428756 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:55:14.432533 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m20:55:14.434927 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64efeef6-5623-47dd-84a6-f0a5c8f9a1a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38797e2450>]}
[0m20:55:14.436260 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.20s]
[0m20:55:14.437835 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m20:55:14.439021 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m20:55:14.440240 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m20:55:14.441586 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m20:55:14.442589 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m20:55:14.446895 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m20:55:14.455775 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m20:55:14.461817 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m20:55:14.471616 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m20:55:14.472834 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m20:55:14.474003 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:14.496660 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:55:14.498140 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m20:55:14.499319 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m20:55:14.504724 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.0 seconds
[0m20:55:14.510396 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m20:55:14.511912 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m20:55:14.516764 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:55:14.523080 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m20:55:14.524578 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m20:55:14.529169 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:55:14.532629 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m20:55:14.534151 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m20:55:14.535427 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m20:55:14.540904 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:55:14.545744 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."film_actors__dbt_backup"
[0m20:55:14.547469 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m20:55:14.548600 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m20:55:14.554965 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:55:14.557949 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m20:55:14.559526 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64efeef6-5623-47dd-84a6-f0a5c8f9a1a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3879682310>]}
[0m20:55:14.561254 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.12s]
[0m20:55:14.563004 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m20:55:14.564568 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m20:55:14.566002 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m20:55:14.567496 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m20:55:14.568737 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m20:55:14.573776 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m20:55:14.584474 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m20:55:14.591111 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m20:55:14.601769 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m20:55:14.603300 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m20:55:14.604633 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:14.630639 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:55:14.632256 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m20:55:14.633597 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m20:55:14.639390 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.0 seconds
[0m20:55:14.645135 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m20:55:14.646558 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m20:55:14.651410 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:55:14.659566 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m20:55:14.661117 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m20:55:14.665851 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:55:14.668949 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m20:55:14.670494 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m20:55:14.671811 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m20:55:14.677547 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:55:14.682583 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."films__dbt_backup"
[0m20:55:14.684209 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m20:55:14.685491 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m20:55:14.692064 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:55:14.694828 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m20:55:14.696278 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64efeef6-5623-47dd-84a6-f0a5c8f9a1a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38785a5bd0>]}
[0m20:55:14.697817 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.13s]
[0m20:55:14.699452 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m20:55:14.701711 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m20:55:14.703082 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m20:55:14.704444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.films, now model.custom_postgres.film_ratings)
[0m20:55:14.705562 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m20:55:14.711164 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m20:55:14.720039 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m20:55:14.725954 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m20:55:14.736066 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m20:55:14.737390 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m20:55:14.738625 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:14.760193 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:55:14.761754 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m20:55:14.762994 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  
  
    as
  
  (
    WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM "destination_db"."public"."films"  -- Using dbt's ref function to reference the films table
),

films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ', ') AS actors  -- Aggregating actor names for each film
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id
  );
  
[0m20:55:14.773886 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.0 seconds
[0m20:55:14.779045 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m20:55:14.780327 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m20:55:14.784633 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:55:14.787670 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m20:55:14.789013 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m20:55:14.790176 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m20:55:14.795026 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:55:14.799252 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."film_ratings__dbt_backup"
[0m20:55:14.800907 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m20:55:14.802068 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m20:55:14.806226 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:55:14.809091 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m20:55:14.810632 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64efeef6-5623-47dd-84a6-f0a5c8f9a1a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f387857fad0>]}
[0m20:55:14.812276 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.film_ratings .......................... [[32mSELECT 20[0m in 0.11s]
[0m20:55:14.814003 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m20:55:14.816764 [debug] [MainThread]: Using postgres connection "master"
[0m20:55:14.817896 [debug] [MainThread]: On master: BEGIN
[0m20:55:14.819086 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:55:14.839988 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:55:14.841476 [debug] [MainThread]: On master: COMMIT
[0m20:55:14.842569 [debug] [MainThread]: Using postgres connection "master"
[0m20:55:14.843829 [debug] [MainThread]: On master: COMMIT
[0m20:55:14.847868 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:55:14.849304 [debug] [MainThread]: On master: Close
[0m20:55:14.850767 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:55:14.852082 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m20:55:14.853532 [info ] [MainThread]: 
[0m20:55:14.854897 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m20:55:14.857245 [debug] [MainThread]: Command end result
[0m20:55:14.922336 [info ] [MainThread]: 
[0m20:55:14.923650 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:55:14.924849 [info ] [MainThread]: 
[0m20:55:14.925966 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m20:55:14.928503 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7729458, "process_user_time": 2.465362, "process_kernel_time": 0.366338, "process_mem_max_rss": "106520", "process_in_blocks": "100520", "process_out_blocks": "0"}
[0m20:55:14.929760 [debug] [MainThread]: Command `dbt run` succeeded at 20:55:14.929621 after 1.77 seconds
[0m20:55:14.930811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f387e7dccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f387e7dc350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f387e7dd250>]}
[0m20:55:14.932020 [debug] [MainThread]: Flushing usage events
[0m20:56:05.522893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa121fe0710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa12257da50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa121fe05d0>]}


============================== 20:56:05.530367 | 44e8ae76-792a-4cf7-a0b5-073f17a9a597 ==============================
[0m20:56:05.530367 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:56:05.531652 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:56:05.738578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '44e8ae76-792a-4cf7-a0b5-073f17a9a597', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa122020d50>]}
[0m20:56:05.794302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '44e8ae76-792a-4cf7-a0b5-073f17a9a597', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa123eef850>]}
[0m20:56:05.796771 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m20:56:05.811923 [debug] [MainThread]: checksum: 8dc0a8b3d70f1f34b0ae4fcce5e5a1fd7ffa186bf54a1762a302cc92429dddc4, vars: {}, profile: custom_postgres, target: dev, version: 1.8.1
[0m20:56:06.104755 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:56:06.105821 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:56:06.157184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '44e8ae76-792a-4cf7-a0b5-073f17a9a597', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1220221d0>]}
[0m20:56:06.307441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '44e8ae76-792a-4cf7-a0b5-073f17a9a597', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1216a3e90>]}
[0m20:56:06.308518 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 413 macros
[0m20:56:06.309958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44e8ae76-792a-4cf7-a0b5-073f17a9a597', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa12161ad50>]}
[0m20:56:06.313062 [info ] [MainThread]: 
[0m20:56:06.314412 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:56:06.319725 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m20:56:06.377108 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m20:56:06.378509 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m20:56:06.379602 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:56:06.410648 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m20:56:06.413085 [debug] [ThreadPool]: On list_destination_db: Close
[0m20:56:06.416000 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m20:56:06.424978 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m20:56:06.426289 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m20:56:06.427286 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:56:06.447221 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:56:06.448471 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m20:56:06.449615 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:56:06.455856 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m20:56:06.458119 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m20:56:06.461279 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m20:56:06.468800 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:06.470146 [debug] [MainThread]: On master: BEGIN
[0m20:56:06.471184 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:56:06.494439 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:56:06.495966 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:06.497246 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:56:06.504485 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m20:56:06.506989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44e8ae76-792a-4cf7-a0b5-073f17a9a597', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa121371750>]}
[0m20:56:06.508369 [debug] [MainThread]: On master: ROLLBACK
[0m20:56:06.512205 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:06.513653 [debug] [MainThread]: On master: BEGIN
[0m20:56:06.520267 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:56:06.521722 [debug] [MainThread]: On master: COMMIT
[0m20:56:06.522967 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:06.524241 [debug] [MainThread]: On master: COMMIT
[0m20:56:06.528546 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:56:06.530488 [debug] [MainThread]: On master: Close
[0m20:56:06.532136 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:56:06.533553 [info ] [MainThread]: 
[0m20:56:06.548057 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m20:56:06.549937 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m20:56:06.551558 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m20:56:06.552911 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m20:56:06.566167 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m20:56:06.577036 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m20:56:06.633471 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m20:56:06.642779 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m20:56:06.643876 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m20:56:06.644896 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:06.665994 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:56:06.667372 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m20:56:06.668527 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m20:56:06.672892 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                           ^

[0m20:56:06.674329 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m20:56:06.679002 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m20:56:06.690355 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m20:56:06.693286 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44e8ae76-792a-4cf7-a0b5-073f17a9a597', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1208bd0d0>]}
[0m20:56:06.695338 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.14s]
[0m20:56:06.697366 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m20:56:06.698799 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m20:56:06.701052 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m20:56:06.702660 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m20:56:06.704238 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m20:56:06.709683 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m20:56:06.721468 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m20:56:06.728150 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m20:56:06.738941 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m20:56:06.740444 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m20:56:06.741719 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:06.766130 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:56:06.768018 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m20:56:06.769498 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m20:56:06.774767 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                           ^

[0m20:56:06.776220 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m20:56:06.780887 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m20:56:06.785597 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m20:56:06.787856 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44e8ae76-792a-4cf7-a0b5-073f17a9a597', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa120783e50>]}
[0m20:56:06.789958 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.09s]
[0m20:56:06.791936 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m20:56:06.793652 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m20:56:06.795296 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m20:56:06.797152 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m20:56:06.798556 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m20:56:06.804375 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m20:56:06.816074 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m20:56:06.823571 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m20:56:06.835726 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m20:56:06.837235 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m20:56:06.838689 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:06.864647 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:56:06.866259 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m20:56:06.867615 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m20:56:06.872756 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 12:     SELECT * FROM "destination_db"."public"."films"
                           ^

[0m20:56:06.874372 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m20:56:06.879892 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m20:56:06.885255 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m20:56:06.887331 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44e8ae76-792a-4cf7-a0b5-073f17a9a597', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa121805710>]}
[0m20:56:06.889575 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.09s]
[0m20:56:06.891610 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m20:56:06.894616 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m20:56:06.896596 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m20:56:06.898505 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m20:56:06.901895 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:06.903602 [debug] [MainThread]: On master: BEGIN
[0m20:56:06.905036 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:56:06.934341 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:56:06.936199 [debug] [MainThread]: On master: COMMIT
[0m20:56:06.938316 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:06.940152 [debug] [MainThread]: On master: COMMIT
[0m20:56:06.944978 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:56:06.946821 [debug] [MainThread]: On master: Close
[0m20:56:06.948617 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:56:06.950085 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m20:56:06.952025 [info ] [MainThread]: 
[0m20:56:06.954281 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.64 seconds (0.64s).
[0m20:56:06.957234 [debug] [MainThread]: Command end result
[0m20:56:07.032545 [info ] [MainThread]: 
[0m20:56:07.034007 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m20:56:07.035372 [info ] [MainThread]: 
[0m20:56:07.036777 [error] [MainThread]:   Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m20:56:07.037933 [info ] [MainThread]: 
[0m20:56:07.039144 [error] [MainThread]:   Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."film_actors"
                             ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m20:56:07.040392 [info ] [MainThread]: 
[0m20:56:07.041654 [error] [MainThread]:   Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 12:     SELECT * FROM "destination_db"."public"."films"
                             ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m20:56:07.042805 [info ] [MainThread]: 
[0m20:56:07.043985 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m20:56:07.047037 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.586467, "process_user_time": 2.346363, "process_kernel_time": 0.273068, "process_mem_max_rss": "107780", "process_in_blocks": "100848", "process_out_blocks": "1152", "command_success": false}
[0m20:56:07.048978 [debug] [MainThread]: Command `dbt run` failed at 20:56:07.048685 after 1.59 seconds
[0m20:56:07.050296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa121fe2110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1220376d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1259d0d90>]}
[0m20:56:07.051660 [debug] [MainThread]: Flushing usage events
[0m20:58:06.172141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5981a04f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5981a43550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5981a04c10>]}


============================== 20:58:06.180755 | d26bcd97-5368-46a7-a5b0-9aaedc1a939a ==============================
[0m20:58:06.180755 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:58:06.182204 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/dbt/logs', 'profiles_dir': '/root', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:58:06.414452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd26bcd97-5368-46a7-a5b0-9aaedc1a939a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59811bc450>]}
[0m20:58:06.480212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd26bcd97-5368-46a7-a5b0-9aaedc1a939a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f598391b250>]}
[0m20:58:06.482508 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m20:58:06.498737 [debug] [MainThread]: checksum: 8dc0a8b3d70f1f34b0ae4fcce5e5a1fd7ffa186bf54a1762a302cc92429dddc4, vars: {}, profile: custom_postgres, target: dev, version: 1.8.1
[0m20:58:06.804792 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:58:06.805998 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:58:06.858610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd26bcd97-5368-46a7-a5b0-9aaedc1a939a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5980fe16d0>]}
[0m20:58:06.999223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd26bcd97-5368-46a7-a5b0-9aaedc1a939a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5981bf3b10>]}
[0m20:58:07.000376 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 413 macros
[0m20:58:07.001377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd26bcd97-5368-46a7-a5b0-9aaedc1a939a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5981147450>]}
[0m20:58:07.004240 [info ] [MainThread]: 
[0m20:58:07.005494 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:58:07.010721 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m20:58:07.063894 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m20:58:07.065311 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m20:58:07.066351 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:58:07.090464 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m20:58:07.092678 [debug] [ThreadPool]: On list_destination_db: Close
[0m20:58:07.095149 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m20:58:07.102675 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m20:58:07.103708 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m20:58:07.104621 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:58:07.123083 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:58:07.124309 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m20:58:07.125396 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:58:07.131204 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m20:58:07.133442 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m20:58:07.136549 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m20:58:07.145209 [debug] [MainThread]: Using postgres connection "master"
[0m20:58:07.146496 [debug] [MainThread]: On master: BEGIN
[0m20:58:07.147579 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:58:07.170441 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:58:07.171738 [debug] [MainThread]: Using postgres connection "master"
[0m20:58:07.172932 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:58:07.181410 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m20:58:07.183849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd26bcd97-5368-46a7-a5b0-9aaedc1a939a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5981a45f10>]}
[0m20:58:07.185153 [debug] [MainThread]: On master: ROLLBACK
[0m20:58:07.189242 [debug] [MainThread]: Using postgres connection "master"
[0m20:58:07.190711 [debug] [MainThread]: On master: BEGIN
[0m20:58:07.198646 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:58:07.200569 [debug] [MainThread]: On master: COMMIT
[0m20:58:07.201828 [debug] [MainThread]: Using postgres connection "master"
[0m20:58:07.203226 [debug] [MainThread]: On master: COMMIT
[0m20:58:07.207486 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:58:07.208920 [debug] [MainThread]: On master: Close
[0m20:58:07.210485 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:58:07.212033 [info ] [MainThread]: 
[0m20:58:07.227214 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m20:58:07.229235 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m20:58:07.231169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m20:58:07.232808 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m20:58:07.245452 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m20:58:07.256398 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m20:58:07.311169 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m20:58:07.320708 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m20:58:07.321764 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m20:58:07.322760 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:58:07.342038 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:58:07.343276 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m20:58:07.344340 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m20:58:07.348787 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.0 seconds
[0m20:58:07.358031 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m20:58:07.359468 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m20:58:07.363464 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:58:07.368487 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m20:58:07.369674 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m20:58:07.373634 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:58:07.400187 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m20:58:07.401609 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m20:58:07.402616 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m20:58:07.407303 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:58:07.415331 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."actors__dbt_backup"
[0m20:58:07.421155 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m20:58:07.422190 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m20:58:07.428830 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:58:07.432341 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m20:58:07.434567 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd26bcd97-5368-46a7-a5b0-9aaedc1a939a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59802b8890>]}
[0m20:58:07.435805 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.20s]
[0m20:58:07.437152 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m20:58:07.438330 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m20:58:07.439428 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m20:58:07.440531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m20:58:07.441430 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m20:58:07.445596 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m20:58:07.452908 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m20:58:07.457771 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m20:58:07.465966 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m20:58:07.467113 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m20:58:07.468258 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:58:07.490700 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:58:07.492104 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m20:58:07.493275 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m20:58:07.498305 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.0 seconds
[0m20:58:07.503870 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m20:58:07.505233 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m20:58:07.509360 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:58:07.515130 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m20:58:07.516394 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m20:58:07.520925 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:58:07.524170 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m20:58:07.525731 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m20:58:07.526865 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m20:58:07.532049 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:58:07.536935 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."film_actors__dbt_backup"
[0m20:58:07.538611 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m20:58:07.539753 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m20:58:07.545834 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:58:07.548426 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m20:58:07.549875 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd26bcd97-5368-46a7-a5b0-9aaedc1a939a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5980306ed0>]}
[0m20:58:07.551341 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.11s]
[0m20:58:07.552817 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m20:58:07.554085 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m20:58:07.555467 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m20:58:07.556831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m20:58:07.557869 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m20:58:07.562238 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m20:58:07.570567 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m20:58:07.579099 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m20:58:07.588240 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m20:58:07.589454 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m20:58:07.590550 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:58:07.614789 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:58:07.616147 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m20:58:07.617335 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m20:58:07.624227 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.0 seconds
[0m20:58:07.630122 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m20:58:07.632338 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m20:58:07.637357 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:58:07.644767 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m20:58:07.646266 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m20:58:07.651793 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:58:07.655699 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m20:58:07.657305 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m20:58:07.658687 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m20:58:07.665255 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:58:07.670878 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."films__dbt_backup"
[0m20:58:07.673463 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m20:58:07.674904 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m20:58:07.682062 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:58:07.685233 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m20:58:07.686996 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd26bcd97-5368-46a7-a5b0-9aaedc1a939a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f598020e4d0>]}
[0m20:58:07.688931 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.13s]
[0m20:58:07.691030 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m20:58:07.693428 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m20:58:07.695509 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m20:58:07.697531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.films, now model.custom_postgres.film_ratings)
[0m20:58:07.698998 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m20:58:07.707669 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m20:58:07.719347 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m20:58:07.726633 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m20:58:07.737670 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m20:58:07.739115 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m20:58:07.740516 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:58:07.763544 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:58:07.765291 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m20:58:07.766646 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  
  
    as
  
  (
    WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM "destination_db"."public"."films"  -- Using dbt's ref function to reference the films table
),

films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ', ') AS actors  -- Aggregating actor names for each film
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id
  );
  
[0m20:58:07.777048 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.0 seconds
[0m20:58:07.782461 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m20:58:07.783943 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m20:58:07.788227 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:58:07.791042 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m20:58:07.792236 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m20:58:07.793254 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m20:58:07.799018 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:58:07.804143 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."film_ratings__dbt_backup"
[0m20:58:07.806177 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m20:58:07.807461 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m20:58:07.812324 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:58:07.815532 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m20:58:07.817417 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd26bcd97-5368-46a7-a5b0-9aaedc1a939a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59801f1bd0>]}
[0m20:58:07.819262 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.film_ratings .......................... [[32mSELECT 20[0m in 0.12s]
[0m20:58:07.821020 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m20:58:07.824101 [debug] [MainThread]: Using postgres connection "master"
[0m20:58:07.825650 [debug] [MainThread]: On master: BEGIN
[0m20:58:07.826781 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:58:07.853032 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:58:07.854579 [debug] [MainThread]: On master: COMMIT
[0m20:58:07.856144 [debug] [MainThread]: Using postgres connection "master"
[0m20:58:07.857522 [debug] [MainThread]: On master: COMMIT
[0m20:58:07.861644 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:58:07.862966 [debug] [MainThread]: On master: Close
[0m20:58:07.864544 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:58:07.866009 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m20:58:07.867527 [info ] [MainThread]: 
[0m20:58:07.868902 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.86 seconds (0.86s).
[0m20:58:07.871448 [debug] [MainThread]: Command end result
[0m20:58:07.941097 [info ] [MainThread]: 
[0m20:58:07.942535 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:58:07.943762 [info ] [MainThread]: 
[0m20:58:07.944962 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m20:58:07.947767 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8455783, "process_user_time": 2.26273, "process_kernel_time": 0.313451, "process_mem_max_rss": "107712", "process_in_blocks": "100400", "process_out_blocks": "1152"}
[0m20:58:07.949265 [debug] [MainThread]: Command `dbt run` succeeded at 20:58:07.949103 after 1.85 seconds
[0m20:58:07.950444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5982125b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59852ac810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5985409050>]}
[0m20:58:07.951626 [debug] [MainThread]: Flushing usage events
[0m18:51:44.560530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9df6d62f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9df6d63190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9df7e95710>]}


============================== 18:51:44.577188 | 862ceed8-6af7-49ef-9475-fe9c3c242950 ==============================
[0m18:51:44.577188 [info ] [MainThread]: Running with dbt=1.8.1
[0m18:51:44.581043 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root', 'log_path': '/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:51:45.024873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '862ceed8-6af7-49ef-9475-fe9c3c242950', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9df636ff10>]}
[0m18:51:45.168938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '862ceed8-6af7-49ef-9475-fe9c3c242950', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9df8a9ba50>]}
[0m18:51:45.172634 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m18:51:45.210347 [debug] [MainThread]: checksum: 8dc0a8b3d70f1f34b0ae4fcce5e5a1fd7ffa186bf54a1762a302cc92429dddc4, vars: {}, profile: custom_postgres, target: dev, version: 1.8.1
[0m18:51:45.623437 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:51:45.624951 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:51:45.692998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '862ceed8-6af7-49ef-9475-fe9c3c242950', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9df6b95e10>]}
[0m18:51:45.885338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '862ceed8-6af7-49ef-9475-fe9c3c242950', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9df63584d0>]}
[0m18:51:45.886795 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 413 macros
[0m18:51:45.888102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '862ceed8-6af7-49ef-9475-fe9c3c242950', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9df61b7a50>]}
[0m18:51:45.891811 [info ] [MainThread]: 
[0m18:51:45.893497 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:51:45.899904 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m18:51:45.973984 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m18:51:45.975385 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m18:51:45.976457 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:51:46.008624 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m18:51:46.011220 [debug] [ThreadPool]: On list_destination_db: Close
[0m18:51:46.014580 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m18:51:46.024673 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m18:51:46.026287 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m18:51:46.027444 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:51:46.051845 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:51:46.053190 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m18:51:46.054456 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:51:46.062023 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m18:51:46.064866 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m18:51:46.068886 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m18:51:46.079152 [debug] [MainThread]: Using postgres connection "master"
[0m18:51:46.080624 [debug] [MainThread]: On master: BEGIN
[0m18:51:46.081776 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:51:46.107110 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:51:46.108998 [debug] [MainThread]: Using postgres connection "master"
[0m18:51:46.110433 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:51:46.121674 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m18:51:46.124471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '862ceed8-6af7-49ef-9475-fe9c3c242950', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9df6096550>]}
[0m18:51:46.126313 [debug] [MainThread]: On master: ROLLBACK
[0m18:51:46.131425 [debug] [MainThread]: Using postgres connection "master"
[0m18:51:46.133369 [debug] [MainThread]: On master: BEGIN
[0m18:51:46.141314 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:51:46.143292 [debug] [MainThread]: On master: COMMIT
[0m18:51:46.144996 [debug] [MainThread]: Using postgres connection "master"
[0m18:51:46.146399 [debug] [MainThread]: On master: COMMIT
[0m18:51:46.152173 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:51:46.153885 [debug] [MainThread]: On master: Close
[0m18:51:46.155577 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:51:46.157358 [info ] [MainThread]: 
[0m18:51:46.173102 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m18:51:46.176096 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m18:51:46.179179 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m18:51:46.181378 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m18:51:46.201087 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m18:51:46.214502 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m18:51:46.280356 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m18:51:46.291702 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m18:51:46.293093 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m18:51:46.294382 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:51:46.319770 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:51:46.321472 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m18:51:46.322937 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m18:51:46.329353 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.0 seconds
[0m18:51:46.342179 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m18:51:46.343783 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m18:51:46.348460 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:51:46.354535 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m18:51:46.356624 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m18:51:46.363291 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:51:46.419208 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m18:51:46.421233 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m18:51:46.422747 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m18:51:46.429618 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:51:46.442063 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."actors__dbt_backup"
[0m18:51:46.452362 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m18:51:46.454261 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m18:51:46.462921 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:51:46.467964 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m18:51:46.471591 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '862ceed8-6af7-49ef-9475-fe9c3c242950', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9df5444490>]}
[0m18:51:46.473671 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.29s]
[0m18:51:46.475631 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m18:51:46.477482 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m18:51:46.479096 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m18:51:46.480717 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m18:51:46.482086 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m18:51:46.487821 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m18:51:46.500703 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m18:51:46.508782 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m18:51:46.521741 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m18:51:46.523349 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m18:51:46.525071 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:51:46.555062 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:51:46.556821 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m18:51:46.558608 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m18:51:46.564875 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.0 seconds
[0m18:51:46.571210 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m18:51:46.572794 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m18:51:46.578640 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:51:46.584804 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m18:51:46.586399 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m18:51:46.591638 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:51:46.595805 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m18:51:46.597469 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m18:51:46.599111 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m18:51:46.604779 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:51:46.611694 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."film_actors__dbt_backup"
[0m18:51:46.613973 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m18:51:46.615749 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m18:51:46.624097 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:51:46.628232 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m18:51:46.631028 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '862ceed8-6af7-49ef-9475-fe9c3c242950', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9df94c5150>]}
[0m18:51:46.633536 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.15s]
[0m18:51:46.636203 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m18:51:46.638739 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m18:51:46.640965 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m18:51:46.642953 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m18:51:46.644465 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m18:51:46.650103 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m18:51:46.661349 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m18:51:46.672892 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m18:51:46.683994 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m18:51:46.686318 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m18:51:46.687929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:51:46.715259 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:51:46.716879 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m18:51:46.718246 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m18:51:46.724745 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.0 seconds
[0m18:51:46.731650 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m18:51:46.733658 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m18:51:46.738804 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:51:46.744808 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m18:51:46.746338 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m18:51:46.751419 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:51:46.755043 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m18:51:46.756820 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m18:51:46.758802 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m18:51:46.764892 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:51:46.771541 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."films__dbt_backup"
[0m18:51:46.773749 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m18:51:46.775243 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m18:51:46.783079 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:51:46.786420 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m18:51:46.788129 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '862ceed8-6af7-49ef-9475-fe9c3c242950', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9df5396d10>]}
[0m18:51:46.789786 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.15s]
[0m18:51:46.791730 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m18:51:46.794343 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m18:51:46.796119 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m18:51:46.797798 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.films, now model.custom_postgres.film_ratings)
[0m18:51:46.799188 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m18:51:46.805485 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m18:51:46.816646 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m18:51:46.824345 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m18:51:46.835811 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m18:51:46.837482 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m18:51:46.838861 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:51:46.865567 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:51:46.867475 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m18:51:46.869183 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  
  
    as
  
  (
    WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM "destination_db"."public"."films"  -- Using dbt's ref function to reference the films table
),

films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ', ') AS actors  -- Aggregating actor names for each film
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id
  );
  
[0m18:51:46.880415 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.0 seconds
[0m18:51:46.886561 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m18:51:46.888045 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m18:51:46.893255 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:51:46.896659 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m18:51:46.898177 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m18:51:46.900045 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m18:51:46.905852 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:51:46.911373 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."film_ratings__dbt_backup"
[0m18:51:46.913363 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m18:51:46.915190 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m18:51:46.920964 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:51:46.924211 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m18:51:46.926623 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '862ceed8-6af7-49ef-9475-fe9c3c242950', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9df538a610>]}
[0m18:51:46.928828 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.film_ratings .......................... [[32mSELECT 20[0m in 0.13s]
[0m18:51:46.930735 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m18:51:46.934486 [debug] [MainThread]: Using postgres connection "master"
[0m18:51:46.936117 [debug] [MainThread]: On master: BEGIN
[0m18:51:46.937488 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:51:46.963907 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:51:46.965736 [debug] [MainThread]: On master: COMMIT
[0m18:51:46.967549 [debug] [MainThread]: Using postgres connection "master"
[0m18:51:46.968935 [debug] [MainThread]: On master: COMMIT
[0m18:51:46.973951 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:51:46.976066 [debug] [MainThread]: On master: Close
[0m18:51:46.977939 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:51:46.979627 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m18:51:46.981124 [info ] [MainThread]: 
[0m18:51:46.982721 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.09 seconds (1.09s).
[0m18:51:46.986075 [debug] [MainThread]: Command end result
[0m18:51:47.057346 [info ] [MainThread]: 
[0m18:51:47.058814 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:51:47.060076 [info ] [MainThread]: 
[0m18:51:47.061299 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m18:51:47.063855 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.6556058, "process_user_time": 3.232688, "process_kernel_time": 0.42429, "process_mem_max_rss": "107808", "process_in_blocks": "108592", "process_out_blocks": "1152"}
[0m18:51:47.065323 [debug] [MainThread]: Command `dbt run` succeeded at 18:51:47.065139 after 2.66 seconds
[0m18:51:47.066489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dfa4306d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dfa58c250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dfa58cc90>]}
[0m18:51:47.067571 [debug] [MainThread]: Flushing usage events
[0m19:01:34.804861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd58fe8ec50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd58fe7e8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd58fe8c110>]}


============================== 19:01:34.812648 | 0011165e-aead-493e-9dfa-38e3e0f06799 ==============================
[0m19:01:34.812648 [info ] [MainThread]: Running with dbt=1.8.1
[0m19:01:34.813855 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'debug': 'False', 'profiles_dir': '/root', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'send_anonymous_usage_stats': 'True'}
[0m19:01:35.024748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0011165e-aead-493e-9dfa-38e3e0f06799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd58f503550>]}
[0m19:01:35.093430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0011165e-aead-493e-9dfa-38e3e0f06799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd591bc7d10>]}
[0m19:01:35.095655 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m19:01:35.113975 [debug] [MainThread]: checksum: 8dc0a8b3d70f1f34b0ae4fcce5e5a1fd7ffa186bf54a1762a302cc92429dddc4, vars: {}, profile: custom_postgres, target: dev, version: 1.8.1
[0m19:01:35.523748 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m19:01:35.525653 [debug] [MainThread]: Partial parsing: added file: custom_postgres://macros/film_ratings_macro.sql
[0m19:01:35.526961 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/film_ratings.sql
[0m19:01:35.821451 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m19:01:35.823075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0011165e-aead-493e-9dfa-38e3e0f06799', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd58f21bad0>]}
[0m19:01:36.057350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0011165e-aead-493e-9dfa-38e3e0f06799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd58d0380d0>]}
[0m19:01:36.287448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0011165e-aead-493e-9dfa-38e3e0f06799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd58cea3890>]}
[0m19:01:36.288897 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 414 macros
[0m19:01:36.290167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0011165e-aead-493e-9dfa-38e3e0f06799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd58f227510>]}
[0m19:01:36.293786 [info ] [MainThread]: 
[0m19:01:36.295499 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:01:36.301549 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m19:01:36.370175 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m19:01:36.371693 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m19:01:36.372904 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:01:36.400657 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m19:01:36.403270 [debug] [ThreadPool]: On list_destination_db: Close
[0m19:01:36.406212 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m19:01:36.414273 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m19:01:36.415533 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m19:01:36.416724 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:01:36.437552 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:01:36.438952 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m19:01:36.440083 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:01:36.446915 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m19:01:36.449676 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m19:01:36.453575 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m19:01:36.461830 [debug] [MainThread]: Using postgres connection "master"
[0m19:01:36.463053 [debug] [MainThread]: On master: BEGIN
[0m19:01:36.464073 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:01:36.485778 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:01:36.487188 [debug] [MainThread]: Using postgres connection "master"
[0m19:01:36.488300 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:01:36.496757 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m19:01:36.499257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0011165e-aead-493e-9dfa-38e3e0f06799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd58d040f10>]}
[0m19:01:36.500537 [debug] [MainThread]: On master: ROLLBACK
[0m19:01:36.503655 [debug] [MainThread]: Using postgres connection "master"
[0m19:01:36.504569 [debug] [MainThread]: On master: BEGIN
[0m19:01:36.510532 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:01:36.512057 [debug] [MainThread]: On master: COMMIT
[0m19:01:36.513564 [debug] [MainThread]: Using postgres connection "master"
[0m19:01:36.514969 [debug] [MainThread]: On master: COMMIT
[0m19:01:36.519268 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:01:36.520817 [debug] [MainThread]: On master: Close
[0m19:01:36.522399 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:01:36.524241 [info ] [MainThread]: 
[0m19:01:36.538039 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m19:01:36.540160 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m19:01:36.541807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m19:01:36.543198 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m19:01:36.555945 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m19:01:36.566433 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m19:01:36.614192 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m19:01:36.623712 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m19:01:36.624794 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m19:01:36.625829 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:36.645134 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:01:36.646518 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m19:01:36.647746 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m19:01:36.652188 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.0 seconds
[0m19:01:36.659674 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m19:01:36.660749 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m19:01:36.665567 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:01:36.672817 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m19:01:36.674395 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m19:01:36.678779 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:01:36.704070 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m19:01:36.705773 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m19:01:36.706825 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m19:01:36.711943 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:01:36.719901 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."actors__dbt_backup"
[0m19:01:36.726088 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m19:01:36.727171 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m19:01:36.733338 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:01:36.737051 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m19:01:36.739656 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0011165e-aead-493e-9dfa-38e3e0f06799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd58c3792d0>]}
[0m19:01:36.741168 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.20s]
[0m19:01:36.742589 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m19:01:36.743674 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m19:01:36.744824 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m19:01:36.745993 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m19:01:36.746951 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m19:01:36.750876 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m19:01:36.759223 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m19:01:36.764162 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m19:01:36.773846 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m19:01:36.775155 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m19:01:36.776318 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:36.799818 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:01:36.801327 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m19:01:36.802566 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m19:01:36.807996 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.0 seconds
[0m19:01:36.813439 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m19:01:36.814638 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m19:01:36.818981 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:01:36.824096 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m19:01:36.825634 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m19:01:36.830168 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:01:36.833275 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m19:01:36.834455 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m19:01:36.835552 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m19:01:36.841441 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:01:36.846272 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."film_actors__dbt_backup"
[0m19:01:36.848077 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m19:01:36.849517 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m19:01:36.855860 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:01:36.858981 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m19:01:36.860589 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0011165e-aead-493e-9dfa-38e3e0f06799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd58c409b90>]}
[0m19:01:36.862262 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.11s]
[0m19:01:36.864177 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m19:01:36.865695 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m19:01:36.867216 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m19:01:36.868602 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m19:01:36.869822 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m19:01:36.874394 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m19:01:36.883516 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m19:01:36.889188 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m19:01:36.899345 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m19:01:36.900626 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m19:01:36.901850 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:36.924740 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:01:36.926279 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m19:01:36.927609 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m19:01:36.934043 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.0 seconds
[0m19:01:36.939747 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m19:01:36.941349 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m19:01:36.945789 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:01:36.951438 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m19:01:36.952971 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m19:01:36.957277 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:01:36.960199 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m19:01:36.961536 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m19:01:36.962641 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m19:01:36.967878 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:01:36.975724 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."films__dbt_backup"
[0m19:01:37.053269 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m19:01:37.054748 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m19:01:37.060776 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:01:37.063492 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m19:01:37.065564 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0011165e-aead-493e-9dfa-38e3e0f06799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd58c129710>]}
[0m19:01:37.067597 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.20s]
[0m19:01:37.069586 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m19:01:37.072033 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m19:01:37.073509 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m19:01:37.074919 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.films, now model.custom_postgres.film_ratings)
[0m19:01:37.076076 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m19:01:37.081272 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m19:01:37.090656 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m19:01:37.096163 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m19:01:37.105448 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m19:01:37.107110 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m19:01:37.108547 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:37.130387 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:01:37.132046 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m19:01:37.133305 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  
  
    as
  
  (
    

WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM "destination_db"."public"."films"  -- Using dbt's ref function to reference the films table
),

films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ', ') AS actors  -- Aggregating actor names for each film
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id


  );
  
[0m19:01:37.144056 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.0 seconds
[0m19:01:37.148782 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m19:01:37.149833 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m19:01:37.153635 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:01:37.156335 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m19:01:37.157525 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m19:01:37.158708 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m19:01:37.163220 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:01:37.167326 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."film_ratings__dbt_backup"
[0m19:01:37.168960 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m19:01:37.170046 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m19:01:37.174777 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:01:37.177885 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m19:01:37.179824 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0011165e-aead-493e-9dfa-38e3e0f06799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd58f224990>]}
[0m19:01:37.181757 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.film_ratings .......................... [[32mSELECT 20[0m in 0.10s]
[0m19:01:37.183725 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m19:01:37.186799 [debug] [MainThread]: Using postgres connection "master"
[0m19:01:37.188010 [debug] [MainThread]: On master: BEGIN
[0m19:01:37.189057 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:01:37.210311 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:01:37.211831 [debug] [MainThread]: On master: COMMIT
[0m19:01:37.212991 [debug] [MainThread]: Using postgres connection "master"
[0m19:01:37.214307 [debug] [MainThread]: On master: COMMIT
[0m19:01:37.218570 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:01:37.220107 [debug] [MainThread]: On master: Close
[0m19:01:37.221485 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:01:37.222779 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m19:01:37.224371 [info ] [MainThread]: 
[0m19:01:37.225932 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.93 seconds (0.93s).
[0m19:01:37.228432 [debug] [MainThread]: Command end result
[0m19:01:37.292943 [info ] [MainThread]: 
[0m19:01:37.294373 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:01:37.295526 [info ] [MainThread]: 
[0m19:01:37.296614 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m19:01:37.299481 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.5589938, "process_user_time": 2.68628, "process_kernel_time": 0.310726, "process_mem_max_rss": "113480", "process_in_blocks": "100704", "process_out_blocks": "1152"}
[0m19:01:37.300881 [debug] [MainThread]: Command `dbt run` succeeded at 19:01:37.300727 after 2.56 seconds
[0m19:01:37.301935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd58f4c0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd593560810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd590196fd0>]}
[0m19:01:37.303022 [debug] [MainThread]: Flushing usage events
[0m19:01:42.683761 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m19:06:07.245749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64cf4f6fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64cf9fad90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64cf4f6e10>]}


============================== 19:06:07.252239 | c42ce1ae-df13-4003-94e3-1df3570d7c89 ==============================
[0m19:06:07.252239 [info ] [MainThread]: Running with dbt=1.8.1
[0m19:06:07.253623 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'debug': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:06:07.440745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c42ce1ae-df13-4003-94e3-1df3570d7c89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64cf535610>]}
[0m19:06:07.488651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c42ce1ae-df13-4003-94e3-1df3570d7c89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64d1442e90>]}
[0m19:06:07.490593 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m19:06:07.502595 [debug] [MainThread]: checksum: 8dc0a8b3d70f1f34b0ae4fcce5e5a1fd7ffa186bf54a1762a302cc92429dddc4, vars: {}, profile: custom_postgres, target: dev, version: 1.8.1
[0m19:06:07.771325 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m19:06:07.772780 [debug] [MainThread]: Partial parsing: added file: custom_postgres://macros/ratings_macro.sql
[0m19:06:07.773872 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://macros/film_ratings_macro.sql
[0m19:06:07.945989 [error] [MainThread]: Encountered an error:
maximum recursion depth exceeded
[0m19:06:07.968724 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 320, in wrapper
    ctx.obj["manifest"] = parse_manifest(
                          ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/parser/manifest.py", line 1898, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/parser/manifest.py", line 330, in get_full_manifest
    manifest = loader.load()
               ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/parser/manifest.py", line 435, in load
    self.parse_project(
  File "/usr/local/lib/python3.11/site-packages/dbt/parser/manifest.py", line 733, in parse_project
    parser.parse_file(block)
  File "/usr/local/lib/python3.11/site-packages/dbt/parser/base.py", line 484, in parse_file
    self.parse_node(file_block)
  File "/usr/local/lib/python3.11/site-packages/dbt/parser/base.py", line 445, in parse_node
    self.render_update(node, config)
  File "/usr/local/lib/python3.11/site-packages/dbt/parser/models.py", line 348, in render_update
    super().render_update(node, config)
  File "/usr/local/lib/python3.11/site-packages/dbt/parser/base.py", line 421, in render_update
    context = self.render_with_context(node, config)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/parser/base.py", line 270, in render_with_context
    get_rendered(parsed_node.raw_code, context, parsed_node, capture_macros=True)
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 146, in get_rendered
    rendered = render_template(template, ctx, node)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 539, in render_template
    return template.render(ctx)
           ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 144, in render
    return self.environment.handle_exception()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/environment.py", line 939, in handle_exception
    raise rewrite_traceback_stack(source=source)
  File "<template>", line 1, in top-level template code
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 298, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 11, in template
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 294, in call_macro
    macro = self.get_macro()
            ^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 276, in get_macro
    module = template.make_module(vars=self.context, shared=False)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/environment.py", line 1407, in make_module
    ctx = self.new_context(vars, shared, locals)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 127, in new_context
    parent = ChainMap(vars, self.globals) if self.globals else vars
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RecursionError: maximum recursion depth exceeded

[0m19:06:07.975798 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.7859297, "process_user_time": 1.620289, "process_kernel_time": 0.190033, "process_mem_max_rss": "105068", "process_in_blocks": "97808", "process_out_blocks": "1032", "command_success": false}
[0m19:06:07.977249 [debug] [MainThread]: Command `dbt run` failed at 19:06:07.977089 after 0.79 seconds
[0m19:06:07.978330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64cf54b090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64cf4f63d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64cc8907d0>]}
[0m19:06:07.979437 [debug] [MainThread]: Flushing usage events
[0m19:07:43.200281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2696f16e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2696f171d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26972d6450>]}


============================== 19:07:43.206794 | 7e51157d-1f02-45a8-a370-c6bc60e165c9 ==============================
[0m19:07:43.206794 [info ] [MainThread]: Running with dbt=1.8.1
[0m19:07:43.208291 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root', 'log_path': '/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'send_anonymous_usage_stats': 'True'}
[0m19:07:43.381628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e51157d-1f02-45a8-a370-c6bc60e165c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2696d55ad0>]}
[0m19:07:43.429897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e51157d-1f02-45a8-a370-c6bc60e165c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2698c534d0>]}
[0m19:07:43.431992 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m19:07:43.444461 [debug] [MainThread]: checksum: 8dc0a8b3d70f1f34b0ae4fcce5e5a1fd7ffa186bf54a1762a302cc92429dddc4, vars: {}, profile: custom_postgres, target: dev, version: 1.8.1
[0m19:07:43.691497 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m19:07:43.692765 [debug] [MainThread]: Partial parsing: added file: custom_postgres://macros/ratings_macro.sql
[0m19:07:43.693832 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://macros/film_ratings_macro.sql
[0m19:07:43.696356 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two macros named "generate_film_ratings" in the project
  "custom_postgres".
   To fix this error, rename or remove one of the following macros:
      - macros/film_ratings_macro.sql
      - macros/ratings_macro.sql
[0m19:07:43.698598 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.5556915, "process_user_time": 1.344782, "process_kernel_time": 0.195044, "process_mem_max_rss": "96876", "process_in_blocks": "96480", "process_out_blocks": "1032", "command_success": false}
[0m19:07:43.699754 [debug] [MainThread]: Command `dbt run` failed at 19:07:43.699578 after 0.56 seconds
[0m19:07:43.700648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f269a740cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26962d2010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26962d2050>]}
[0m19:07:43.701571 [debug] [MainThread]: Flushing usage events
[0m19:11:16.599595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd36eebcf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd36f0abc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd36eefbc50>]}


============================== 19:11:16.605947 | a53652e3-dc06-4dda-83d3-bd1ca1ce0c33 ==============================
[0m19:11:16.605947 [info ] [MainThread]: Running with dbt=1.8.1
[0m19:11:16.607349 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:11:16.793052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a53652e3-dc06-4dda-83d3-bd1ca1ce0c33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd36f30b150>]}
[0m19:11:16.845723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a53652e3-dc06-4dda-83d3-bd1ca1ce0c33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd370df3ad0>]}
[0m19:11:16.848069 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m19:11:16.863588 [debug] [MainThread]: checksum: 8dc0a8b3d70f1f34b0ae4fcce5e5a1fd7ffa186bf54a1762a302cc92429dddc4, vars: {}, profile: custom_postgres, target: dev, version: 1.8.1
[0m19:11:17.172875 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m19:11:17.174913 [debug] [MainThread]: Partial parsing: added file: custom_postgres://macros/ratings_macro.sql
[0m19:11:17.176080 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://macros/film_ratings_macro.sql
[0m19:11:17.323304 [error] [MainThread]: Encountered an error:
Compilation Error in model film_ratings (models/example/film_ratings.sql)
  'generate_ratings' is undefined
[0m19:11:17.325959 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.7828479, "process_user_time": 1.703606, "process_kernel_time": 0.214226, "process_mem_max_rss": "99100", "process_in_blocks": "96984", "process_out_blocks": "1032", "command_success": false}
[0m19:11:17.327215 [debug] [MainThread]: Command `dbt run` failed at 19:11:17.327021 after 0.78 seconds
[0m19:11:17.328343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd36eefbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd36eebe250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3728d4c50>]}
[0m19:11:17.329242 [debug] [MainThread]: Flushing usage events
[0m19:14:02.568955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc8f45ab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc8f45ac50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc8f9fa210>]}


============================== 19:14:02.576120 | b44a54be-da06-4239-8ac3-44e8a0870c49 ==============================
[0m19:14:02.576120 [info ] [MainThread]: Running with dbt=1.8.1
[0m19:14:02.577259 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'profiles_dir': '/root', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:14:02.757717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b44a54be-da06-4239-8ac3-44e8a0870c49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc8ec480d0>]}
[0m19:14:02.804920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b44a54be-da06-4239-8ac3-44e8a0870c49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc9136b750>]}
[0m19:14:02.807179 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m19:14:02.819826 [debug] [MainThread]: checksum: 8dc0a8b3d70f1f34b0ae4fcce5e5a1fd7ffa186bf54a1762a302cc92429dddc4, vars: {}, profile: custom_postgres, target: dev, version: 1.8.1
[0m19:14:03.076624 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m19:14:03.078049 [debug] [MainThread]: Partial parsing: added file: custom_postgres://macros/ratings_macro.sql
[0m19:14:03.079146 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://macros/film_ratings_macro.sql
[0m19:14:03.227763 [error] [MainThread]: Encountered an error:
Compilation Error in model film_ratings (models/example/film_ratings.sql)
  'generate_ratings' is undefined
[0m19:14:03.230427 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.7202467, "process_user_time": 1.511099, "process_kernel_time": 0.172407, "process_mem_max_rss": "99020", "process_in_blocks": "96984", "process_out_blocks": "1032", "command_success": false}
[0m19:14:03.231679 [debug] [MainThread]: Command `dbt run` failed at 19:14:03.231554 after 0.72 seconds
[0m19:14:03.232616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc8f45a9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc8f45a210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc92e58c90>]}
[0m19:14:03.233477 [debug] [MainThread]: Flushing usage events
[0m19:15:43.045507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5c9eeafd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5c9eeae50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5c9ee8150>]}


============================== 19:15:43.052430 | 8278cb26-fe36-4dde-beb2-2486e5d6a382 ==============================
[0m19:15:43.052430 [info ] [MainThread]: Running with dbt=1.8.1
[0m19:15:43.053721 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:15:43.241464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8278cb26-fe36-4dde-beb2-2486e5d6a382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5c9d83510>]}
[0m19:15:43.288859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8278cb26-fe36-4dde-beb2-2486e5d6a382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5cbc239d0>]}
[0m19:15:43.291048 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m19:15:43.302981 [debug] [MainThread]: checksum: 8dc0a8b3d70f1f34b0ae4fcce5e5a1fd7ffa186bf54a1762a302cc92429dddc4, vars: {}, profile: custom_postgres, target: dev, version: 1.8.1
[0m19:15:43.579295 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m19:15:43.581142 [debug] [MainThread]: Partial parsing: added file: custom_postgres://macros/ratings_macro.sql
[0m19:15:43.582337 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://macros/film_ratings_macro.sql
[0m19:15:43.791339 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m19:15:43.792957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8278cb26-fe36-4dde-beb2-2486e5d6a382', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5c9407010>]}
[0m19:15:43.961977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8278cb26-fe36-4dde-beb2-2486e5d6a382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5c91c24d0>]}
[0m19:15:44.083134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8278cb26-fe36-4dde-beb2-2486e5d6a382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5cb9dfd50>]}
[0m19:15:44.084112 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 415 macros
[0m19:15:44.085151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8278cb26-fe36-4dde-beb2-2486e5d6a382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5c9294d50>]}
[0m19:15:44.087714 [info ] [MainThread]: 
[0m19:15:44.088926 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:15:44.093282 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m19:15:44.134707 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m19:15:44.135954 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m19:15:44.136767 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:15:44.158503 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m19:15:44.160648 [debug] [ThreadPool]: On list_destination_db: Close
[0m19:15:44.162947 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m19:15:44.170430 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m19:15:44.171724 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m19:15:44.172587 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:15:44.191001 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:15:44.192194 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m19:15:44.193041 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:15:44.198453 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m19:15:44.200534 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m19:15:44.203225 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m19:15:44.209726 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:44.210780 [debug] [MainThread]: On master: BEGIN
[0m19:15:44.211646 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:15:44.230517 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:15:44.231863 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:44.232955 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:15:44.240961 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m19:15:44.243361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8278cb26-fe36-4dde-beb2-2486e5d6a382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5aae1d390>]}
[0m19:15:44.244650 [debug] [MainThread]: On master: ROLLBACK
[0m19:15:44.248343 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:44.249499 [debug] [MainThread]: On master: BEGIN
[0m19:15:44.255631 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:15:44.256912 [debug] [MainThread]: On master: COMMIT
[0m19:15:44.258012 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:44.259013 [debug] [MainThread]: On master: COMMIT
[0m19:15:44.262242 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:15:44.263333 [debug] [MainThread]: On master: Close
[0m19:15:44.264560 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:15:44.265722 [info ] [MainThread]: 
[0m19:15:44.276788 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m19:15:44.278293 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m19:15:44.279621 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m19:15:44.280692 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m19:15:44.290411 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m19:15:44.299218 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m19:15:44.349244 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m19:15:44.357780 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m19:15:44.358917 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m19:15:44.359792 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:44.377960 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:15:44.379301 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m19:15:44.380295 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m19:15:44.384452 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.0 seconds
[0m19:15:44.392166 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m19:15:44.393350 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m19:15:44.397206 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:44.402196 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m19:15:44.403538 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m19:15:44.407589 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:44.433967 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m19:15:44.435469 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m19:15:44.436518 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m19:15:44.442797 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:15:44.451568 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."actors__dbt_backup"
[0m19:15:44.458748 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m19:15:44.460103 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m19:15:44.466448 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:15:44.470173 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m19:15:44.472839 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8278cb26-fe36-4dde-beb2-2486e5d6a382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5aa2060d0>]}
[0m19:15:44.474308 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.19s]
[0m19:15:44.475945 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m19:15:44.477143 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m19:15:44.478367 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m19:15:44.479568 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m19:15:44.480580 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m19:15:44.484873 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m19:15:44.493700 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m19:15:44.499195 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m19:15:44.508473 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m19:15:44.509581 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m19:15:44.510577 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:44.532825 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:15:44.534526 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m19:15:44.535817 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m19:15:44.541006 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.0 seconds
[0m19:15:44.546178 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m19:15:44.547242 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m19:15:44.550932 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:44.555482 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m19:15:44.556684 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m19:15:44.560842 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:44.563793 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m19:15:44.565193 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m19:15:44.566307 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m19:15:44.571009 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:15:44.575811 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."film_actors__dbt_backup"
[0m19:15:44.577774 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m19:15:44.578942 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m19:15:44.585427 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:15:44.588414 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m19:15:44.590347 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8278cb26-fe36-4dde-beb2-2486e5d6a382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5aa360110>]}
[0m19:15:44.592057 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.11s]
[0m19:15:44.593747 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m19:15:44.595231 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m19:15:44.596932 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m19:15:44.598438 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m19:15:44.599787 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m19:15:44.605304 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m19:15:44.617218 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m19:15:44.626174 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m19:15:44.636960 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m19:15:44.638328 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m19:15:44.639628 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:44.664131 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:15:44.665586 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m19:15:44.666722 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m19:15:44.671772 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.0 seconds
[0m19:15:44.677347 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m19:15:44.678732 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m19:15:44.683301 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:44.758261 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m19:15:44.759757 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m19:15:44.763530 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:44.766030 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m19:15:44.766950 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m19:15:44.767758 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m19:15:44.771721 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:15:44.774817 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."films__dbt_backup"
[0m19:15:44.775934 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m19:15:44.776816 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m19:15:44.781546 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:15:44.783601 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m19:15:44.784714 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8278cb26-fe36-4dde-beb2-2486e5d6a382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5aa149d10>]}
[0m19:15:44.785909 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.19s]
[0m19:15:44.787108 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m19:15:44.788658 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m19:15:44.789746 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m19:15:44.790788 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.films, now model.custom_postgres.film_ratings)
[0m19:15:44.791659 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m19:15:44.795381 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m19:15:44.803420 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m19:15:44.808204 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m19:15:44.816663 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m19:15:44.817972 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m19:15:44.818977 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:44.837113 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:15:44.838519 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m19:15:44.839776 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  
  
    as
  
  (
    

WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating, 
        

CASE
    WHEN user_rating >= 4.5 THEN 'Excellent'
    WHEN user_rating >= 4.0 THEN 'Good'
    WHEN user_rating >= 3.0 THEN 'Average'
    ELSE 'Poor'
    END AS rating_category


    FROM "destination_db"."public"."films"  -- Using dbt's ref function to reference the films table
),

films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ', ') AS actors  -- Aggregating actor names for each film
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id


  );
  
[0m19:15:44.849881 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.0 seconds
[0m19:15:44.854590 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m19:15:44.855603 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m19:15:44.859200 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:44.861813 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m19:15:44.862874 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m19:15:44.863982 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m19:15:44.868590 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:15:44.872572 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."film_ratings__dbt_backup"
[0m19:15:44.874119 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m19:15:44.875129 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m19:15:44.878833 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:15:44.881586 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m19:15:44.883231 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8278cb26-fe36-4dde-beb2-2486e5d6a382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5c80fc2d0>]}
[0m19:15:44.885004 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.film_ratings .......................... [[32mSELECT 20[0m in 0.09s]
[0m19:15:44.886749 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m19:15:44.889440 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:44.890721 [debug] [MainThread]: On master: BEGIN
[0m19:15:44.891713 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:15:44.912046 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:15:44.913409 [debug] [MainThread]: On master: COMMIT
[0m19:15:44.914575 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:44.915615 [debug] [MainThread]: On master: COMMIT
[0m19:15:44.919259 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:15:44.920370 [debug] [MainThread]: On master: Close
[0m19:15:44.921756 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:15:44.922769 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m19:15:44.923851 [info ] [MainThread]: 
[0m19:15:44.924998 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.84 seconds (0.84s).
[0m19:15:44.927421 [debug] [MainThread]: Command end result
[0m19:15:44.987157 [info ] [MainThread]: 
[0m19:15:44.988453 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:15:44.989563 [info ] [MainThread]: 
[0m19:15:44.990546 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m19:15:44.992879 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.0036411, "process_user_time": 2.310015, "process_kernel_time": 0.219053, "process_mem_max_rss": "113980", "process_in_blocks": "100704", "process_out_blocks": "1152"}
[0m19:15:44.994019 [debug] [MainThread]: Command `dbt run` succeeded at 19:15:44.993896 after 2.00 seconds
[0m19:15:44.995141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5cd684510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5cd5b8750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5cd714c90>]}
[0m19:15:44.996258 [debug] [MainThread]: Flushing usage events
[0m19:23:08.064759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52094a8dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52094a8210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52094aad50>]}


============================== 19:23:08.071543 | cb02139b-d89f-4d54-b179-59e11fa5234c ==============================
[0m19:23:08.071543 [info ] [MainThread]: Running with dbt=1.8.1
[0m19:23:08.072878 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'debug': 'False', 'profiles_dir': '/root', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:23:08.247771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb02139b-d89f-4d54-b179-59e11fa5234c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52095420d0>]}
[0m19:23:08.297393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb02139b-d89f-4d54-b179-59e11fa5234c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520b3e3390>]}
[0m19:23:08.299416 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m19:23:08.312682 [debug] [MainThread]: checksum: 8dc0a8b3d70f1f34b0ae4fcce5e5a1fd7ffa186bf54a1762a302cc92429dddc4, vars: {}, profile: custom_postgres, target: dev, version: 1.8.1
[0m19:23:08.587840 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m19:23:08.589432 [debug] [MainThread]: Partial parsing: added file: custom_postgres://models/example/specific_movie.sql
[0m19:23:08.815677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb02139b-d89f-4d54-b179-59e11fa5234c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5208bbae50>]}
[0m19:23:08.940834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb02139b-d89f-4d54-b179-59e11fa5234c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5208920290>]}
[0m19:23:08.941815 [info ] [MainThread]: Found 5 models, 20 data tests, 3 sources, 415 macros
[0m19:23:08.943079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb02139b-d89f-4d54-b179-59e11fa5234c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5208b82210>]}
[0m19:23:08.945768 [info ] [MainThread]: 
[0m19:23:08.946976 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:23:08.951174 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m19:23:08.996072 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m19:23:08.997294 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m19:23:08.998129 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:23:09.021900 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m19:23:09.024189 [debug] [ThreadPool]: On list_destination_db: Close
[0m19:23:09.026680 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m19:23:09.033710 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m19:23:09.034709 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m19:23:09.035626 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:23:09.052179 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:23:09.053309 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m19:23:09.054177 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:23:09.059592 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m19:23:09.061685 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m19:23:09.064215 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m19:23:09.071072 [debug] [MainThread]: Using postgres connection "master"
[0m19:23:09.072149 [debug] [MainThread]: On master: BEGIN
[0m19:23:09.073055 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:23:09.092048 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:23:09.093365 [debug] [MainThread]: Using postgres connection "master"
[0m19:23:09.094371 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:23:09.103208 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m19:23:09.105446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb02139b-d89f-4d54-b179-59e11fa5234c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520892a410>]}
[0m19:23:09.106538 [debug] [MainThread]: On master: ROLLBACK
[0m19:23:09.109518 [debug] [MainThread]: Using postgres connection "master"
[0m19:23:09.110477 [debug] [MainThread]: On master: BEGIN
[0m19:23:09.115653 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:23:09.116872 [debug] [MainThread]: On master: COMMIT
[0m19:23:09.117883 [debug] [MainThread]: Using postgres connection "master"
[0m19:23:09.118765 [debug] [MainThread]: On master: COMMIT
[0m19:23:09.122234 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:23:09.123378 [debug] [MainThread]: On master: Close
[0m19:23:09.124558 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:23:09.125754 [info ] [MainThread]: 
[0m19:23:09.138624 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m19:23:09.140180 [info ] [Thread-1 (]: 1 of 5 START sql table model public.actors ..................................... [RUN]
[0m19:23:09.141448 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m19:23:09.142720 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m19:23:09.152497 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m19:23:09.161489 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m19:23:09.205569 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m19:23:09.213260 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m19:23:09.214129 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m19:23:09.214944 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:23:09.233024 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:23:09.234470 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m19:23:09.235623 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m19:23:09.239835 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.0 seconds
[0m19:23:09.247226 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m19:23:09.248332 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m19:23:09.251731 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:23:09.256176 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m19:23:09.257354 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m19:23:09.260929 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:23:09.282688 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m19:23:09.284076 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m19:23:09.285062 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m19:23:09.289179 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:23:09.299727 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."actors__dbt_backup"
[0m19:23:09.306326 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m19:23:09.307607 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m19:23:09.313813 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:23:09.317324 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m19:23:09.319693 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb02139b-d89f-4d54-b179-59e11fa5234c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f520892a410>]}
[0m19:23:09.321070 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.18s]
[0m19:23:09.322443 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m19:23:09.323740 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m19:23:09.324897 [info ] [Thread-1 (]: 2 of 5 START sql table model public.film_actors ................................ [RUN]
[0m19:23:09.326143 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m19:23:09.327227 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m19:23:09.331337 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m19:23:09.339338 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m19:23:09.344297 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m19:23:09.353082 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m19:23:09.354119 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m19:23:09.355005 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:23:09.375297 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:23:09.376827 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m19:23:09.377903 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m19:23:09.382508 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.0 seconds
[0m19:23:09.387522 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m19:23:09.388966 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m19:23:09.393181 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:23:09.398165 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m19:23:09.399393 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m19:23:09.403277 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:23:09.406035 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m19:23:09.407172 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m19:23:09.408212 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m19:23:09.413060 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:23:09.417194 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."film_actors__dbt_backup"
[0m19:23:09.418735 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m19:23:09.419880 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m19:23:09.425803 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:23:09.428567 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m19:23:09.429788 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb02139b-d89f-4d54-b179-59e11fa5234c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5207cb96d0>]}
[0m19:23:09.431162 [info ] [Thread-1 (]: 2 of 5 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.10s]
[0m19:23:09.432451 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m19:23:09.433637 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m19:23:09.435016 [info ] [Thread-1 (]: 3 of 5 START sql table model public.films ...................................... [RUN]
[0m19:23:09.436336 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m19:23:09.437344 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m19:23:09.441366 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m19:23:09.449770 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m19:23:09.454817 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m19:23:09.463604 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m19:23:09.464642 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m19:23:09.465649 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:23:09.486997 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:23:09.488538 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m19:23:09.489589 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m19:23:09.494424 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.0 seconds
[0m19:23:09.499348 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m19:23:09.500740 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m19:23:09.505063 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:23:09.509633 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m19:23:09.510920 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m19:23:09.515148 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:23:09.517994 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m19:23:09.519452 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m19:23:09.520622 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m19:23:09.526376 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:23:09.530674 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."films__dbt_backup"
[0m19:23:09.532157 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m19:23:09.533234 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m19:23:09.539452 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:23:09.542008 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m19:23:09.543551 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb02139b-d89f-4d54-b179-59e11fa5234c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5207d1cd10>]}
[0m19:23:09.544986 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.11s]
[0m19:23:09.546300 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m19:23:09.548191 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m19:23:09.549414 [info ] [Thread-1 (]: 4 of 5 START sql table model public.film_ratings ............................... [RUN]
[0m19:23:09.550659 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.films, now model.custom_postgres.film_ratings)
[0m19:23:09.551685 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m19:23:09.560600 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m19:23:09.569580 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m19:23:09.574490 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m19:23:09.583349 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m19:23:09.584515 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m19:23:09.585574 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:23:09.605685 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:23:09.606952 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m19:23:09.608031 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  
  
    as
  
  (
    

WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating, 
        

CASE
    WHEN user_rating >= 4.5 THEN 'Excellent'
    WHEN user_rating >= 4.0 THEN 'Good'
    WHEN user_rating >= 3.0 THEN 'Average'
    ELSE 'Poor'
    END AS rating_category


    FROM "destination_db"."public"."films"  -- Using dbt's ref function to reference the films table
),

films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ', ') AS actors  -- Aggregating actor names for each film
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id


  );
  
[0m19:23:09.617005 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.0 seconds
[0m19:23:09.621960 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m19:23:09.623283 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m19:23:09.627369 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:23:09.630153 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m19:23:09.631395 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m19:23:09.632443 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m19:23:09.637801 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:23:09.642053 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."film_ratings__dbt_backup"
[0m19:23:09.643813 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m19:23:09.645023 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m19:23:09.649134 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:23:09.652085 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m19:23:09.653786 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb02139b-d89f-4d54-b179-59e11fa5234c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5206220150>]}
[0m19:23:09.655363 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public.film_ratings .......................... [[32mSELECT 20[0m in 0.10s]
[0m19:23:09.657042 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m19:23:09.658665 [debug] [Thread-1 (]: Began running node model.custom_postgres.specific_movie
[0m19:23:09.660475 [info ] [Thread-1 (]: 5 of 5 START sql table model public.specific_movie ............................. [RUN]
[0m19:23:09.661935 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_ratings, now model.custom_postgres.specific_movie)
[0m19:23:09.663065 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.specific_movie
[0m19:23:09.668140 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.specific_movie"
[0m19:23:09.677005 [debug] [Thread-1 (]: Began executing node model.custom_postgres.specific_movie
[0m19:23:09.682041 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.specific_movie"
[0m19:23:09.691399 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m19:23:09.692577 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: BEGIN
[0m19:23:09.693628 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:23:09.714581 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:23:09.715913 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m19:23:09.716957 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */

  
    

  create  table "destination_db"."public"."specific_movie__dbt_tmp"
  
  
    as
  
  (
    { % set film_title = 'Dunkirk' %}

SELECT *
FROM "destination_db"."public"."films"
WHERE title =''
  );
  
[0m19:23:09.721016 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "{"
LINE 12:     { % set film_title = 'Dunkirk' %}
             ^

[0m19:23:09.722069 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: ROLLBACK
[0m19:23:09.725213 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: Close
[0m19:23:09.735606 [debug] [Thread-1 (]: Database Error in model specific_movie (models/example/specific_movie.sql)
  syntax error at or near "{"
  LINE 12:     { % set film_title = 'Dunkirk' %}
               ^
  compiled Code at target/run/custom_postgres/models/example/specific_movie.sql
[0m19:23:09.737322 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb02139b-d89f-4d54-b179-59e11fa5234c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5206242d50>]}
[0m19:23:09.739362 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model public.specific_movie .................... [[31mERROR[0m in 0.08s]
[0m19:23:09.741068 [debug] [Thread-1 (]: Finished running node model.custom_postgres.specific_movie
[0m19:23:09.744568 [debug] [MainThread]: Using postgres connection "master"
[0m19:23:09.745894 [debug] [MainThread]: On master: BEGIN
[0m19:23:09.747285 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:23:09.771276 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:23:09.773203 [debug] [MainThread]: On master: COMMIT
[0m19:23:09.774540 [debug] [MainThread]: Using postgres connection "master"
[0m19:23:09.776107 [debug] [MainThread]: On master: COMMIT
[0m19:23:09.781030 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:23:09.782795 [debug] [MainThread]: On master: Close
[0m19:23:09.784533 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:23:09.785860 [debug] [MainThread]: Connection 'model.custom_postgres.specific_movie' was properly closed.
[0m19:23:09.787203 [info ] [MainThread]: 
[0m19:23:09.788789 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.84 seconds (0.84s).
[0m19:23:09.791778 [debug] [MainThread]: Command end result
[0m19:23:09.921823 [info ] [MainThread]: 
[0m19:23:09.923124 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:23:09.924129 [info ] [MainThread]: 
[0m19:23:09.925043 [error] [MainThread]:   Database Error in model specific_movie (models/example/specific_movie.sql)
  syntax error at or near "{"
  LINE 12:     { % set film_title = 'Dunkirk' %}
               ^
  compiled Code at target/run/custom_postgres/models/example/specific_movie.sql
[0m19:23:09.925883 [info ] [MainThread]: 
[0m19:23:09.926770 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m19:23:09.928943 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.922389, "process_user_time": 2.130937, "process_kernel_time": 0.259168, "process_mem_max_rss": "109724", "process_in_blocks": "100968", "process_out_blocks": "1152", "command_success": false}
[0m19:23:09.930246 [debug] [MainThread]: Command `dbt run` failed at 19:23:09.930125 after 1.92 seconds
[0m19:23:09.931187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52062c2610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52062c2910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52062c2710>]}
[0m19:23:09.932059 [debug] [MainThread]: Flushing usage events
[0m19:24:20.879023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ac9c31110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ac9e1e390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aca1cddd0>]}


============================== 19:24:20.885713 | 22d04bfe-407e-44a0-b2cd-4915dc876a0c ==============================
[0m19:24:20.885713 [info ] [MainThread]: Running with dbt=1.8.1
[0m19:24:20.887267 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'debug': 'False', 'profiles_dir': '/root', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:24:21.064651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22d04bfe-407e-44a0-b2cd-4915dc876a0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ac93ea6d0>]}
[0m19:24:21.112353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22d04bfe-407e-44a0-b2cd-4915dc876a0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8acbb3f790>]}
[0m19:24:21.114620 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m19:24:21.126665 [debug] [MainThread]: checksum: 8dc0a8b3d70f1f34b0ae4fcce5e5a1fd7ffa186bf54a1762a302cc92429dddc4, vars: {}, profile: custom_postgres, target: dev, version: 1.8.1
[0m19:24:21.396401 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:24:21.398342 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/specific_movie.sql
[0m19:24:21.618549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22d04bfe-407e-44a0-b2cd-4915dc876a0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ac8fb4b90>]}
[0m19:24:21.742016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22d04bfe-407e-44a0-b2cd-4915dc876a0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ac8fda010>]}
[0m19:24:21.742980 [info ] [MainThread]: Found 5 models, 20 data tests, 3 sources, 415 macros
[0m19:24:21.744163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22d04bfe-407e-44a0-b2cd-4915dc876a0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ac9151f50>]}
[0m19:24:21.746853 [info ] [MainThread]: 
[0m19:24:21.747985 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:24:21.752169 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m19:24:21.796589 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m19:24:21.797710 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m19:24:21.798461 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:24:21.820968 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m19:24:21.822996 [debug] [ThreadPool]: On list_destination_db: Close
[0m19:24:21.825152 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_destination_db, now list_destination_db_public)
[0m19:24:21.832050 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m19:24:21.833048 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m19:24:21.833833 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:24:21.849393 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:24:21.850412 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m19:24:21.851207 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:24:21.856596 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m19:24:21.858603 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m19:24:21.860980 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m19:24:21.867566 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:21.868694 [debug] [MainThread]: On master: BEGIN
[0m19:24:21.869560 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:24:21.885999 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:24:21.887180 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:21.888082 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:24:21.895878 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m19:24:21.898123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22d04bfe-407e-44a0-b2cd-4915dc876a0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ac91936d0>]}
[0m19:24:21.899310 [debug] [MainThread]: On master: ROLLBACK
[0m19:24:21.902236 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:21.903248 [debug] [MainThread]: On master: BEGIN
[0m19:24:21.907694 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:24:21.908908 [debug] [MainThread]: On master: COMMIT
[0m19:24:21.909688 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:21.910467 [debug] [MainThread]: On master: COMMIT
[0m19:24:21.913247 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:24:21.914122 [debug] [MainThread]: On master: Close
[0m19:24:21.915116 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:24:21.915998 [info ] [MainThread]: 
[0m19:24:21.925242 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m19:24:21.926518 [info ] [Thread-1 (]: 1 of 5 START sql table model public.actors ..................................... [RUN]
[0m19:24:21.927580 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_destination_db_public, now model.custom_postgres.actors)
[0m19:24:21.928456 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m19:24:21.936546 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m19:24:21.944555 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m19:24:21.994058 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m19:24:22.003395 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m19:24:22.004616 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m19:24:22.005563 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:22.024111 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:24:22.025276 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m19:24:22.026291 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m19:24:22.030615 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.0 seconds
[0m19:24:22.038882 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m19:24:22.040114 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m19:24:22.043806 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:22.048550 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m19:24:22.049869 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m19:24:22.054354 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:22.079178 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m19:24:22.080504 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m19:24:22.081451 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m19:24:22.086088 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:24:22.093421 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."actors__dbt_backup"
[0m19:24:22.098819 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m19:24:22.100013 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m19:24:22.105540 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:24:22.108724 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m19:24:22.111312 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22d04bfe-407e-44a0-b2cd-4915dc876a0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ac8fdf610>]}
[0m19:24:22.112725 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.18s]
[0m19:24:22.114068 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m19:24:22.115133 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m19:24:22.116207 [info ] [Thread-1 (]: 2 of 5 START sql table model public.film_actors ................................ [RUN]
[0m19:24:22.117289 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.actors, now model.custom_postgres.film_actors)
[0m19:24:22.118154 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m19:24:22.124391 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m19:24:22.132464 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m19:24:22.137087 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m19:24:22.145264 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m19:24:22.146438 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m19:24:22.147359 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:22.166719 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:24:22.167933 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m19:24:22.168893 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m19:24:22.173511 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.0 seconds
[0m19:24:22.178068 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m19:24:22.179289 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m19:24:22.182620 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:22.186528 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m19:24:22.187575 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m19:24:22.190674 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:22.192719 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m19:24:22.193686 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m19:24:22.194601 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m19:24:22.198918 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:24:22.202679 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."film_actors__dbt_backup"
[0m19:24:22.204083 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m19:24:22.204984 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m19:24:22.210152 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:24:22.212673 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m19:24:22.214194 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22d04bfe-407e-44a0-b2cd-4915dc876a0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ac841b550>]}
[0m19:24:22.215791 [info ] [Thread-1 (]: 2 of 5 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.10s]
[0m19:24:22.217511 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m19:24:22.218994 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m19:24:22.220433 [info ] [Thread-1 (]: 3 of 5 START sql table model public.films ...................................... [RUN]
[0m19:24:22.221762 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_actors, now model.custom_postgres.films)
[0m19:24:22.222712 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m19:24:22.226813 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m19:24:22.234675 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m19:24:22.239632 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m19:24:22.247460 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m19:24:22.248724 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m19:24:22.249693 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:22.268653 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:24:22.270045 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m19:24:22.271197 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  
  
    as
  
  (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m19:24:22.275879 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.0 seconds
[0m19:24:22.280315 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m19:24:22.281434 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m19:24:22.284768 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:22.288617 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m19:24:22.289858 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m19:24:22.293138 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:22.295679 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m19:24:22.296803 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m19:24:22.297728 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m19:24:22.302254 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:24:22.306030 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."films__dbt_backup"
[0m19:24:22.307776 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m19:24:22.308834 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m19:24:22.314414 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:24:22.316826 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m19:24:22.317997 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22d04bfe-407e-44a0-b2cd-4915dc876a0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ac842b190>]}
[0m19:24:22.319491 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.10s]
[0m19:24:22.321159 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m19:24:22.323147 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m19:24:22.324469 [info ] [Thread-1 (]: 4 of 5 START sql table model public.film_ratings ............................... [RUN]
[0m19:24:22.325549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.films, now model.custom_postgres.film_ratings)
[0m19:24:22.326451 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m19:24:22.332862 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m19:24:22.340244 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m19:24:22.346788 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m19:24:22.354721 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m19:24:22.355921 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m19:24:22.356840 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:22.376380 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:24:22.377766 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m19:24:22.378894 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  
  
    as
  
  (
    

WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating, 
        

CASE
    WHEN user_rating >= 4.5 THEN 'Excellent'
    WHEN user_rating >= 4.0 THEN 'Good'
    WHEN user_rating >= 3.0 THEN 'Average'
    ELSE 'Poor'
    END AS rating_category


    FROM "destination_db"."public"."films"  -- Using dbt's ref function to reference the films table
),

films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ', ') AS actors  -- Aggregating actor names for each film
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id


  );
  
[0m19:24:22.388200 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.0 seconds
[0m19:24:22.392352 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m19:24:22.393304 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m19:24:22.396735 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:22.399228 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m19:24:22.400241 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m19:24:22.401111 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m19:24:22.405565 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:24:22.409410 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."film_ratings__dbt_backup"
[0m19:24:22.410804 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m19:24:22.411759 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m19:24:22.415347 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:24:22.417686 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m19:24:22.419100 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22d04bfe-407e-44a0-b2cd-4915dc876a0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ac817c690>]}
[0m19:24:22.420820 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public.film_ratings .......................... [[32mSELECT 20[0m in 0.09s]
[0m19:24:22.422190 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m19:24:22.423265 [debug] [Thread-1 (]: Began running node model.custom_postgres.specific_movie
[0m19:24:22.424435 [info ] [Thread-1 (]: 5 of 5 START sql table model public.specific_movie ............................. [RUN]
[0m19:24:22.425503 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.custom_postgres.film_ratings, now model.custom_postgres.specific_movie)
[0m19:24:22.426367 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.specific_movie
[0m19:24:22.430440 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.specific_movie"
[0m19:24:22.438135 [debug] [Thread-1 (]: Began executing node model.custom_postgres.specific_movie
[0m19:24:22.442868 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.specific_movie"
[0m19:24:22.450621 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m19:24:22.451626 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: BEGIN
[0m19:24:22.452677 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:22.472468 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:24:22.473897 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m19:24:22.474941 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */

  
    

  create  table "destination_db"."public"."specific_movie__dbt_tmp"
  
  
    as
  
  (
    

SELECT *
FROM "destination_db"."public"."films"
WHERE title ='Dunkirk'
  );
  
[0m19:24:22.480492 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:24:22.484815 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m19:24:22.485753 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
alter table "destination_db"."public"."specific_movie__dbt_tmp" rename to "specific_movie"
[0m19:24:22.488900 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:22.490745 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m19:24:22.491571 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m19:24:22.492373 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m19:24:22.496667 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:24:22.500583 [debug] [Thread-1 (]: Applying DROP to: "destination_db"."public"."specific_movie__dbt_backup"
[0m19:24:22.502115 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m19:24:22.503369 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
drop table if exists "destination_db"."public"."specific_movie__dbt_backup" cascade
[0m19:24:22.507012 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:24:22.509425 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: Close
[0m19:24:22.510865 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22d04bfe-407e-44a0-b2cd-4915dc876a0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ac8388050>]}
[0m19:24:22.512319 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.specific_movie ........................ [[32mSELECT 1[0m in 0.09s]
[0m19:24:22.514007 [debug] [Thread-1 (]: Finished running node model.custom_postgres.specific_movie
[0m19:24:22.516951 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:22.518258 [debug] [MainThread]: On master: BEGIN
[0m19:24:22.519180 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:24:22.538019 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:24:22.539320 [debug] [MainThread]: On master: COMMIT
[0m19:24:22.540408 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:22.541281 [debug] [MainThread]: On master: COMMIT
[0m19:24:22.544400 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:24:22.545696 [debug] [MainThread]: On master: Close
[0m19:24:22.546862 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:24:22.548038 [debug] [MainThread]: Connection 'model.custom_postgres.specific_movie' was properly closed.
[0m19:24:22.549460 [info ] [MainThread]: 
[0m19:24:22.550594 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.80 seconds (0.80s).
[0m19:24:22.552633 [debug] [MainThread]: Command end result
[0m19:24:22.672211 [info ] [MainThread]: 
[0m19:24:22.673612 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:24:22.674643 [info ] [MainThread]: 
[0m19:24:22.675532 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m19:24:22.677567 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8579124, "process_user_time": 2.089317, "process_kernel_time": 0.301343, "process_mem_max_rss": "110588", "process_in_blocks": "100512", "process_out_blocks": "1152"}
[0m19:24:22.678605 [debug] [MainThread]: Command `dbt run` succeeded at 19:24:22.678486 after 1.86 seconds
[0m19:24:22.679412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8acd49c710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8acd620310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8acd620b10>]}
[0m19:24:22.680207 [debug] [MainThread]: Flushing usage events
[0m22:49:58.813825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f763ecfe890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f763ecfc550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f763ecfd0d0>]}


============================== 22:49:58.822329 | 5af560df-b3ac-47c3-be13-ca6a5d71d162 ==============================
[0m22:49:58.822329 [info ] [MainThread]: Running with dbt=1.8.1
[0m22:49:58.823703 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /opt/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:49:58.830188 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'custom_postgres'
[0m22:49:58.832660 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.07977455, "process_user_time": 1.406654, "process_kernel_time": 0.271629, "process_mem_max_rss": "87708", "process_in_blocks": "82320", "process_out_blocks": "1008", "command_success": false}
[0m22:49:58.834003 [debug] [MainThread]: Command `dbt run` failed at 22:49:58.833791 after 0.08 seconds
[0m22:49:58.835171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f763ed23710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f763ecce5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76426e4c50>]}
[0m22:49:58.836057 [debug] [MainThread]: Flushing usage events
[0m23:18:28.110697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9505beb890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f950520e050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9504ca0890>]}


============================== 23:18:28.117795 | cc3c49fa-8e1c-4a54-81d3-d0b7317a3f68 ==============================
[0m23:18:28.117795 [info ] [MainThread]: Running with dbt=1.8.1
[0m23:18:28.119236 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /root --project-dir /opt/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:18:28.124413 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'custom_postgres'
[0m23:18:28.126499 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.06970913, "process_user_time": 1.217441, "process_kernel_time": 0.120737, "process_mem_max_rss": "87616", "process_in_blocks": "81976", "process_out_blocks": "1008", "command_success": false}
[0m23:18:28.127767 [debug] [MainThread]: Command `dbt run` failed at 23:18:28.127631 after 0.07 seconds
[0m23:18:28.128715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9504cc72d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9504cc7390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9504cc7250>]}
[0m23:18:28.129596 [debug] [MainThread]: Flushing usage events
